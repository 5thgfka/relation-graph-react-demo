(function(){ try {var elementStyle = document.createElement('style'); elementStyle.appendChild(document.createTextNode("@charset \"UTF-8\";.relation-graph{box-sizing:border-box;position:relative}.relation-graph .rel-map svg.rg-icon{height:100%;width:100%}.relation-graph .rel-lines-svg{overflow:visible}.relation-graph .rel-linediv{overflow:visible;position:absolute;z-index:40;width:100%;top:0px;left:0px;--stroke: url(#lineStyle);--markerEnd: url(#arrow-default);--markerStart: url(#start-arrow-default);--markerEndChecked: url(#arrow-checked);--markerStartChecked: url(#start-arrow-checked)}.relation-graph .rel-linediv svg{overflow:visible}.relation-graph .rel-linediv-el-lines{z-index:60}.relation-graph .rel-lines-svg-el-lines{overflow:visible;width:1px;height:1px;position:absolute;left:0px;top:0px}.relation-graph .rel-map{background-color:#fff;overflow:hidden;cursor:default;user-select:none}.relation-graph .rel-map-background-norepeat{background-repeat:no-repeat;background-position:right bottom}.relation-graph .rel-nodediv-for-webkit{position:absolute;width:100%;top:0px;left:0px;z-index:50}.relation-graph .rel-map-canvas{position:relative;top:0px;left:0px;border:0px;z-index:3;overflow:visible}.relation-graph .rel-canvas-slot{overflow:visible}.relation-graph .rel-canvas-slot-behind{z-index:30;overflow:visible;position:absolute;top:0px;left:0px}.relation-graph .rel-canvas-slot-above{z-index:70;overflow:visible;position:absolute;top:0px;left:0px}.relation-graph .rel-map ::v-deep img{-webkit-user-drag:none;-webkit-user-select:none}.relation-graph .c-rg-line-text{fill:#888;font-size:12px}.relation-graph .c-rg-line-text-checked{stroke:#fd8b374d;stroke-width:2}.relation-graph .c-rg-line{fill-rule:nonzero}.relation-graph .rg-line-dashtype-1{stroke-dasharray:2,2,2;stroke-dashoffset:3px;stroke-linecap:butt;stroke-linejoin:bevel}.relation-graph .rg-line-dashtype-2{stroke-dasharray:5,5,5;stroke-dashoffset:3px;stroke-linecap:butt;stroke-linejoin:bevel}.relation-graph .rg-line-dashtype-3{stroke-dasharray:9,9,9;stroke-dashoffset:3px;stroke-linecap:butt;stroke-linejoin:bevel}.relation-graph .rg-line-dashtype-4{stroke-dasharray:5,5,15;stroke-dashoffset:3px;stroke-linecap:butt;stroke-linejoin:bevel}@keyframes ACTRGLineChecked{0%{stroke-dashoffset:352px;stroke-dasharray:5,5,5}50%{stroke-dasharray:5,5,5;stroke-dashoffset:3px}to{stroke-dashoffset:352px;stroke-dasharray:5,5,5}}@keyframes rg-line-anm2{0%{stroke-dashoffset:0;stroke-dasharray:4,4,4}to{stroke-dashoffset:10px;stroke-dasharray:20,20,20}}@keyframes rg-line-anm3{0%{stroke-opacity:1}50%{stroke-opacity:.2}to{stroke-opacity:1}}@keyframes rg-line-anm4{0%{stroke-dasharray:0,100%}to{stroke-dasharray:100%,0}}.relation-graph .rg-line-anm-1{animation:ACTRGLineChecked 10s infinite}.relation-graph .rg-line-anm-2{animation:rg-line-anm2 3s infinite}.relation-graph .rg-line-anm-3{animation:rg-line-anm3 1s infinite}.relation-graph .rg-line-anm-4{animation:rg-line-anm4 3s infinite}.relation-graph .c-rg-line-checked{z-index:100}.relation-graph .c-rg-line-checked-bg{stroke:#fd8b374d;stroke-linecap:round}@keyframes deform1{0%{stroke-dashoffset:0}to{stroke-dashoffset:100%}}.relation-graph .rg-icon{width:19px;height:19px;vertical-align:0px;fill:currentColor;overflow:hidden}.relation-graph .el-icon-remove,.relation-graph .el-icon-circle-plus{cursor:pointer}.relation-graph .relation-graph-node{position:absolute}.relation-graph .rel-node-peel{clear:both;padding:8px;position:absolute;font-size:14px}.relation-graph .rel-node-peel-checked{z-index:100}.relation-graph .rel-node{text-align:center}.relation-graph .rg-center-items{display:flex;place-items:center}.relation-graph .rel-node-shape-0{width:80px;height:80px;border-radius:50%}.relation-graph .rel-node-shape-1{border-radius:5px}.relation-graph .c-node-text{height:100%;width:100%;display:flex;align-items:center;justify-content:center}.relation-graph .rel-node-shape-1 .c-node-text{padding-left:5px;padding-right:5px}.relation-graph .rel-node-type-button{border-radius:25px;color:#00f;cursor:pointer}.relation-graph .rel-node-checked{transition:background-color .2s ease,outline .2s ease,color .2s ease,-webkit-box-shadow .2s ease;box-shadow:0 0 0 8px #fd8b374d}.relation-graph .rel-node-selected{border:#025098 solid 2px;border-radius:5px}.relation-graph .rel-node-flashing{animation:ACTRGNodeFlashing 2s infinite}.relation-graph .rel-node-vtree-2{transform-origin:0 0;transform:rotate(30deg) translate(0)}.relation-graph .rel-node-vtree{width:130px;height:45px;text-align:left}.relation-graph .c-btn-open-close{position:absolute;height:100%;width:19px;display:flex;align-items:center;justify-content:center;user-select:none;pointer-events:none;cursor:pointer}.relation-graph .c-btn-open-close span{width:19px;height:19px;display:inline-block;text-align:center;border-radius:15px;color:#fff;cursor:pointer;font-size:19px;line-height:16px;background-size:100% 100%;pointer-events:all}.relation-graph .c-expanded{background-image:url(data:image/svg+xml;%20charset=utf8,%3Csvg%20t=%221606310217820%22%20viewBox=%220%200%201024%201024%22%20version=%221.1%22%20xmlns=%22http://www.w3.org/2000/svg%22%20p-id=%223373%22%20width=%2232%22%20height=%2232%22%3E%3Cpath%20d=%22M853.333333%20480H544V170.666667c0-17.066667-14.933333-32-32-32s-32%2014.933333-32%2032v309.333333H170.666667c-17.066667%200-32%2014.933333-32%2032s14.933333%2032%2032%2032h309.333333V853.333333c0%2017.066667%2014.933333%2032%2032%2032s32-14.933333%2032-32V544H853.333333c17.066667%200%2032-14.933333%2032-32s-14.933333-32-32-32z%22%20p-id=%223374%22%20fill=%22white%22%3E%3C/path%3E%3C/svg%3E)}.relation-graph .c-collapsed{background-image:url(data:image/svg+xml;%20charset=utf8,%3Csvg%20t=%221606310454619%22%20class=%22icon%22%20viewBox=%220%200%201024%201024%22%20version=%221.1%22%20xmlns=%22http://www.w3.org/2000/svg%22%20p-id=%223662%22%20width=%22128%22%20height=%22128%22%3E%3Cpath%20d=%22M853.333333%20554.666667H170.666667c-23.466667%200-42.666667-19.2-42.666667-42.666667s19.2-42.666667%2042.666667-42.666667h682.666666c23.466667%200%2042.666667%2019.2%2042.666667%2042.666667s-19.2%2042.666667-42.666667%2042.666667z%22%20p-id=%223663%22%20fill=%22white%22%3E%3C/path%3E%3C/svg%3E)}.relation-graph .c-expand-positon-left{margin-top:-8px;margin-left:-25px}.relation-graph .c-expand-positon-right{height:100%;width:100%;justify-content:center}.relation-graph .c-expand-positon-right span{margin-top:-18px;margin-right:-18px;margin-left:100%}.relation-graph .c-expand-positon-bottom{height:100%;width:100%;margin-top:7px;margin-left:-8px;align-items:flex-end;justify-content:center}.relation-graph .c-expand-positon-top{height:18px;width:100%;margin-top:-20px;margin-left:-6px;align-items:flex-end;justify-content:center}@keyframes ACTRGNodeInit{0%{box-shadow:0 0 15px #fd8b37}50%{box-shadow:0 0 1px #2e4e8f}to{box-shadow:0 0 15px #fd8b37}to{box-shadow:0 0 15px #fd8b37}}@keyframes ACTRGNodeFlashing{0%{box-shadow:0 0 15px #fd8b37}40%{box-shadow:0 0 1px #2e4e8f}70%{box-shadow:0 0 8px #fd8b37}to{box-shadow:0 0 #fd8b37}}.relation-graph .rel-diy-node{padding:0}.relation-graph .c-setting-panel{--height: 300px;--width: 200px;width:300px;height:200px;position:absolute;margin-left:10px;margin-top:5px;font-size:12px;color:#3a5bb2;padding:60px 10px 10px;overflow:hidden;box-shadow:0 0 5px #999;border-radius:5px;z-index:1000;background-color:#fff;border:#999999 solid 1px}.relation-graph .c-setting-panel-button{height:35px;width:35px;font-size:8px;line-height:35px;text-align:center;border-radius:50%;position:absolute;margin-left:25px;margin-top:20px;background-color:#3a5bb2;color:#fff;cursor:pointer;z-index:1001;box-shadow:0 0 8px #999}.relation-graph .c-setting-panel-button:hover{box-shadow:0 0 20px #ffa20a;border:#ffffff solid 1px;color:#ffa20a;-moz-transform:rotate(-89deg) translateX(-190px);animation-timing-function:linear;animation:flashButton 2s infinite}.relation-graph .c-fixedLayout{position:fixed;top:125px}@keyframes flashButton{0%{box-shadow:0 0 8px #2e4e8f}30%{box-shadow:0 0 20px #ffa20a}to{box-shadow:0 0 8px #2e4e8f}}.relation-graph .c-debug-tools-row{text-align:left}.relation-graph .rel-operate{position:absolute;top:0px;left:0px;width:100%;height:100%;z-index:180}.relation-graph .rel-selection{position:absolute;background-color:#0e7a7b4d;border:rgb(14,122,123) solid 1px}.relation-graph .rel-graph-loading{position:absolute;z-index:200;left:0px;top:0px;height:100%;width:100%;background-color:#fff}.relation-graph .rel-graph-loading .c-graph-loading-icon{width:16px;height:16px;vertical-align:-3px;fill:currentColor;overflow:hidden;animation:turn 1s linear infinite}.relation-graph .rel-graph-loading .rel-graph-loading-message{position:absolute;width:200px;height:30px;line-height:30px;text-align:center;left:calc((100% - 200px)/2);top:calc((100% - 30px)/2);border-radius:5px;background-color:#4444444d;color:#fff}.relation-graph .rel-graph-loading-hide{display:none}@keyframes slowHide{0%{opacity:1}to{opacity:0;display:none}}.relation-graph .rel-toolbar{position:absolute;z-index:300;background-color:#dcdcdc33;color:#999;box-shadow:0 0 2px #ccc;box-sizing:border-box;border-radius:5px;padding:3px}.relation-graph .rel-toolbar .rg-icon{width:16px;height:16px;vertical-align:-3px;fill:currentColor;overflow:hidden}.relation-graph .rel-toolbar .c-mb-button svg{margin:auto}.relation-graph .rel-toolbar .c-mb-button-on{color:#2e74b5}.relation-graph .rel-toolbar .c-mb-button:hover{background-color:#dcdcdc80}.relation-graph .rel-toolbar .c-loading-icon{animation:turn 1s linear infinite}@keyframes turn{0%{-webkit-transform:rotate(0deg)}25%{-webkit-transform:rotate(90deg)}50%{-webkit-transform:rotate(180deg)}75%{-webkit-transform:rotate(270deg)}to{-webkit-transform:rotate(360deg)}}.relation-graph .rel-toolbar .c-current-zoom{margin-top:0;height:20px;color:#262626;font-size:10px;text-align:center;line-height:20px;border-radius:3px}.relation-graph .rel-toolbar .c-mb-button{height:40px;margin-top:0;opacity:1;text-align:center;padding-top:3px;cursor:pointer;font-size:18px;box-sizing:border-box;line-height:21px;display:flex;align-items:center;border-radius:3px}.relation-graph .rel-toolbar-v{width:45px;max-height:260px}.relation-graph .rel-toolbar-h{height:45px;width:300px}.relation-graph .rel-toolbar-h .c-mb-button{width:40px;height:100%;float:left}.relation-graph .rel-toolbar-h .c-current-zoom{width:40px;height:100%;float:left;line-height:40px}.relation-graph .rel-toolbar-h-right{right:15px}.relation-graph .rel-toolbar-h-left{left:15px}.relation-graph .rel-toolbar-h-center{left:calc((100% - 260px)/2)}.relation-graph .rel-toolbar-v-top{top:15px}.relation-graph .rel-toolbar-v-bottom{bottom:15px}.relation-graph .rel-toolbar-v-center{top:calc((100% - 260px)/2)}")); document.head.appendChild(elementStyle);} catch(e) {console.error('vite-plugin-css-injected-by-js', e);} })();var jt = Object.defineProperty;
var Ft = (n, i, e) => i in n ? jt(n, i, { enumerable: !0, configurable: !0, writable: !0, value: e }) : n[i] = e;
var L = (n, i, e) => (Ft(n, typeof i != "symbol" ? i + "" : i, e), e);
import ke, { createContext as mt, useContext as G, useState as yt, useCallback as Gt, useEffect as Te, useRef as ze, useImperativeHandle as Yt } from "react";
import * as Ut from "screenfull";
import Se from "screenfull";
import * as Xt from "html2canvas";
import Zt from "html2canvas";
var Be = { exports: {} }, be = {};
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
var He, ct;
function gt() {
  if (ct)
    return He;
  ct = 1;
  var n = Object.getOwnPropertySymbols, i = Object.prototype.hasOwnProperty, e = Object.prototype.propertyIsEnumerable;
  function t(s) {
    if (s == null)
      throw new TypeError("Object.assign cannot be called with null or undefined");
    return Object(s);
  }
  function o() {
    try {
      if (!Object.assign)
        return !1;
      var s = new String("abc");
      if (s[5] = "de", Object.getOwnPropertyNames(s)[0] === "5")
        return !1;
      for (var a = {}, c = 0; c < 10; c++)
        a["_" + String.fromCharCode(c)] = c;
      var r = Object.getOwnPropertyNames(a).map(function(h) {
        return a[h];
      });
      if (r.join("") !== "0123456789")
        return !1;
      var l = {};
      return "abcdefghijklmnopqrst".split("").forEach(function(h) {
        l[h] = h;
      }), Object.keys(Object.assign({}, l)).join("") === "abcdefghijklmnopqrst";
    } catch {
      return !1;
    }
  }
  return He = o() ? Object.assign : function(s, a) {
    for (var c, r = t(s), l, h = 1; h < arguments.length; h++) {
      c = Object(arguments[h]);
      for (var u in c)
        i.call(c, u) && (r[u] = c[u]);
      if (n) {
        l = n(c);
        for (var f = 0; f < l.length; f++)
          e.call(c, l[f]) && (r[l[f]] = c[l[f]]);
      }
    }
    return r;
  }, He;
}
/** @license React v17.0.2
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var ht;
function Jt() {
  if (ht)
    return be;
  ht = 1, gt();
  var n = ke, i = 60103;
  if (be.Fragment = 60107, typeof Symbol == "function" && Symbol.for) {
    var e = Symbol.for;
    i = e("react.element"), be.Fragment = e("react.fragment");
  }
  var t = n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner, o = Object.prototype.hasOwnProperty, s = { key: !0, ref: !0, __self: !0, __source: !0 };
  function a(c, r, l) {
    var h, u = {}, f = null, v = null;
    l !== void 0 && (f = "" + l), r.key !== void 0 && (f = "" + r.key), r.ref !== void 0 && (v = r.ref);
    for (h in r)
      o.call(r, h) && !s.hasOwnProperty(h) && (u[h] = r[h]);
    if (c && c.defaultProps)
      for (h in r = c.defaultProps, r)
        u[h] === void 0 && (u[h] = r[h]);
    return { $$typeof: i, type: c, key: f, ref: v, props: u, _owner: t.current };
  }
  return be.jsx = a, be.jsxs = a, be;
}
var Ve = {};
/** @license React v17.0.2
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
var ft;
function qt() {
  return ft || (ft = 1, function(n) {
    process.env.NODE_ENV !== "production" && function() {
      var i = ke, e = gt(), t = 60103, o = 60106;
      n.Fragment = 60107;
      var s = 60108, a = 60114, c = 60109, r = 60110, l = 60112, h = 60113, u = 60120, f = 60115, v = 60116, y = 60121, C = 60122, b = 60117, z = 60129, B = 60131;
      if (typeof Symbol == "function" && Symbol.for) {
        var S = Symbol.for;
        t = S("react.element"), o = S("react.portal"), n.Fragment = S("react.fragment"), s = S("react.strict_mode"), a = S("react.profiler"), c = S("react.provider"), r = S("react.context"), l = S("react.forward_ref"), h = S("react.suspense"), u = S("react.suspense_list"), f = S("react.memo"), v = S("react.lazy"), y = S("react.block"), C = S("react.server.block"), b = S("react.fundamental"), S("react.scope"), S("react.opaque.id"), z = S("react.debug_trace_mode"), S("react.offscreen"), B = S("react.legacy_hidden");
      }
      var k = typeof Symbol == "function" && Symbol.iterator, D = "@@iterator";
      function I(d) {
        if (d === null || typeof d != "object")
          return null;
        var g = k && d[k] || d[D];
        return typeof g == "function" ? g : null;
      }
      var J = i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;
      function w(d) {
        {
          for (var g = arguments.length, _ = new Array(g > 1 ? g - 1 : 0), E = 1; E < g; E++)
            _[E - 1] = arguments[E];
          O("error", d, _);
        }
      }
      function O(d, g, _) {
        {
          var E = J.ReactDebugCurrentFrame, A = E.getStackAddendum();
          A !== "" && (g += "%s", _ = _.concat([A]));
          var T = _.map(function(N) {
            return "" + N;
          });
          T.unshift("Warning: " + g), Function.prototype.apply.call(console[d], console, T);
        }
      }
      var le = !1;
      function j(d) {
        return !!(typeof d == "string" || typeof d == "function" || d === n.Fragment || d === a || d === z || d === s || d === h || d === u || d === B || le || typeof d == "object" && d !== null && (d.$$typeof === v || d.$$typeof === f || d.$$typeof === c || d.$$typeof === r || d.$$typeof === l || d.$$typeof === b || d.$$typeof === y || d[0] === C));
      }
      function R(d, g, _) {
        var E = g.displayName || g.name || "";
        return d.displayName || (E !== "" ? _ + "(" + E + ")" : _);
      }
      function $(d) {
        return d.displayName || "Context";
      }
      function ie(d) {
        if (d == null)
          return null;
        if (typeof d.tag == "number" && w("Received an unexpected object in getComponentName(). This is likely a bug in React. Please file an issue."), typeof d == "function")
          return d.displayName || d.name || null;
        if (typeof d == "string")
          return d;
        switch (d) {
          case n.Fragment:
            return "Fragment";
          case o:
            return "Portal";
          case a:
            return "Profiler";
          case s:
            return "StrictMode";
          case h:
            return "Suspense";
          case u:
            return "SuspenseList";
        }
        if (typeof d == "object")
          switch (d.$$typeof) {
            case r:
              var g = d;
              return $(g) + ".Consumer";
            case c:
              var _ = d;
              return $(_._context) + ".Provider";
            case l:
              return R(d, d.render, "ForwardRef");
            case f:
              return ie(d.type);
            case y:
              return ie(d._render);
            case v: {
              var E = d, A = E._payload, T = E._init;
              try {
                return ie(T(A));
              } catch {
                return null;
              }
            }
          }
        return null;
      }
      var ge = 0, Y, fe, q, U, te, H, P;
      function X() {
      }
      X.__reactDisabledLog = !0;
      function se() {
        {
          if (ge === 0) {
            Y = console.log, fe = console.info, q = console.warn, U = console.error, te = console.group, H = console.groupCollapsed, P = console.groupEnd;
            var d = {
              configurable: !0,
              enumerable: !0,
              value: X,
              writable: !0
            };
            Object.defineProperties(console, {
              info: d,
              log: d,
              warn: d,
              error: d,
              group: d,
              groupCollapsed: d,
              groupEnd: d
            });
          }
          ge++;
        }
      }
      function ce() {
        {
          if (ge--, ge === 0) {
            var d = {
              configurable: !0,
              enumerable: !0,
              writable: !0
            };
            Object.defineProperties(console, {
              log: e({}, d, {
                value: Y
              }),
              info: e({}, d, {
                value: fe
              }),
              warn: e({}, d, {
                value: q
              }),
              error: e({}, d, {
                value: U
              }),
              group: e({}, d, {
                value: te
              }),
              groupCollapsed: e({}, d, {
                value: H
              }),
              groupEnd: e({}, d, {
                value: P
              })
            });
          }
          ge < 0 && w("disabledDepth fell below zero. This is a bug in React. Please file an issue.");
        }
      }
      var ae = J.ReactCurrentDispatcher, oe;
      function K(d, g, _) {
        {
          if (oe === void 0)
            try {
              throw Error();
            } catch (A) {
              var E = A.stack.trim().match(/\n( *(at )?)/);
              oe = E && E[1] || "";
            }
          return `
` + oe + d;
        }
      }
      var me = !1, de;
      {
        var bt = typeof WeakMap == "function" ? WeakMap : Map;
        de = new bt();
      }
      function Je(d, g) {
        if (!d || me)
          return "";
        {
          var _ = de.get(d);
          if (_ !== void 0)
            return _;
        }
        var E;
        me = !0;
        var A = Error.prepareStackTrace;
        Error.prepareStackTrace = void 0;
        var T;
        T = ae.current, ae.current = null, se();
        try {
          if (g) {
            var N = function() {
              throw Error();
            };
            if (Object.defineProperty(N.prototype, "props", {
              set: function() {
                throw Error();
              }
            }), typeof Reflect == "object" && Reflect.construct) {
              try {
                Reflect.construct(N, []);
              } catch (pe) {
                E = pe;
              }
              Reflect.construct(d, [], N);
            } else {
              try {
                N.call();
              } catch (pe) {
                E = pe;
              }
              d.call(N.prototype);
            }
          } else {
            try {
              throw Error();
            } catch (pe) {
              E = pe;
            }
            d();
          }
        } catch (pe) {
          if (pe && E && typeof pe.stack == "string") {
            for (var M = pe.stack.split(`
`), Q = E.stack.split(`
`), W = M.length - 1, V = Q.length - 1; W >= 1 && V >= 0 && M[W] !== Q[V]; )
              V--;
            for (; W >= 1 && V >= 0; W--, V--)
              if (M[W] !== Q[V]) {
                if (W !== 1 || V !== 1)
                  do
                    if (W--, V--, V < 0 || M[W] !== Q[V]) {
                      var ue = `
` + M[W].replace(" at new ", " at ");
                      return typeof d == "function" && de.set(d, ue), ue;
                    }
                  while (W >= 1 && V >= 0);
                break;
              }
          }
        } finally {
          me = !1, ae.current = T, ce(), Error.prepareStackTrace = A;
        }
        var Le = d ? d.displayName || d.name : "", lt = Le ? K(Le) : "";
        return typeof d == "function" && de.set(d, lt), lt;
      }
      function qe(d, g, _) {
        return Je(d, !1);
      }
      function St(d) {
        var g = d.prototype;
        return !!(g && g.isReactComponent);
      }
      function Oe(d, g, _) {
        if (d == null)
          return "";
        if (typeof d == "function")
          return Je(d, St(d));
        if (typeof d == "string")
          return K(d);
        switch (d) {
          case h:
            return K("Suspense");
          case u:
            return K("SuspenseList");
        }
        if (typeof d == "object")
          switch (d.$$typeof) {
            case l:
              return qe(d.render);
            case f:
              return Oe(d.type, g, _);
            case y:
              return qe(d._render);
            case v: {
              var E = d, A = E._payload, T = E._init;
              try {
                return Oe(T(A), g, _);
              } catch {
              }
            }
          }
        return "";
      }
      var Ke = {}, Qe = J.ReactDebugCurrentFrame;
      function Ne(d) {
        if (d) {
          var g = d._owner, _ = Oe(d.type, d._source, g ? g.type : null);
          Qe.setExtraStackFrame(_);
        } else
          Qe.setExtraStackFrame(null);
      }
      function kt(d, g, _, E, A) {
        {
          var T = Function.call.bind(Object.prototype.hasOwnProperty);
          for (var N in d)
            if (T(d, N)) {
              var M = void 0;
              try {
                if (typeof d[N] != "function") {
                  var Q = Error((E || "React class") + ": " + _ + " type `" + N + "` is invalid; it must be a function, usually from the `prop-types` package, but received `" + typeof d[N] + "`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");
                  throw Q.name = "Invariant Violation", Q;
                }
                M = d[N](g, N, E, _, null, "SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED");
              } catch (W) {
                M = W;
              }
              M && !(M instanceof Error) && (Ne(A), w("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).", E || "React class", _, N, typeof M), Ne(null)), M instanceof Error && !(M.message in Ke) && (Ke[M.message] = !0, Ne(A), w("Failed %s type: %s", _, M.message), Ne(null));
            }
        }
      }
      var Ee = J.ReactCurrentOwner, De = Object.prototype.hasOwnProperty, Et = {
        key: !0,
        ref: !0,
        __self: !0,
        __source: !0
      }, et, tt, Ie;
      Ie = {};
      function Mt(d) {
        if (De.call(d, "ref")) {
          var g = Object.getOwnPropertyDescriptor(d, "ref").get;
          if (g && g.isReactWarning)
            return !1;
        }
        return d.ref !== void 0;
      }
      function Ot(d) {
        if (De.call(d, "key")) {
          var g = Object.getOwnPropertyDescriptor(d, "key").get;
          if (g && g.isReactWarning)
            return !1;
        }
        return d.key !== void 0;
      }
      function Nt(d, g) {
        if (typeof d.ref == "string" && Ee.current && g && Ee.current.stateNode !== g) {
          var _ = ie(Ee.current.type);
          Ie[_] || (w('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref', ie(Ee.current.type), d.ref), Ie[_] = !0);
        }
      }
      function zt(d, g) {
        {
          var _ = function() {
            et || (et = !0, w("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)", g));
          };
          _.isReactWarning = !0, Object.defineProperty(d, "key", {
            get: _,
            configurable: !0
          });
        }
      }
      function At(d, g) {
        {
          var _ = function() {
            tt || (tt = !0, w("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)", g));
          };
          _.isReactWarning = !0, Object.defineProperty(d, "ref", {
            get: _,
            configurable: !0
          });
        }
      }
      var Tt = function(d, g, _, E, A, T, N) {
        var M = {
          $$typeof: t,
          type: d,
          key: g,
          ref: _,
          props: N,
          _owner: T
        };
        return M._store = {}, Object.defineProperty(M._store, "validated", {
          configurable: !1,
          enumerable: !1,
          writable: !0,
          value: !1
        }), Object.defineProperty(M, "_self", {
          configurable: !1,
          enumerable: !1,
          writable: !1,
          value: E
        }), Object.defineProperty(M, "_source", {
          configurable: !1,
          enumerable: !1,
          writable: !1,
          value: A
        }), Object.freeze && (Object.freeze(M.props), Object.freeze(M)), M;
      };
      function Bt(d, g, _, E, A) {
        {
          var T, N = {}, M = null, Q = null;
          _ !== void 0 && (M = "" + _), Ot(g) && (M = "" + g.key), Mt(g) && (Q = g.ref, Nt(g, A));
          for (T in g)
            De.call(g, T) && !Et.hasOwnProperty(T) && (N[T] = g[T]);
          if (d && d.defaultProps) {
            var W = d.defaultProps;
            for (T in W)
              N[T] === void 0 && (N[T] = W[T]);
          }
          if (M || Q) {
            var V = typeof d == "function" ? d.displayName || d.name || "Unknown" : d;
            M && zt(N, V), Q && At(N, V);
          }
          return Tt(d, M, Q, A, E, Ee.current, N);
        }
      }
      var Re = J.ReactCurrentOwner, ot = J.ReactDebugCurrentFrame;
      function Ce(d) {
        if (d) {
          var g = d._owner, _ = Oe(d.type, d._source, g ? g.type : null);
          ot.setExtraStackFrame(_);
        } else
          ot.setExtraStackFrame(null);
      }
      var $e;
      $e = !1;
      function We(d) {
        return typeof d == "object" && d !== null && d.$$typeof === t;
      }
      function nt() {
        {
          if (Re.current) {
            var d = ie(Re.current.type);
            if (d)
              return `

Check the render method of \`` + d + "`.";
          }
          return "";
        }
      }
      function Pt(d) {
        {
          if (d !== void 0) {
            var g = d.fileName.replace(/^.*[\\\/]/, ""), _ = d.lineNumber;
            return `

Check your code at ` + g + ":" + _ + ".";
          }
          return "";
        }
      }
      var it = {};
      function Dt(d) {
        {
          var g = nt();
          if (!g) {
            var _ = typeof d == "string" ? d : d.displayName || d.name;
            _ && (g = `

Check the top-level render call using <` + _ + ">.");
          }
          return g;
        }
      }
      function st(d, g) {
        {
          if (!d._store || d._store.validated || d.key != null)
            return;
          d._store.validated = !0;
          var _ = Dt(g);
          if (it[_])
            return;
          it[_] = !0;
          var E = "";
          d && d._owner && d._owner !== Re.current && (E = " It was passed a child from " + ie(d._owner.type) + "."), Ce(d), w('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.', _, E), Ce(null);
        }
      }
      function at(d, g) {
        {
          if (typeof d != "object")
            return;
          if (Array.isArray(d))
            for (var _ = 0; _ < d.length; _++) {
              var E = d[_];
              We(E) && st(E, g);
            }
          else if (We(d))
            d._store && (d._store.validated = !0);
          else if (d) {
            var A = I(d);
            if (typeof A == "function" && A !== d.entries)
              for (var T = A.call(d), N; !(N = T.next()).done; )
                We(N.value) && st(N.value, g);
          }
        }
      }
      function It(d) {
        {
          var g = d.type;
          if (g == null || typeof g == "string")
            return;
          var _;
          if (typeof g == "function")
            _ = g.propTypes;
          else if (typeof g == "object" && (g.$$typeof === l || g.$$typeof === f))
            _ = g.propTypes;
          else
            return;
          if (_) {
            var E = ie(g);
            kt(_, d.props, "prop", E, d);
          } else if (g.PropTypes !== void 0 && !$e) {
            $e = !0;
            var A = ie(g);
            w("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?", A || "Unknown");
          }
          typeof g.getDefaultProps == "function" && !g.getDefaultProps.isReactClassApproved && w("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.");
        }
      }
      function Rt(d) {
        {
          for (var g = Object.keys(d.props), _ = 0; _ < g.length; _++) {
            var E = g[_];
            if (E !== "children" && E !== "key") {
              Ce(d), w("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.", E), Ce(null);
              break;
            }
          }
          d.ref !== null && (Ce(d), w("Invalid attribute `ref` supplied to `React.Fragment`."), Ce(null));
        }
      }
      function rt(d, g, _, E, A, T) {
        {
          var N = j(d);
          if (!N) {
            var M = "";
            (d === void 0 || typeof d == "object" && d !== null && Object.keys(d).length === 0) && (M += " You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.");
            var Q = Pt(A);
            Q ? M += Q : M += nt();
            var W;
            d === null ? W = "null" : Array.isArray(d) ? W = "array" : d !== void 0 && d.$$typeof === t ? (W = "<" + (ie(d.type) || "Unknown") + " />", M = " Did you accidentally export a JSX literal instead of a component?") : W = typeof d, w("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s", W, M);
          }
          var V = Bt(d, g, _, A, T);
          if (V == null)
            return V;
          if (N) {
            var ue = g.children;
            if (ue !== void 0)
              if (E)
                if (Array.isArray(ue)) {
                  for (var Le = 0; Le < ue.length; Le++)
                    at(ue[Le], d);
                  Object.freeze && Object.freeze(ue);
                } else
                  w("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");
              else
                at(ue, d);
          }
          return d === n.Fragment ? Rt(V) : It(V), V;
        }
      }
      function $t(d, g, _) {
        return rt(d, g, _, !0);
      }
      function Wt(d, g, _) {
        return rt(d, g, _, !1);
      }
      var Ht = Wt, Vt = $t;
      n.jsx = Ht, n.jsxs = Vt;
    }();
  }(Ve)), Ve;
}
(function(n) {
  process.env.NODE_ENV === "production" ? n.exports = Jt() : n.exports = qt();
})(Be);
const Ae = Be.exports.Fragment, m = Be.exports.jsx, F = Be.exports.jsxs, ne = mt(null), we = mt(null), Kt = ne.Provider, Qt = we.Provider, eo = "2.1.19", to = (n) => (n = n.replace("#", ""), n = n.replace("(", ""), n = n.replace(")", ""), n = n.replace(/,/, "-"), n), ye = (n) => {
  try {
    if ("touches" in n && n.touches || "targetTouches" in n && n.targetTouches)
      return !0;
  } catch {
  }
  return !1;
}, je = (n) => n instanceof TouchEvent ? {
  clientX: n.touches[0].clientX,
  clientY: n.touches[0].clientY
} : {
  clientX: n.clientX,
  clientY: n.clientY
}, p = (...n) => {
  typeof window < "u" && window.relationGraphDebug && console.log("[relation-graph:debug]", ...n);
}, Ye = (n, i, e) => n ? n.classList.contains(i) ? n : n.classList.contains(e) ? null : Ye(n.parentElement, i, e) : null, oo = async (n) => new Promise((i, e) => {
  setTimeout(() => {
    i();
  }, n);
}), Z = (n) => typeof n == "string" ? Number.parseInt(n) : n, no = (n) => {
  console.log(
    `%c relation-graph${n ? "" : "/" + n} %c Version v${eo} %c More info: https://github.com/seeksdream/relation-graph %c`,
    "background:#35495e ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff",
    "background:#41b883 ; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff",
    "background:#fff ; padding: 1px; border-radius: 0 3px 3px 0;  color: #41b883",
    "background:transparent"
  ), Ut || console.error(
    "[relation-graph]Please introduce component screenfull, for example:https://cdnjs.cloudflare.com/ajax/libs/screenfull.js/5.1.0/screenfull.min.js"
  ), Xt || console.error(
    "[relation-graph]Please introduce component html2canvas, for example:https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"
  );
}, Ze = (n) => {
  if (n.id === void 0)
    throw console.log("node must has id:", n), new Error("node must has option[id]:");
  const i = {
    id: n.id,
    text: n.text !== void 0 ? n.text : "",
    type: n.type !== void 0 ? n.type : "node",
    isShow: !0,
    isHide: n.isHide !== void 0 ? n.isHide : !1,
    expanded: n.expanded !== void 0 ? n.expanded : !0,
    junctionPoint: n.junctionPoint !== void 0 ? n.junctionPoint : void 0,
    alignItems: n.alignItems !== void 0 ? n.alignItems : void 0,
    selected: n.selected !== void 0 ? n.selected : !1,
    flashing: void 0,
    styleClass: n.styleClass !== void 0 ? n.styleClass : "",
    className: n.className !== void 0 ? n.className : "",
    targetNodes: [],
    targetFrom: [],
    targetTo: [],
    nodeShape: n.nodeShape !== void 0 ? n.nodeShape : void 0,
    borderWidth: n.borderWidth !== void 0 ? n.borderWidth : void 0,
    borderColor: n.borderColor !== void 0 ? n.borderColor : void 0,
    fontColor: n.fontColor !== void 0 ? n.fontColor : void 0,
    color: n.color !== void 0 ? n.color : void 0,
    opacity: n.opacity !== void 0 ? n.opacity : 1,
    fixed: n.fixed !== void 0 ? n.fixed : !1,
    width: n.width !== void 0 ? n.width : void 0,
    height: n.height !== void 0 ? n.height : void 0,
    force_weight: n.force_weight,
    x: n.x !== void 0 ? n.x : 0,
    y: n.y !== void 0 ? n.y : 0,
    Fx: 0,
    Fy: 0,
    offset_x: n.offset_x !== void 0 ? n.offset_x : 0,
    offset_y: n.offset_y !== void 0 ? n.offset_y : 0,
    expandHolderPosition: n.expandHolderPosition !== void 0 ? n.expandHolderPosition : void 0,
    innerHTML: n.innerHTML !== void 0 ? n.innerHTML : void 0,
    html: n.html !== void 0 ? n.html : void 0,
    disableDefaultClickEffect: n.disableDefaultClickEffect !== void 0 ? n.disableDefaultClickEffect : void 0,
    disableDrag: n.disableDrag !== void 0 ? n.disableDrag : !1,
    singleNode: !1,
    data: n.data !== void 0 ? n.data : {}
  };
  return i.lot = {
    childs: [],
    parent: void 0,
    eached: !1,
    strength: 0
  }, i.el === void 0 && (i.el = { offsetWidth: 50, offsetHeight: 50 }), i.width !== void 0 && (i.el.offsetWidth = i.width), i.height !== void 0 && (i.el.offsetHeight = i.height), i;
}, io = [
  "Fx",
  "Fy",
  "appended",
  "el",
  "targetFrom",
  "targetNodes",
  "targetTo",
  "type",
  "lot",
  "seeks_id"
], so = (n) => {
  if (!n)
    return;
  const i = {};
  return Object.keys(n).forEach((e) => {
    io.includes(e) || n[e] !== void 0 && (i[e] = n[e]);
  }), i;
}, Ue = (n) => {
  if (n.from === void 0)
    throw console.log("error,line must has option[from]:", n), new Error("error,line must has option[from]:");
  if (n.to === void 0)
    throw console.log("error,line must has option[to]:", n), new Error("error,line must has option[to]:");
  if (typeof n.from != "string")
    throw console.log("error line from, must be string:", n), new TypeError("error line from, must be string:");
  if (typeof n.to != "string")
    throw console.log("error line to, must be string:", n), new TypeError("error line to, must be string:");
  const i = {
    from: n.from,
    to: n.to,
    text: n.text !== void 0 ? n.text : "",
    textOffset_x: n.textOffset_x !== void 0 ? n.textOffset_x : void 0,
    textOffset_y: n.textOffset_y !== void 0 ? n.textOffset_y : void 0,
    color: n.color !== void 0 ? n.color : void 0,
    opacity: n.opacity !== void 0 ? n.opacity : 1,
    fontColor: n.fontColor !== void 0 ? n.fontColor : void 0,
    lineWidth: n.lineWidth !== void 0 ? n.lineWidth : void 0,
    lineShape: n.lineShape !== void 0 ? n.lineShape : void 0,
    styleClass: n.styleClass !== void 0 ? n.styleClass : void 0,
    isHide: n.isHide !== void 0 ? n.isHide : !1,
    arrow: n.arrow !== void 0 ? n.arrow : void 0,
    animation: n.animation !== void 0 ? n.animation : 0,
    dashType: n.dashType !== void 0 ? n.dashType : 0,
    disableDefaultClickEffect: n.disableDefaultClickEffect !== void 0 ? n.disableDefaultClickEffect : !1,
    showStartArrow: n.showStartArrow !== void 0 ? n.showStartArrow : !1,
    showEndArrow: n.showEndArrow !== void 0 ? n.showEndArrow : !0,
    useTextPath: n.useTextPath !== void 0 ? n.useTextPath : void 0,
    forDisplayOnly: n.forDisplayOnly || n.from === n.to,
    fromJunctionPoint: n.fromJunctionPoint,
    toJunctionPoint: n.toJunctionPoint,
    isHideArrow: n.isHideArrow !== void 0 ? n.isHideArrow : void 0,
    hidden: !1,
    lineDirection: n.lineDirection !== void 0 ? n.lineDirection : void 0,
    reverseText: n.reverseText !== void 0 ? n.reverseText : void 0,
    data: n.data !== void 0 ? n.data : {}
  };
  return i.isHideArrow && (i.showEndArrow = !1, i.isHideArrow = !1), i;
}, ao = ["arrow", "id", "reverseText", "isReverse"], ro = (n, i) => {
  !n || n.relations.forEach((e) => {
    const t = {};
    Object.keys(e).forEach((o) => {
      ao.includes(o) || e[o] !== void 0 && (t[o] = e[o]);
    }), i.push(t);
  });
}, he = {
  border: "border",
  ltrb: "ltrb",
  tb: "tb",
  lr: "lr",
  left: "left",
  right: "right",
  top: "top",
  bottom: "bottom"
}, x = {
  analysisNodes(n, i, e, t) {
    i.length > t.max_length && (t.max_length = i.length), e > t.max_deep && (t.max_deep = e);
    const o = {
      level: e,
      all_size: i.length,
      all_strength: 0
    };
    e === 0 && i.forEach((a) => {
      a.lot.parent = void 0;
    });
    const s = [];
    i.forEach((a) => {
      n.push(a), a.targetNodes && a.targetNodes.forEach((c) => {
        n.includes(c) || (n.push(c), c.lot.parent = a, s.push(c));
      });
    }), o.all_strength > t.max_strength && (t.max_strength = o.all_strength), s.length > 0 && x.analysisNodes(n, s, e + 1, t);
  },
  analysisNodes4Didirectional(n, i, e, t, o) {
    i.length > t.max_length && (t.max_length = i.length), e > t.max_deep && (t.max_deep = e);
    const s = {
      level: e,
      all_size: i.length,
      all_strength: 0
    }, a = [];
    i.forEach((r) => {
      r.lot || (r.lot = { childs: [] }), r.lot.eached = !0, r.lot.subling = s, r.lot.level = e, n.push(r);
    });
    let c = 0;
    i.forEach((r) => {
      let l = 0;
      if (o === 0) {
        let h = 0;
        r.targetNodes.forEach((u) => {
          u.lot || (u.lot = { eached: !1, childs: [] }), u.lot.eached || (x.isAllowShowNode(u) ? (u.lot.eached = !0, u.lot.parent = r, u.lot.index_of_parent = h++, r.lot.childs.push(u), a.push(u), l++) : r.lot.childs.push(u));
        });
      } else if (o === -1) {
        let h = 0;
        r.targetFrom.forEach((u) => {
          u.lot || (u.lot = { eached: !1, childs: [] }), u.lot.eached || (x.isAllowShowNode(u) ? (u.lot.eached = !0, u.lot.parent = r, u.lot.index_of_parent = h++, r.lot.childs.push(u), a.push(u), l++) : r.lot.childs.push(u));
        });
      } else {
        let h = 0;
        r.targetTo.forEach((u) => {
          u.lot || (u.lot = { eached: !1, childs: [] }), u.lot.eached || (x.isAllowShowNode(u) ? (u.lot.eached = !0, u.lot.parent = r, u.lot.index_of_parent = h++, r.lot.childs.push(u), a.push(u), l++) : r.lot.childs.push(u));
        });
      }
      r.lot.strength = l > 0 ? l : 1, s.all_strength += r.lot.strength, r.lot.strength_plus = s.all_strength, r.lot.index_of_level = c, r.lot.childs_size = l, c++;
    }), s.all_strength > t.max_strength && (t.max_strength = s.all_strength), a.length > 0 ? x.analysisNodes4Didirectional(n, a, e + (o === -1 ? -1 : 1), t, o) : (n.forEach((r) => {
      r.lot.childs_size > 0 && (r.lot.strengthWithChilds = 0);
    }), n.forEach((r) => {
      r.lot.childs_size === 0 && (r.lot.strengthWithChilds = 1, x.conductStrengthToParents(r));
    }), x.analysisDataTree([n[0]], 0, o));
  },
  conductStrengthToParents(n) {
    n.lot.parent && Math.abs(n.lot.level) - 1 === Math.abs(n.lot.parent.lot.level) && (n.lot.parent.lot.strengthWithChilds += 1, x.conductStrengthToParents(n.lot.parent));
  },
  analysisDataTree(n, i, e) {
    e === void 0 && (e = 1);
    const t = [];
    let o = 0;
    n.forEach((s) => {
      (s.lot.level === 0 || e === (s.lot.level < 0 ? -1 : 1)) && (s.lot.childs_size > 0 && s.lot.childs.forEach((a) => {
        t.push(a);
      }), s.lot.parent && o < s.lot.parent.lot.strengthWithChilds_from && (o = s.lot.parent.lot.strengthWithChilds_from), s.lot.strengthWithChilds_from = o, o += s.lot.strengthWithChilds);
    }), t.length > 0 && x.analysisDataTree(t, i + e, e);
  },
  isAllowShowNode(n, i = 0) {
    return i > 15 ? !0 : (!n.lot || !n.lot.parent || x.isAllowShowNode(n.lot.parent, i + 1) && n.lot.parent.expanded !== !1) && n.isShow && n.isHide !== !0;
  },
  getNodeWidth(n, i) {
    return n.el.offsetWidth || n.width || i && i.defaultNodeWidth || 50;
  },
  getNodeHeight(n, i) {
    return n.el.offsetHeight || n.height || i && i.defaultNodeHeight || 50;
  },
  getNodeXByLotX(n, i) {
    return (i.offset_x || 0) + this.getNodeXByCenterX(n, i, i.lot.x || 0);
  },
  getNodeYByLotY(n, i) {
    return (i.offset_y || 0) + this.getNodeYByCenterY(n, i, i.lot.y || 0);
  },
  getNodeXByCenterX(n, i, e) {
    return i.alignItems === "right" ? e - x.getNodeWidth(i, n) : i.alignItems === "left" ? e : e - x.getNodeWidth(i, n) / 2;
  },
  getNodeYByCenterY(n, i, e) {
    return i.alignItems === "top" ? e : i.alignItems === "bottom" ? e - x.getNodeHeight(i, n) : e - x.getNodeHeight(i, n) / 2;
  },
  getCenterXByNodeX(n, i, e) {
    return e + x.getNodeHeight(i, n) / 2;
  },
  getCenterYByNodeY(n, i, e) {
    return e + x.getNodeHeight(i, n) / 2;
  },
  getLotXByNodeX(n, i) {
    const e = i.offset_x || 0;
    return this.getCenterXByNodeX(n, i, i.x || 0) - e;
  },
  getLotYByNodeY(n, i) {
    const e = i.offset_y || 0;
    return this.getCenterYByNodeY(n, i, i.y || 0) - e;
  }
};
class Pe {
  constructor(i, e) {
    L(this, "graphOptions");
    L(this, "layoutOptions");
    L(this, "allNodes", []);
    L(this, "isMainLayouer", !0);
    L(this, "requireLinks", !1);
    L(this, "allLinks", []);
    L(this, "rootNode");
    L(this, "currentAnimationStep", 1);
    L(this, "allAnimationStep", 30);
    this.layoutOptions = i, this.graphOptions = e;
  }
  setLinks(i) {
    p("setLinks:", i.length), this.allLinks = i;
  }
  refresh() {
    this.placeNodes(this.allNodes, this.rootNode);
  }
  placeNodes(i, e) {
    this.allNodes = i, this.rootNode = e;
  }
  snapshotBeforeAnimation() {
    this.allNodes.forEach((i) => {
      !x.isAllowShowNode(i) || (i.lot.to_x = x.getNodeXByLotX(this.graphOptions, i), i.lot.to_y = x.getNodeYByLotY(this.graphOptions, i), i.lot.from_x = i.x || 0, i.lot.from_y = i.y || 0, i.lot.placed = !0);
    });
  }
  async animationLayout(i = !0) {
    i && this.snapshotBeforeAnimation();
    const e = this.rootNode;
    e && p("debug0910:create rootNode coordinates:2.1", e.x, e.y), this.currentAnimationStep = 1, this.allAnimationStep = 10, p("[LayoutAnimationEffect]start play...");
    let t = !1;
    return new Promise((o, s) => {
      this.playAnimation(() => {
        t || (t = !0, p("[LayoutAnimationEffect]played!"), this.allNodes.forEach((a) => {
          !x.isAllowShowNode(a) || (a.lot.from_x = a.x, a.lot.from_y = a.y, a.x = a.lot.to_x, a.y = a.lot.to_y);
        }), o());
      });
    });
  }
  playAnimation(i) {
    if (p("[LayoutAnimationEffect]", this.currentAnimationStep, this.allAnimationStep), this.currentAnimationStep > this.allAnimationStep) {
      i();
      return;
    }
    this.allNodes.forEach((e) => {
      if (!e.lot.placed)
        return;
      const { from_x: t, from_y: o, to_x: s, to_y: a } = e.lot;
      if (t !== void 0 && o !== void 0 && s !== void 0 && a !== void 0) {
        const c = (s - t) / this.allAnimationStep, r = (a - o) / this.allAnimationStep, l = Math.floor(t + this.currentAnimationStep * c), h = Math.floor(o + this.currentAnimationStep * r);
        (e.x !== l || e.y !== h) && (e.x = l, e.y = h);
      }
    }), this.currentAnimationStep++, requestAnimationFrame(this.playAnimation.bind(this, i));
  }
}
class lo extends Pe {
  constructor(e, t) {
    super(e, t);
    L(this, "enableGatherNodes", !1);
    L(this, "layoutOptions");
    L(this, "levelDistanceArr", []);
    this.layoutOptions = e, p("new SeeksBidirectionalTreeLayouter:", this.layoutOptions), this.layoutOptions.from || (this.layoutOptions.from = "left"), this.layoutOptions.levelDistance && (typeof this.layoutOptions.levelDistance == "string" ? this.levelDistanceArr = this.layoutOptions.levelDistance.split(",").map((o) => Number.parseInt(o)) : Array.isArray(this.layoutOptions.levelDistance) && (this.levelDistanceArr = this.layoutOptions.levelDistance)), this.enableGatherNodes = this.layoutOptions.enableGatherNodes;
  }
  async refresh() {
    p("SeeksBidirectionalTreeLayouter:refresh:nodes:", this.allNodes.length), await this.placeNodes(this.allNodes, this.rootNode);
  }
  analysisNodes4Didirectional(e, t, o, s, a) {
    p(`${a} level ${o} size: ${t.length}`), t.length > s.max_length && (s.max_length = t.length), o > s.max_deep && (s.max_deep = o);
    const c = {
      level: o,
      all_size: t.length,
      all_strength: 0
    }, r = [];
    t.forEach((h) => {
      h.lot || (h.lot = { childs: [] }), h.lot.eached = !0, h.lot.subling = c, h.lot.level = o, e.push(h);
    });
    let l = 0;
    t.forEach((h) => {
      let u = 0, f = a === -1 ? h.targetFrom : h.targetTo;
      o !== 0 && (f = h.targetNodes);
      let v = 0;
      f.forEach((y) => {
        y.lot || (y.lot = { eached: !1, childs: [] }), y.lot.eached || (y.lot.parent = h, x.isAllowShowNode(y) ? (y.lot.eached = !0, y.lot.index_of_parent = v++, h.lot.childs.push(y), r.push(y), u++) : h.lot.childs.push(y));
      }), h.lot.strength = u > 0 ? u : 1, c.all_strength += h.lot.strength, h.lot.strength_plus = c.all_strength, h.lot.index_of_level = l, h.lot.childs_size = u, l++;
    }), c.all_strength > s.max_strength && (s.max_strength = c.all_strength), r.length > 0 ? this.analysisNodes4Didirectional(e, r, o + a, s, a) : (e.forEach((h) => {
      h.lot.childs_size > 0 && (h.lot.strengthWithChilds = 0);
    }), e.forEach((h) => {
      h.lot.childs_size === 0 && (h.lot.strengthWithChilds = 1, x.conductStrengthToParents(h));
    }), x.analysisDataTree([e[0]], 0, a));
  }
  async placeNodes(e, t) {
    if (p("SeeksBidirectionalTreeLayouter:placeNodes"), t)
      p("layout by root:", t);
    else {
      console.error("root is null");
      return;
    }
    this.rootNode = t, this.allNodes = e, p("allNodes:", e.length), e.forEach((a) => {
      a.lot.eached = !1, a.lot.notLeafNode = !1, a.lot.childs = [], a.lot.parent = void 0, a.lot.index_of_parent = 0, a.lot.strength = 0, a.lot.strengthWithChilds_from = 0, a.lot.strengthWithChilds = 0, a.lot.placed = !1;
    });
    let o = [], s = {
      max_deep: 1,
      max_length: 1,
      max_strength: 1
    };
    x.analysisNodes(o, [this.rootNode], 0, s), o = [], s = {
      max_deep: 1,
      max_length: 1,
      max_strength: 1
    }, this.analysisNodes4Didirectional(o, [this.rootNode], 0, s, -1), this.placeNodesPosition(this.rootNode, o, s), o = [], s = {
      max_deep: 1,
      max_length: 1,
      max_strength: 1
    }, this.analysisNodes4Didirectional(o, [this.rootNode], 0, s, 1), this.placeNodesPosition(this.rootNode, o, s), p("allNodes:", o.length), this.graphOptions.useAnimationWhenExpanded ? (p("Play layout animation....."), await this.animationLayout(), p("create rootNode coordinates:3", t.x, t.y)) : (this.allNodes.forEach((a) => {
      if (a.fixed === !0) {
        a.lot.placed = !0;
        return;
      }
      !x.isAllowShowNode(a) || (Number.isNaN(a.lot.x) && (p("bad lot x:", a.text, a.lot.x), a.lot.x = 0), Number.isNaN(a.lot.y) && (p("bad lot y:", a.text, a.lot.y), a.lot.y = 0), a.x = x.getNodeXByLotX(this.graphOptions, a), a.y = x.getNodeYByLotY(this.graphOptions, a), a.lot.placed = !0);
    }), p("create rootNode coordinates:1", t.x, t.y));
  }
  placeNodesPosition(e, t, o) {
    if (e.fixed !== !0) {
      const s = this.layoutOptions.centerOffset_x || 0, a = this.layoutOptions.centerOffset_y || 0;
      e.lot.x = s, e.lot.y = a, this.layoutOptions.fixedRootNode ? (e.lot.x = x.getLotXByNodeX(this.graphOptions, e), e.lot.y = x.getLotYByNodeY(this.graphOptions, e)) : this.layoutOptions.from === "top" ? e.lot.y -= this.graphOptions.viewSize.height / 2 - 100 : this.layoutOptions.from === "bottom" ? e.lot.y += this.graphOptions.viewSize.height / 2 - 200 : this.layoutOptions.from === "right" ? e.lot.x += this.graphOptions.viewSize.width / 2 - 100 : e.lot.x -= this.graphOptions.viewSize.width / 2 - 100, p("debug0910:Graph center:", e.lot.x, e.lot.y, { _center_offset_x: s, _center_offset_y: a });
    } else
      e.origin_x === void 0 && (e.origin_x = e.x, e.origin_y = e.y), e.lot.x = e.origin_x, e.lot.y = e.origin_y, p("\u56FA\u5B9A\u4F4D\u7F6E\u7684rootNode:", e.text, e.x, e.y);
    e.lot.placed = !0, this.placeRelativePosition(e, t, o);
  }
  placeRelativePosition(e, t, o) {
    const s = this.graphOptions.viewSize;
    if (this.layoutOptions.from === "left" || this.layoutOptions.from === "right") {
      const a = Z(this.layoutOptions.min_per_height) || 80, c = Z(this.layoutOptions.max_per_height) || 400, r = Z(this.layoutOptions.min_per_width) || 430, l = Z(this.layoutOptions.max_per_width) || 650;
      let h = Math.round((s.width - 10) / (o.max_deep + 2));
      h < r && (h = r), h > l && (h = l);
      let u = Math.round(s.height / (o.max_strength + 1));
      u < a && (u = a), u > c && (u = c), t.forEach((f) => {
        f.fixed !== !0 && f.lot.placed !== !0 && f !== e && (this.layoutOptions.from === "right" ? f.lot.x = e.lot.x - this.getLevelDistance(f, f.lot.subling.level, h) : f.lot.x = e.lot.x + this.getLevelDistance(f, f.lot.subling.level, h));
      }), t.forEach((f) => {
        f.fixed !== !0 && f.lot.level !== 0 && (f.lot.y = e.lot.y + u * (o.max_strength / -2 + f.lot.strengthWithChilds_from + f.lot.strengthWithChilds / 2));
      }), this.gatherNodes(t, "h", u);
    } else {
      const a = Z(this.layoutOptions.min_per_height) || 350, c = Z(this.layoutOptions.max_per_height) || 400, r = Z(this.layoutOptions.min_per_width) || 250, l = Z(this.layoutOptions.max_per_width) || 500;
      let h = Math.round((s.width - 10) / (o.max_strength + 2));
      h < r && (h = r), h > l && (h = l);
      let u = Math.round((s.height - 10) / (o.max_deep + 2));
      u < a && (u = a), u > c && (u = c), t.forEach((f) => {
        f.fixed !== !0 && f.lot.placed !== !0 && f !== e && (this.layoutOptions.from === "bottom" ? f.lot.y = e.lot.y - this.getLevelDistance(f, f.lot.subling.level, u) : f.lot.y = e.lot.y + this.getLevelDistance(f, f.lot.subling.level, u));
      }), t.forEach((f) => {
        f.fixed !== !0 && f.lot.level !== 0 && (f.lot.x = e.lot.x + h * (o.max_strength / -2 + f.lot.strengthWithChilds_from + f.lot.strengthWithChilds / 2));
      }), this.gatherNodes(t, "v", h);
    }
  }
  gatherNodes(e, t, o) {
    if (!this.enableGatherNodes)
      return;
    const s = {};
    e.forEach((a) => {
      const c = a.lot.level + "";
      s[c] || (s[c] = []), s[c].push(a), a.lot.movedNodeSizeBefore = 1, a.lot.movedNodeSizeAfter = 1;
    }), e.forEach((a) => {
      if (a.fixed !== !0 && a.lot.level !== 0) {
        const c = a.lot.level + "", r = s[c];
        if (a.lot.strengthWithChilds === 1 && a.lot.childs_size <= 1) {
          const l = this.getBloomingNearByParent(a, a.lot.parent, r, t);
          l && (console.log(a.text, "bloomingNode:", l.text, l.lot.y, o), t === "h" ? a.lot.y - l.lot.y > 0 ? (a.lot.y = l.lot.y + o * l.lot.movedNodeSizeAfter, l.lot.movedNodeSizeAfter++) : (a.lot.y = l.lot.y - o * l.lot.movedNodeSizeBefore, l.lot.movedNodeSizeBefore++) : a.lot.x - l.lot.x > 0 ? (a.lot.x = l.lot.x + o * l.lot.movedNodeSizeAfter, l.lot.movedNodeSizeAfter++) : (a.lot.x = l.lot.x - o * l.lot.movedNodeSizeBefore, l.lot.movedNodeSizeBefore++));
        }
      }
    });
  }
  getBloomingNearByParent(e, t, o, s) {
    let a = 9999, c;
    for (const r of o)
      if (r.lot.childs_size > 1 && r.lot.parent === t) {
        const l = s === "h" ? r.lot.y - t.lot.y : r.lot.x - t.lot.x;
        Math.abs(l) < a && (a = Math.abs(l), c = r);
      }
    if (c && c !== e)
      return c;
  }
  getLevelDistance(e, t, o) {
    const s = Math.abs(t);
    if (this.levelDistanceArr && this.levelDistanceArr.length > 0) {
      let a = 0;
      for (let c = 0; c < s; c++) {
        const r = this.levelDistanceArr[c] || 100;
        a += r;
      }
      return t > 0 ? a : a * -1;
    } else
      return t * o;
  }
}
const dt = 0, ee = {
  getRectPoint(n, i, e, t, o, s, a, c, r = !1, l = 1, h = 1) {
    r && (h = l - h - 1);
    const u = 40 / (l + 1) * (h + 1) - 20, f = n + o / 2, v = i + s / 2, y = e + a / 2, C = t + c / 2, b = f < y ? 1 : -1, z = v < C ? 1 : -1;
    if (C === v)
      return { x: f + b * o / 2, y: v };
    const B = Math.abs((y - f) / (C - v)), S = o / s;
    let k = 0, D = 0;
    return B < S ? (k = b * s / 2 * B + z * u * S, D = z * s / 2) : (k = b * o / 2, D = z * o / 2 / B + b * u * S), { x: f + k, y: v + D };
  },
  getRectPointBasic(n, i, e, t, o, s, a, c) {
    const r = n + o / 2, l = i + s / 2, h = e + a / 2, u = t + c / 2;
    let f = u === l ? 0 : (h - r) / (u - l);
    f === 0 && (f = (h - r) / (u - l + 1));
    const v = o / c;
    let y = 0, C = 0, b = "1";
    return -1 * v < f && f < v ? (b = "2", l < u ? (y = s / 2 * f, C = s / 2) : (y = -1 * s / 2 * f, C = -1 * s / 2)) : (r < h ? (y = 1 * o / 2, C = 1 * o / 2 / f) : (y = -1 * o / 2, C = -1 * o / 2 / f), b = "3"), { x: r + y, y: l + C, _case: b };
  },
  getRectJoinPoint(n, i, e, t, o, s, a, c) {
    const r = n + o / 2, l = i + s / 2, h = e + a / 2, u = t + c / 2, f = Math.round(Math.atan2(u - l, h - r) * 180 / 3.14) + 135;
    return f >= 0 && f < 90 ? { x: n + o / 2, y: i - 5 } : f >= 90 && f < 180 ? { x: n + o + 5, y: i + s / 2 } : f >= 180 && f < 270 ? { x: n + o / 2, y: i + s + 5 } : { x: n - 5, y: i + s / 2 };
  },
  getRectHJoinPoint(n, i, e, t, o, s, a) {
    const c = s / 2;
    return n + o < e ? { x: n + o + 5, y: i + c } : n + o < e + a ? { x: n - 5, y: i + c } : { x: n - 5, y: i + c };
  },
  getRectLeftJoinPoint(n, i, e, t, o, s, a) {
    const c = s / 2;
    return { x: n - 5, y: i + c };
  },
  getRectRightJoinPoint(n, i, e, t, o, s, a) {
    const c = s / 2;
    return { x: n + o + 5, y: i + c };
  },
  getRectTopJoinPoint(n, i, e, t, o, s, a) {
    return { x: n + o / 2, y: i - 5 };
  },
  getRectBottomJoinPoint(n, i, e, t, o, s, a) {
    return { x: n + o / 2, y: i + s + 5 };
  },
  getRectVJoinPoint(n, i, e, t, o, s, a, c) {
    const r = o / 2;
    return i + s < t ? { y: i + s + 5, x: n + r } : i + s < t + c ? { y: i - 5, x: n + r } : { y: i - 5, x: n + r };
  },
  getBorderPoint(n, i, e, t, o, s, a, c, r) {
    return r === 0 ? this.getCirclePoint(n, i, e, t, o, s, a, c) : this.getRectPoint(n, i, e, t, o, s, a, c);
  },
  getBorderPoint4MultiLine(n, i, e, t, o, s, a, c, r, l, h, u) {
    return r === 0 ? this.getCirclePoint4MultiLine(n, i, e, t, o, s, a, c, l, h, u) : this.getRectPoint(n, i, e, t, o, s, a, c, l, h, u);
  },
  getCirclePoint(n, i, e, t, o, s, a, c) {
    const r = e + a / 2, l = t + c / 2, h = n + o / 2, u = i + s / 2, f = r - h;
    if (f === 0)
      return { x: h, y: u - s / 2 * (l < u ? 1 : -1) };
    const y = (l - u) / f, C = Math.sqrt(1 / (1 / (o / 2) ** 2 + y ** 2 / (s / 2) ** 2)) * (r < h ? 1 : -1), b = y * C;
    return { x: h - C, y: u - b };
  },
  getCirclePoint4MultiLine(n, i, e, t, o, s, a, c, r, l, h) {
    r && (h = l - h - 1);
    const u = e + a / 2, f = t + c / 2, v = n + o / 2, y = i + s / 2, C = u - v;
    if (C === 0)
      return { x: v, y: y - s / 2 * (f < y ? 1 : -1) };
    const b = 40 / (l + 1) * (h + 1) - 20, z = f - y, B = Math.sqrt(C ** 2 + z ** 2) * b / C, S = z / C, k = o / 2, D = s / 2, I = u < v ? 1 : -1, J = (-1 * k ** 2 * S * B + k * D * Math.sqrt(D ** 2 + S ** 2 * k ** 2 - B ** 2) / I) / (D ** 2 + k ** 2 * S ** 2), w = S * J + B;
    return { x: v - J, y: y - w };
  },
  getCirclePointBasic(n, i, e, t, o, s, a, c, r) {
    const l = n + o / 2, h = i + s / 2, u = e + a / 2, f = t + c / 2, v = u - l, y = f - h, C = Math.sqrt(v * v + y * y), b = C - r, z = b * v / C * -1, B = b * y / C * -1;
    return { x: u + z, y: f + B };
  },
  getCirclePointPlus(n, i, e, t, o, s, a, c) {
    const r = n + o / 2, l = i + s / 2, h = e + a / 2, u = t + c / 2, f = h - r, v = u - l, y = Math.sqrt(f * f + v * v), C = (y - o / 2) * f / y * -1, b = (y - s / 2) * v / y * -1;
    return { x: h + C, y: u + b };
  },
  getOvalPoint(n, i, e, t, o) {
    return {
      x: n + e * Math.sin((dt + t * (360 / o) + 0) * Math.PI / 180),
      y: i + e * Math.cos((dt + t * (360 / o) + 0) * Math.PI / 180) * -1
    };
  },
  getAngleType(n, i) {
    if (n >= 0 && i >= 0)
      return 1;
    if (n < 0 && i >= 0)
      return 2;
    if (n < 0 && i < 0)
      return 3;
    if (n >= 0 && i < 0)
      return 4;
  },
  getTextAngle(n, i, e, t) {
    let o = Math.atan2(t - i, e - n) * 180 / Math.PI;
    return o < 0 && (o += 360), o > 90 && o <= 270 && (o += 180), o >= 360 && (o -= 360), Math.round(o);
  },
  getTreePointFromTop(n, i, e, t, o, s) {
    return n ? {
      x: n - 300 + Math.max(600 / ((o === 1 ? 2 : o) - 1), 80) * t,
      y: i + e
    } : {
      x: (s.canvas_width - s.node_width) / 2,
      y: (s.canvas_height - s.node_height) / 2 - 200
    };
  },
  getTreePointFromRight(n, i, e, t, o, s) {
    return n ? {
      x: n - e,
      y: i - 200 + Math.max(400 / ((o === 1 ? 2 : o) - 1), 80) * t
    } : {
      x: (s.canvas_width - s.node_width) / 2 + 300,
      y: (s.canvas_height - s.node_height) / 2
    };
  },
  getTreePointFromBottom(n, i, e, t, o, s) {
    return n ? {
      x: n - 300 + Math.max(600 / ((o === 1 ? 2 : o) - 1), 80) * t,
      y: i - e
    } : {
      x: (s.canvas_width - s.node_width) / 2,
      y: (s.canvas_height - s.node_height) / 2 + 200
    };
  },
  getTreePointFromLeft(n, i, e, t, o, s) {
    return n ? {
      x: n + e,
      y: i - 200 + Math.max(400 / ((o === 1 ? 2 : o) - 1), 80) * t
    } : {
      x: (s.canvas_width - s.node_width) / 2 - 300,
      y: (s.canvas_height - s.node_height) / 2
    };
  }
};
class Me extends Pe {
  constructor(e, t) {
    super(e, t);
    L(this, "layoutOptions");
    L(this, "fastStart", !1);
    L(this, "maxLayoutTimes", 300);
    L(this, "byNode", !0);
    L(this, "byLine", !0);
    L(this, "lockX", !1);
    L(this, "lockY", !1);
    L(this, "force_node_repulsion", 1);
    L(this, "force_line_elastic", 1);
    L(this, "justLayoutSingleNode", !1);
    L(this, "layoutTimes", 0);
    L(this, "prev10", []);
    L(this, "visibleNodes", []);
    L(this, "viewUpdate");
    L(this, "maxVaildLineLength", 400);
    L(this, "minVaildLineLength", 30);
    L(this, "zeroEffectNodeDistance", 400);
    L(this, "minNodeDistance", 30);
    L(this, "maxMoveSpeed", 50);
    this.layoutOptions = e, this.layoutOptions.fastStart !== void 0 && (this.fastStart = this.layoutOptions.fastStart), this.layoutOptions.maxLayoutTimes !== void 0 && (this.maxLayoutTimes = this.layoutOptions.maxLayoutTimes), this.layoutOptions.byNode !== void 0 && (this.byNode = this.layoutOptions.byNode), this.layoutOptions.byLine !== void 0 && (this.byLine = this.layoutOptions.byLine), this.layoutOptions.force_node_repulsion !== void 0 && (this.force_node_repulsion = this.layoutOptions.force_node_repulsion), this.layoutOptions.force_line_elastic !== void 0 && (this.force_line_elastic = this.layoutOptions.force_line_elastic);
  }
  refresh() {
    this.placeNodes(this.allNodes, this.rootNode);
  }
  placeNodes(e, t) {
    if (p("!!!SeeksForceLayouter.placeNodes"), t)
      p("layout by root:", t);
    else {
      p("root is null:", t);
      return;
    }
    if (this.allNodes = e, this.rootNode = t, this.layoutOptions.fixedRootNode) {
      if (!Number.isNaN(t.x) && t.x)
        t.lot.x = x.getLotXByNodeX(this.graphOptions, t), t.lot.y = x.getLotYByNodeY(this.graphOptions, t);
      else {
        const s = this.layoutOptions.centerOffset_x || 0, a = this.layoutOptions.centerOffset_y || 0;
        t.lot.x = 0 + s, t.lot.y = 0 + a;
      }
      const o = this.easyAnalysisNodes(t);
      this.easyPlaceRelativePosition(t, o), o.forEach((s) => {
        if (s.fixed === !0 || !x.isAllowShowNode(s))
          return;
        const a = s.offset_x || 0, c = s.offset_y || 0;
        s.x = s.lot.x + a - x.getNodeWidth(s, this.graphOptions) / 2, s.y = s.lot.y + c - x.getNodeHeight(s, this.graphOptions) / 2, s.lot.placed = !0;
      });
    } else
      this.fastStart ? (p("!!!initNodesPosition fastStart"), this.allNodes.forEach((o) => {
        o.fixed !== !0 && (o.lot.placed || (o.x || (o.x = Math.floor(Math.random() * 200) - 100), o.x || (o.y = Math.floor(Math.random() * 200) - 100), o.lot.placed = !0));
      })) : (p("!!!initNodesPosition....."), this.easyPlaceGroupNodes(this.rootNode).forEach((s) => {
        if (s.fixed === !0 || !x.isAllowShowNode(s))
          return;
        const a = s.offset_x || 0, c = s.offset_y || 0;
        s.x = s.lot.x + a - x.getNodeWidth(s, this.graphOptions) / 2, s.y = s.lot.y + c - x.getNodeHeight(s, this.graphOptions) / 2, s.lot.placed = !0;
      }));
    if (p("Start Auto Layout....."), this.updateVisibleNodes(), this.isMainLayouer && this.graphOptions.autoLayouting) {
      p("!!!autoLayouting.....");
      return;
    }
    this.autoLayout(!0);
  }
  easyPlaceGroupNodes(e) {
    if (p("[layout canvasOffset]", this.graphOptions.viewSize, this.graphOptions.canvasSize), e) {
      e.fixed ? (e.origin_x === void 0 && (e.origin_x = e.x, e.origin_y = e.y), e.lot.x = e.origin_x, e.lot.y = e.origin_y, p("root fixed position:", e.lot.x, e.lot.y)) : this.layoutOptions.fixedRootNode ? (console.error("xxxxxxxx"), e.lot.x = x.getLotXByNodeX(this.graphOptions, e), e.lot.y = x.getLotYByNodeY(this.graphOptions, e)) : (e.lot.x = 0, e.lot.y = 0, p("root position:", e.lot.x, e.lot.y));
      const t = this.easyAnalysisNodes(e);
      return this.easyPlaceRelativePosition(e, t), t;
    }
    return [];
  }
  easyAnalysisNodes(e) {
    this.allNodes.forEach((s) => {
      s.lot.eached = !1, s.lot.notLeafNode = !1, s.lot.childs = [], s.lot.parent = void 0, s.lot.index_of_parent = 0, s.lot.strength = 0, s.lot.placed = !1;
    });
    const t = [], o = {
      max_deep: 1,
      max_length: 1,
      max_strength: 1
    };
    return x.analysisNodes4Didirectional(t, [e], 0, o, 0), t;
  }
  easyPlaceRelativePosition(e, t) {
    t.forEach((s) => {
      if (s.lot.subling.level === 1) {
        const a = s.lot.subling;
        if (a) {
          const c = ee.getOvalPoint(e.lot.x, e.lot.y, a.level * 50, s.lot.strength_plus - s.lot.strength / 2, a.all_strength);
          s.lot.x = c.x, s.lot.y = c.y;
        }
      }
    }), t.forEach((s) => {
      const a = s.lot.subling;
      if (a && a.level > 1) {
        const c = s.lot.parent.lot.strength_plus - s.lot.parent.lot.strength, l = (s.lot.parent.lot.strength_plus - c) / (s.lot.parent.lot.childs.length + 1) * (s.lot.index_of_parent + 1), h = ee.getOvalPoint(e.lot.x, e.lot.y, (a.level - 1) * 40 + 50, c + l, s.lot.parent.lot.subling.all_strength);
        s.lot.x = h.x, s.lot.y = h.y;
      }
    });
  }
  updateVisibleNodes(e) {
    this.visibleNodes = [], e && (this.allNodes = e), this.allNodes.forEach((t) => {
      x.isAllowShowNode(t) && (t.Fx = 0, t.Fy = 0, t.lot ? t.lot.placed = !0 : (p("node miss lot:", t.text), t.lot = {
        placed: !0,
        childs: []
      }), this.visibleNodes.push(t));
    }), p("visibleNodes:", this.visibleNodes.length);
  }
  autoLayout(e, t) {
    this.layoutTimes = 0, this.updateVisibleNodes(), this.viewUpdate = t, this.doForceLayout(0);
  }
  doForceLayout(e) {
    if (this.graphOptions.instanceDestroyed) {
      p("stop layout:instanceDestroyed");
      return;
    }
    let t = 0;
    if (e > 0) {
      if (this.prev10.length >= 10) {
        this.prev10.splice(0, 1);
        const o = this.prev10[this.prev10.length - 1] - this.prev10[0];
        t = Math.round(1e3 / (o / 10));
      }
      this.prev10.push(e);
    }
    if (p("this.layoutTimes:", this.layoutTimes, "of", this.maxLayoutTimes, "Current refresh rate:", t, "Hz", this.requireLinks, this.allLinks.length), this.layoutTimes > this.maxLayoutTimes) {
      this.isMainLayouer && (this.graphOptions.autoLayouting = !1);
      return;
    }
    if (this.isMainLayouer && (this.graphOptions.autoLayouting = !0), this.layoutTimes++, this.visibleNodes.forEach((o) => {
      o.Fx = 0, o.Fy = 0;
    }), this.byNode)
      for (const o in this.visibleNodes) {
        const s = this.visibleNodes[o];
        if (!(this.justLayoutSingleNode && !s.singleNode) && !s.fixed && s.lot.placed === !0)
          for (const a in this.visibleNodes) {
            const c = this.visibleNodes[a];
            c.lot.placed === !0 && o !== a && this.addGravityByNode(s, c);
          }
      }
    if (this.byLine)
      if (this.allLinks && this.allLinks.length > 0) {
        for (const o of this.allLinks)
          if (!o.forDisplayOnly) {
            const s = o.relations.reduce((a, c) => a + (c.force_elastic || 1), 0);
            (this.visibleNodes.includes(o.fromNode) || this.visibleNodes.includes(o.toNode)) && this.addElasticByLine(
              o.fromNode,
              o.toNode,
              s
            );
          }
      } else
        for (const o of this.visibleNodes)
          o.lot.parent && this.addElasticByLine(
            o.lot.parent,
            o
          );
    for (const o in this.visibleNodes)
      this.applyToNodePosition(this.visibleNodes[o]);
    this.viewUpdate && this.viewUpdate(), requestAnimationFrame(this.doForceLayout.bind(this));
  }
  stop() {
    p("[SeeksForceLayouter]stop:", this.graphOptions.autoLayouting), this.layoutTimes = 1e6;
  }
  getX(e) {
    const t = (e.width || e.el.offsetWidth || 60) / 2;
    return e.x + t;
  }
  getY(e) {
    const t = (e.height || e.el.offsetHeight || 60) / 2;
    return e.y + t;
  }
  addElasticByLine(e, t, o = 1) {
    let s = Math.sqrt((this.getY(e) - this.getY(t)) ** 2 + (this.getX(e) - this.getX(t)) ** 2);
    s > this.maxVaildLineLength && (s = this.maxVaildLineLength);
    const a = s < this.minVaildLineLength ? 0 : (s - this.minVaildLineLength) * 0.1 * this.force_line_elastic * o, c = a, r = a, l = (this.getX(e) - this.getX(t)) / s, h = (this.getY(e) - this.getY(t)) / s;
    this.addFtoNode(e, l * c * -1, h * c * -1), this.addFtoNode(t, l * r, h * r);
  }
  addGravityByNode(e, t) {
    const o = Math.sqrt(
      (this.getY(e) - this.getY(t)) ** 2 + (this.getX(e) - this.getX(t)) ** 2
    );
    let s = o > this.zeroEffectNodeDistance ? 0 : (this.zeroEffectNodeDistance - o) * 0.05 * this.force_node_repulsion;
    o < this.minNodeDistance && (s = s * 2);
    const a = (this.getX(e) - this.getX(t)) / o, c = (this.getY(e) - this.getY(t)) / o;
    this.addFtoNode(e, a * s, c * s), this.addFtoNode(t, a * s * -1, c * s * -1);
  }
  addFtoNode(e, t, o) {
    if (this.justLayoutSingleNode && !e.singleNode || Number.isNaN(t) || Number.isNaN(o))
      return;
    t = t / (e.lot.strength || 1), o = o / (e.lot.strength || 1), t > 50 && (t = 50), o > 50 && (o = 50), t < -50 && (t = -50), o < -50 && (o = -50);
    const s = e.force_weight || 1;
    this.lockX || (e.Fx += t * (1 / s)), this.lockY || (e.Fy += o * (1 / s));
  }
  applyToNodePosition(e) {
    if (e.fixed)
      return;
    let t = Math.round(e.Fx), o = Math.round(e.Fy);
    t > this.maxMoveSpeed && (t = this.maxMoveSpeed), o > this.maxMoveSpeed && (o = this.maxMoveSpeed), t < -this.maxMoveSpeed && (t = -this.maxMoveSpeed), o < -this.maxMoveSpeed && (o = -this.maxMoveSpeed), e.x = e.x + t, e.y = e.y + o, e.Fx = 0, e.Fy = 0;
  }
}
class co extends Me {
  constructor(e, t) {
    super(e, t);
    L(this, "layoutOptions");
    this.layoutOptions = e;
  }
  async refresh() {
    p("SeeksCenterLayouter:refresh"), await this.placeNodes(this.allNodes, this.rootNode);
  }
  async placeNodes(e, t) {
    if (p("SeeksCenterLayouter:placeNodes"), !t) {
      p("root is null:", t);
      return;
    }
    p("layout by root:", t), this.allNodes = e, this.rootNode = t, e.forEach((a) => {
      a.lot.eached = !1, a.lot.notLeafNode = !1, a.lot.childs = [], a.lot.parent = void 0, a.lot.index_of_parent = 0, a.lot.strength = 0, a.lot.placed = !1;
    });
    let o = [], s = {
      max_deep: 1,
      max_length: 1,
      max_strength: 1
    };
    if (x.analysisNodes(o, [this.rootNode], 0, s), o = [], s = {
      max_deep: 1,
      max_length: 1,
      max_strength: 1
    }, x.analysisNodes4Didirectional(o, [this.rootNode], 0, s, 0), t.fixed)
      t.origin_x === void 0 && (t.origin_x = t.x, t.origin_y = t.y), t.lot.x = t.origin_x, t.lot.y = t.origin_y, p("\u56FA\u5B9A\u4F4D\u7F6E\u7684rootNode:", t.text, t.x, t.y);
    else if (this.layoutOptions.fixedRootNode)
      t.lot.x = x.getLotXByNodeX(this.graphOptions, t), t.lot.y = x.getLotYByNodeY(this.graphOptions, t);
    else {
      const a = this.layoutOptions.centerOffset_x || 0, c = this.layoutOptions.centerOffset_y || 0;
      t.lot.x = 0 + a, t.lot.y = 0 + c;
    }
    p("root position:", t.lot.x, t.lot.y), this.placeRelativePosition(this.rootNode, o, s), this.graphOptions.useAnimationWhenExpanded ? (p("Play layout animation....."), await this.animationLayout()) : o.forEach((a) => {
      if (a.fixed === !0 || !x.isAllowShowNode(a))
        return;
      const c = a.offset_x || 0, r = a.offset_y || 0, l = -x.getNodeWidth(a, this.graphOptions) / 2, h = -x.getNodeHeight(a, this.graphOptions) / 2;
      a.x = a.lot.x + c + l, a.y = a.lot.y + r + h, a.lot.placed = !0;
    });
  }
  placeRelativePosition(e, t, o) {
    const s = this.layoutOptions.distance_coefficient === void 0 ? 1 : this.layoutOptions.distance_coefficient;
    let a = Math.round((this.graphOptions.viewSize.height + this.graphOptions.viewSize.width) / o.max_deep * 0.2) * s;
    p("analyticResult:", o, a, this.layoutOptions.distance_coefficient), a < 150 * s && (a = 150 * s);
    let c = 0;
    t.forEach((l) => {
      const h = l.lot.subling;
      if (h && h.level === 1) {
        c = Math.round(h.all_size * 50 / Math.PI / 2), c < a && (c = a);
        const u = ee.getOvalPoint(e.lot.x, e.lot.y, h.level * c, l.lot.strength_plus - l.lot.strength / 2, h.all_strength);
        l.lot.x = u.x, l.lot.y = u.y;
      }
    });
    const r = Math.round(300 * s);
    t.forEach((l) => {
      const h = l.lot.subling;
      if (h && h.level > 1) {
        const u = l.lot.parent.lot.strength_plus - l.lot.parent.lot.strength, v = (l.lot.parent.lot.strength_plus - u) / (l.lot.parent.lot.childs_size + 1) * (l.lot.index_of_parent + 1), y = ee.getOvalPoint(e.lot.x, e.lot.y, (h.level - 1) * r + c, u + v, l.lot.parent.lot.subling.all_strength);
        l.lot.x = y.x, l.lot.y = y.y;
      }
    });
  }
}
class ho extends Me {
  constructor(i, e) {
    super(i, e);
  }
  async refresh() {
    await this.placeNodes(this.allNodes, this.rootNode);
  }
  async placeNodes(i, e) {
    if (e)
      p("layout by root:", e);
    else {
      p("root is null:", e);
      return;
    }
    this.allNodes = i, this.rootNode = e, i.forEach((r) => {
      r.lot.eached = !1, r.lot.notLeafNode = !1, r.lot.childs = [], r.lot.parent = void 0, r.lot.index_of_p_childs = 0, r.lot.strength = 0;
    });
    const t = this.layoutOptions.centerOffset_x || 0, o = this.layoutOptions.centerOffset_y || 0, s = {
      x: t,
      y: o
    }, a = this.allNodes.length;
    let c = a * 90 / Math.PI / 2;
    c < 200 && (c = 200), c > 800 && (c = 800), this.allNodes.forEach((r, l) => {
      const h = ee.getOvalPoint(s.x, s.y, c, l, a);
      r.lot.x = h.x, r.lot.y = h.y;
    }), this.graphOptions.useAnimationWhenExpanded ? (p("Play layout animation....."), await this.animationLayout()) : this.allNodes.forEach((r) => {
      if (r.fixed === !0 || !x.isAllowShowNode(r))
        return;
      const l = r.offset_x || 0, h = r.offset_y || 0, u = -x.getNodeWidth(r, this.graphOptions) / 2, f = -x.getNodeHeight(r, this.graphOptions) / 2;
      r.x = r.lot.x + l + u, r.y = r.lot.y + h + f, r.lot.placed = !0;
    });
  }
}
class fo extends Pe {
  constructor(e, t) {
    super(e, t);
    L(this, "graphOptions");
    L(this, "layoutOptions");
    L(this, "allNodes", []);
    L(this, "__origin_nodes", []);
    this.layoutOptions = e, this.graphOptions = t;
  }
  refresh() {
    this.placeNodes(this.__origin_nodes, this.rootNode);
  }
  placeNodes(e, t) {
    if (t)
      p("layout by root:", t);
    else {
      p("root is null:", t);
      return;
    }
    p("allNodes:", e.length), this.__origin_nodes = e, this.rootNode = t, e.forEach((s) => {
      s.lot.eached = !1, s.lot.notLeafNode = !1, s.lot.childs = [], s.lot.parent = void 0, s.lot.index_of_parent = 0, s.lot.strength = 0, s.lot.placed = !1, s.x || (s.x = 0), s.y || (s.y = 0), Number.isNaN(s.x) && (s.x = 0), Number.isNaN(s.y) && (s.y = 0);
    }), this.allNodes = [];
    const o = {
      max_strength: 1,
      max_deep: 1,
      max_length: 1
    };
    x.analysisNodes4Didirectional(this.allNodes, [this.rootNode], 0, o, 0), p("[layout canvasOffset]", this.graphOptions.viewSize, this.graphOptions.canvasSize);
  }
}
class uo extends Pe {
  constructor(e, t) {
    super(e, t);
    L(this, "layoutOptions");
    L(this, "levelDistanceArr", []);
    this.layoutOptions = e, p("new SeeksBidirectionalTreeLayouter:", this.layoutOptions), this.layoutOptions.from || (this.layoutOptions.from = "left"), this.layoutOptions.levelDistance && (typeof this.layoutOptions.levelDistance == "string" ? this.levelDistanceArr = this.layoutOptions.levelDistance.split(",").map((o) => Number.parseInt(o)) : Array.isArray(this.layoutOptions.levelDistance) && (this.levelDistanceArr = this.layoutOptions.levelDistance)), this.requireLinks = !0;
  }
  async refresh() {
    p("SeeksBidirectionalTreeLayouter:refresh:nodes:", this.allNodes.length), await this.placeNodes(this.allNodes, this.rootNode);
  }
  analysisNodes4Didirectional(e, t, o, s) {
    this.analysisBothWay(e, t, o, s);
    const a = {};
    e.forEach((l) => {
      const h = l.lot.level + "";
      a[h] || (a[h] = []), a[h].push(l), l.lot.subling = {
        level: l.lot.level,
        all_size: 0,
        all_strength: 0
      };
    }), e.forEach((l) => {
      const h = l.lot.level + "", u = a[h], f = u.length;
      l.lot.index_of_level = u.indexOf(l), l.lot.subling.all_size = f, l.lot.subling.all_strength += l.lot.strength || 1, l.lot.strength_plus = l.lot.subling.all_strength;
    }), e.forEach((l) => {
      l.lot.childs_size > 0 && (l.lot.strengthWithChilds = 0);
    }), console.log("willLayoutNodes.length:", e.length), e.forEach((l) => {
      l.lot.childs_size === 0 && (l.lot.strengthWithChilds = 1, x.conductStrengthToParents(l));
    });
    const c = Object.keys(a).map((l) => Number.parseInt(l)).sort(), r = (l) => {
      const h = l + "", u = a[h];
      let f = 0;
      u.forEach((v) => {
        v.lot.parent && f < v.lot.parent.lot.strengthWithChilds_from && (f = v.lot.parent.lot.strengthWithChilds_from), l === 0 ? f += 1 : v.lot.strengthWithChilds_from = f, p("levels:", l, f, v.text, v.lot.strengthWithChilds), f += v.lot.strengthWithChilds;
      });
    };
    [0].forEach(r), c.filter((l) => l > 0).forEach(r), c.filter((l) => l < 0).forEach(r);
  }
  analysisBothWay(e, t, o, s) {
    p(`level ${o} size: ${t.length}`), t.length > s.max_length && (s.max_length = t.length), o > s.max_deep && (s.max_deep = o);
    const a = {
      level: o,
      all_size: t.length,
      all_strength: 0
    };
    t.forEach((r) => {
      r.lot || (r.lot = { childs: [] }), r.lot.eached = !0, r.lot.subling = a, r.lot.level = o, e.push(r);
    });
    let c = 0;
    t.forEach((r) => {
      let l = 0, h = 0, u = [];
      r.targetFrom.forEach((f) => {
        f.lot || (f.lot = { eached: !1, childs: [] }), f.lot.eached || (f.lot.parent = r, x.isAllowShowNode(f) ? (f.lot.eached = !0, f.lot.index_of_parent = h++, r.lot.childs.push(f), u.push(f), l++) : r.lot.childs.push(f));
      }), this.analysisBothWay(e, u, o - 1, s), u = [], r.targetTo.forEach((f) => {
        f.lot || (f.lot = { eached: !1, childs: [] }), f.lot.eached || (f.lot.parent = r, x.isAllowShowNode(f) ? (f.lot.eached = !0, f.lot.index_of_parent = h++, r.lot.childs.push(f), u.push(f), l++) : r.lot.childs.push(f));
      }), this.analysisBothWay(e, u, o + 1, s), r.lot.strength = l > 0 ? l : 1, a.all_strength += r.lot.strength, r.lot.strength_plus = a.all_strength, r.lot.index_of_level = c, r.lot.childs_size = l, c++;
    }), a.all_strength > s.max_strength && (s.max_strength = a.all_strength);
  }
  async placeNodes(e, t) {
    if (p("SeeksBidirectionalTreeLayouter:placeNodes"), t)
      p("layout by root:", t);
    else {
      console.error("root is null");
      return;
    }
    this.rootNode = t, this.allNodes = e, p("allNodes:", e.length), e.forEach((r) => {
      r.lot.eached = !1, r.lot.notLeafNode = !1, r.lot.childs = [], r.lot.parent = void 0, r.lot.index_of_parent = 0, r.lot.strength = 0, r.lot.strengthWithChilds_from = 0, r.lot.strengthWithChilds = 0, r.lot.placed = !1;
    });
    let o = [], s = {
      max_deep: 1,
      max_length: 1,
      max_strength: 1
    };
    x.analysisNodes(o, [this.rootNode], 0, s), o = [], s = {
      max_deep: 1,
      max_length: 1,
      max_strength: 1
    }, this.analysisNodes4Didirectional(o, [this.rootNode], 0, s), this.placeNodesPosition(this.rootNode, o, s), p("allNodes:", o.length), this.graphOptions.useAnimationWhenExpanded ? (p("Play layout animation....."), await this.animationLayout(), p("create rootNode coordinates:3", t.x, t.y)) : (this.allNodes.forEach((r) => {
      if (r.fixed === !0) {
        r.lot.placed = !0;
        return;
      }
      !x.isAllowShowNode(r) || (Number.isNaN(r.lot.x) && (p("bad lot x:", r.text, r.lot.x), r.lot.x = 0), Number.isNaN(r.lot.y) && (p("bad lot y:", r.text, r.lot.y), r.lot.y = 0), r.x = x.getNodeXByLotX(this.graphOptions, r), r.y = x.getNodeYByLotY(this.graphOptions, r), r.lot.placed = !0);
    }), p("create rootNode coordinates:1", t.x, t.y));
    const a = o.filter((r) => r.lot.level === 0), c = new Me({
      layoutName: "force",
      maxLayoutTimes: 100,
      force_node_repulsion: 0.1,
      force_line_elastic: 1,
      fixedRootNode: !0
    }, this.graphOptions);
    c.isMainLayouer = !1, c.requireLinks = !0, this.layoutOptions.from === "left" || this.layoutOptions.from === "right" ? c.lockX = !0 : c.lockY = !0, c.visibleNodes = a, c.setLinks(this.allLinks), c.doForceLayout(0);
  }
  placeNodesPosition(e, t, o) {
    if (e.fixed !== !0) {
      const s = this.layoutOptions.centerOffset_x || 0, a = this.layoutOptions.centerOffset_y || 0;
      e.lot.x = s, e.lot.y = a, this.layoutOptions.fixedRootNode ? (e.lot.x = x.getLotXByNodeX(this.graphOptions, e), e.lot.y = x.getLotYByNodeY(this.graphOptions, e)) : this.layoutOptions.from === "top" ? e.lot.y -= this.graphOptions.viewSize.height / 2 - 100 : this.layoutOptions.from === "bottom" ? e.lot.y += this.graphOptions.viewSize.height / 2 - 200 : this.layoutOptions.from === "right" ? e.lot.x += this.graphOptions.viewSize.width / 2 - 100 : e.lot.x -= this.graphOptions.viewSize.width / 2 - 100, p("debug0910:Graph center:", e.lot.x, e.lot.y, { _center_offset_x: s, _center_offset_y: a });
    } else
      e.origin_x === void 0 && (e.origin_x = e.x, e.origin_y = e.y), e.lot.x = e.origin_x, e.lot.y = e.origin_y, p("\u56FA\u5B9A\u4F4D\u7F6E\u7684rootNode:", e.text, e.x, e.y);
    e.lot.placed = !0, this.placeRelativePosition(e, t, o);
  }
  placeRelativePosition(e, t, o) {
    const s = this.graphOptions.viewSize;
    if (this.layoutOptions.from === "left" || this.layoutOptions.from === "right") {
      const a = Z(this.layoutOptions.min_per_height) || 80, c = Z(this.layoutOptions.max_per_height) || 400, r = Z(this.layoutOptions.min_per_width) || 430, l = Z(this.layoutOptions.max_per_width) || 650;
      let h = Math.round((s.width - 10) / (o.max_deep + 2));
      h < r && (h = r), h > l && (h = l);
      let u = Math.round(s.height / (o.max_strength + 1));
      u < a && (u = a), u > c && (u = c), t.forEach((f) => {
        f.fixed !== !0 && f.lot.placed !== !0 && f !== e && (this.layoutOptions.from === "right" ? f.lot.x = e.lot.x - this.getLevelDistance(f, f.lot.subling.level, h) : f.lot.x = e.lot.x + this.getLevelDistance(f, f.lot.subling.level, h));
      }), t.forEach((f) => {
        f.fixed !== !0 && (f.lot.level === 0 ? f !== e && (f.lot.y = e.lot.y + u * f.lot.index_of_level) : f.lot.y = e.lot.y + u * (o.max_strength / -2 + f.lot.strengthWithChilds_from + f.lot.strengthWithChilds / 2));
      });
    } else {
      const a = Z(this.layoutOptions.min_per_height) || 350, c = Z(this.layoutOptions.max_per_height) || 400, r = Z(this.layoutOptions.min_per_width) || 250, l = Z(this.layoutOptions.max_per_width) || 500;
      let h = Math.round((s.width - 10) / (o.max_strength + 2));
      h < r && (h = r), h > l && (h = l);
      let u = Math.round((s.height - 10) / (o.max_deep + 2));
      u < a && (u = a), u > c && (u = c), t.forEach((f) => {
        f.fixed !== !0 && f.lot.placed !== !0 && f !== e && (this.layoutOptions.from === "bottom" ? f.lot.y = e.lot.y - this.getLevelDistance(f, f.lot.subling.level, u) : f.lot.y = e.lot.y + this.getLevelDistance(f, f.lot.subling.level, u));
      }), t.forEach((f) => {
        f.fixed !== !0 && f.lot.level !== 0 && (f.lot.x = e.lot.x + h * (o.max_strength / -2 + f.lot.strengthWithChilds_from + f.lot.strengthWithChilds / 2));
      });
    }
  }
  getLevelDistance(e, t, o) {
    const s = Math.abs(t);
    if (this.levelDistanceArr && this.levelDistanceArr.length > 0) {
      let a = 0;
      for (let c = 0; c < s; c++) {
        const r = this.levelDistanceArr[c] || 100;
        a += r;
      }
      return t > 0 ? a : a * -1;
    } else
      return t * o;
  }
}
const vt = (n, i) => {
  _t(n);
  let e = null;
  if (n.layoutName === "tree" ? e = new lo(n, i) : n.layoutName === "center" ? e = new co(n, i) : n.layoutName === "circle" ? e = new ho(n, i) : n.layoutName === "force" ? e = new Me(n, i) : n.layoutName === "fixed" ? e = new fo(n, i) : n.layoutName === "smart-tree" && (e = new uo(n, i)), !e)
    throw new Error("unknown layout: " + n.layoutName);
  return i.isNeedShowAutoLayoutButton = n.allowAutoLayoutIfSupport !== !1 && e.autoLayout !== void 0, e;
}, _t = (n) => {
  if (typeof n.centerOffset_x == "string" && (n.centerOffset_x = parseInt(n.centerOffset_x)), typeof n.centerOffset_y == "string" && (n.centerOffset_y = parseInt(n.centerOffset_y)), n.layoutName === "center") {
    const i = n;
    i.layoutDirection === void 0 && (i.layoutDirection = "h"), i.centerOffset_x === void 0 && (i.centerOffset_x = 0), i.centerOffset_y === void 0 && (i.centerOffset_y = 0), i.layoutDirection = void 0;
  } else if (n.layoutName.includes("tree")) {
    const i = n;
    i.layoutDirection === void 0 && (i.layoutDirection = "h"), i.centerOffset_x === void 0 && (i.centerOffset_x = 0), i.centerOffset_y === void 0 && (i.centerOffset_y = 0), i.from === void 0 && (i.from = "top"), i.levelDistance === void 0 && (i.levelDistance = ""), (i.from === "top" || i.from === "bottom") && (i.layoutDirection = "v", p("set layoutDirection=v"), p("set defaultJunctionPoint=tb"), i.min_per_width === void 0 && (i.min_per_width = 100), i.max_per_width === void 0 && (i.max_per_width = 500), i.min_per_height === void 0 && (i.min_per_height = 300), i.max_per_height === void 0 && (i.max_per_height = 500)), (i.from === "left" || i.from === "right") && (i.layoutDirection = "h", p("set defaultJunctionPoint=lr"), i.min_per_width === void 0 && (i.min_per_width = 300), i.max_per_width === void 0 && (i.max_per_width = 500), i.min_per_height === void 0 && (i.min_per_height = 100), i.max_per_height === void 0 && (i.max_per_height = 500));
  } else
    (n.layoutName === "fixed" || n.layoutName === "force") && (n.layoutDirection = void 0);
}, xt = {
  id: "rg-newNodeTemplate",
  x: 0,
  y: 0,
  text: "",
  styleClass: ""
};
let po = 0;
const mo = (n) => {
  !n.backgroundImage && (n.backgroundImage = n.backgrounImage), !n.backgroundImageNoRepeat && (n.backgroundImageNoRepeat = n.backgrounImageNoRepeat), typeof n.graphOffset_x == "string" && (n.graphOffset_x = parseInt(n.graphOffset_x)), typeof n.graphOffset_y == "string" && (n.graphOffset_y = parseInt(n.graphOffset_y));
  const i = {
    instanceId: "",
    debug: !0,
    graphLoading: !1,
    graphLoadingText: "",
    showMaskWhenLayouting: !1,
    instanceDestroyed: !1,
    useHorizontalView: !1,
    oldVueVersion: !1,
    ovUseNodeSlot: !1,
    ovUseLineSlot: !1,
    ovUseToolbarSlot: !1,
    ovUseNodeExpandHolderSlot: !1,
    showDebugPanel: !1,
    backgroundColor: void 0,
    backgroundImage: void 0,
    backgroundImageNoRepeat: void 0,
    downloadImageFileName: "",
    disableZoom: !1,
    disableDragNode: !1,
    disableDragLine: !0,
    moveToCenterWhenRefresh: !0,
    zoomToFitWhenRefresh: !0,
    useAnimationWhenRefresh: !1,
    defaultFocusRootNode: !0,
    disableNodeClickEffect: !1,
    disableLineClickEffect: !1,
    allowShowFullscreenMenu: !0,
    allowShowZoomMenu: !0,
    allowAutoLayoutIfSupport: !0,
    allowShowRefreshButton: !0,
    allowShowDownloadButton: !0,
    backgrounImageNoRepeat: !1,
    allowShowMiniToolBar: !0,
    toolBarVersion: "v2",
    toolBarDirection: "v",
    toolBarPositionH: "right",
    toolBarPositionV: "center",
    allowSwitchLineShape: !1,
    allowSwitchJunctionPoint: !1,
    isMoveByParentNode: !1,
    defaultExpandHolderPosition: "hide",
    defaultExpandHolderColor: void 0,
    defaultNodeBorderWidth: void 0,
    defaultNodeColor: "#409EFF",
    defaultNodeBorderColor: "#0c7ff6",
    defaultNodeFontColor: "#ffffff",
    defaultLineColor: "#cccccc",
    checkedLineColor: "#FD8B37",
    defaultLineFontColor: void 0,
    defaultLineWidth: 1,
    defaultLineShape: void 0,
    defaultLineTextOffset_x: void 0,
    defaultLineTextOffset_y: void 0,
    defaultNodeShape: void 0,
    defaultNodeWidth: void 0,
    defaultNodeHeight: void 0,
    defaultShowLineLabel: !0,
    hideNodeContentByZoom: !1,
    defaultJunctionPoint: void 0,
    defaultPloyLineRadius: void 0,
    disableDragCanvas: !1,
    placeSingleNode: !0,
    placeOtherGroup: !1,
    lineUseTextPath: !1,
    graphOffset_x: 0,
    graphOffset_y: 0,
    viewSize: { width: 300, height: 300 },
    viewELSize: { width: 1300, height: 800, left: 0, top: 100 },
    viewNVInfo: { width: 1300, height: 800, x: 0, y: 100 },
    canvasNVInfo: { width: 1300, height: 800, x: 0, y: 100 },
    defaultLineMarker: {
      markerWidth: 12,
      markerHeight: 12,
      refX: 10,
      refY: 6,
      color: void 0,
      data: "M2,2 L10,6 L2,10 L6,6 L2,2"
    },
    allowShowMiniView: !1,
    allowShowSettingPanel: !1,
    allowShowMiniNameFilter: !0,
    fullscreen: !1,
    checkedNodeId: "",
    checkedLineId: "",
    checkedLinkId: "",
    layouts: [],
    layoutLabel: "",
    layoutName: "tree",
    layoutClassName: "",
    layoutDirection: "h",
    useAnimationWhenExpanded: !1,
    reLayoutWhenExpandedOrCollapsed: !1,
    autoLayouting: !1,
    layouter: void 0,
    isNeedShowAutoLayoutButton: !1,
    canvasZoom: 100,
    showSingleNode: !0,
    showNodeLabel: !0,
    showNodeShortLabel: !0,
    canvasSize: {
      width: 2e3,
      height: 2e3
    },
    canvasOffset: {
      x: 25,
      y: 27,
      zoom_buff_x: 0,
      zoom_buff_y: 0
    },
    creatingSelection: !1,
    selectionView: {
      x: 25,
      y: 27,
      width: 0,
      height: 0
    },
    creatingNodePlot: !1,
    showTemplateNode: !0,
    newNodeTemplate: Ze(JSON.parse(JSON.stringify(xt))),
    creatingLinePlot: !1,
    newLineTemplate: {
      from: "newRelationTemplate-from",
      to: "newRelationTemplate-to",
      color: "",
      text: "new line"
    },
    newLinkTemplate: {
      fromNode: null,
      toNodeObject: null,
      toNode: {
        nothing: !0,
        x: 400,
        y: 400,
        el: {
          offsetWidth: 30,
          offsetHeight: 30
        }
      },
      relations: [{}]
    },
    data: {}
  };
  if (i.newLineTemplate = Ue(i.newLineTemplate), n.layout && n.layouts)
    throw new Error("Graph options cannot have both layout and layouts properties !");
  const e = n.debug === !0;
  e && p("RGOptions:user instance options:", n), window && (window.relationGraphDebug = e);
  const t = Object.keys(i);
  n && Object.keys(n).forEach((s) => {
    if (s === "layouts" || s === "layout")
      return;
    const a = n[s];
    if (!t.includes(s)) {
      p("RGOptions: unknow option key:", s);
      return;
    }
    if (typeof a == "object") {
      p("RGOptions:user setting object:", s, a);
      const c = i[s];
      if (c && !Array.isArray(c) && a)
        Object.keys(c).forEach((r) => {
          c[r] = a[r];
        });
      else if (Array.isArray(c)) {
        const r = [];
        a.forEach((l) => {
          l && typeof l == "object" ? r.push(JSON.parse(JSON.stringify(l))) : r.push(l);
        }), i[s] = r;
      } else
        i[s] = a;
    } else
      i[s] = a;
  });
  let o = [];
  return !n.layouts || !Array.isArray(n.layouts) || n.layouts.length === 0 ? n.layout ? o = [n.layout] : o = [{
    label: "\u4E2D\u5FC3",
    layoutName: "center",
    layoutDirection: "v"
  }] : o = n.layouts, p("final layouts:", o), i.layouts = o.map((s) => JSON.parse(JSON.stringify(s))), i.disableNodeClickEffect && (i.defaultFocusRootNode = !1), _t(i.layouts[0]), wt(i.layouts[0], i), i;
}, wt = (n, i) => {
  p("applyDefaultOptionsByLayout", n.layoutName, i), n.layoutName === "SeeksCenterLayouter" || n.layoutName === "center" ? (i.defaultNodeShape === void 0 && (i.defaultNodeShape = 0), i.defaultLineShape === void 0 && (i.defaultLineShape = 1), i.defaultJunctionPoint === void 0 && (i.defaultJunctionPoint = "border")) : n.layoutName === "SeeksBidirectionalTreeLayouter" || n.layoutName.includes("tree") ? (i.defaultNodeBorderWidth === void 0 && (i.defaultNodeBorderWidth = 0), i.defaultNodeShape === void 0 && (i.defaultNodeShape = 1), i.defaultLineShape === void 0 && (i.defaultLineShape = 4), (n.from === "top" || n.from === "bottom") && (i.layoutDirection = "v", p("set layoutDirection=v"), i.defaultLineShape === 4 && (i.defaultJunctionPoint === void 0 && (i.defaultJunctionPoint = "tb"), p("set defaultJunctionPoint=tb"))), (n.from === "left" || n.from === "right") && (i.layoutDirection = "h", p("set layoutDirection=h"), i.defaultLineShape === 4 && (i.defaultJunctionPoint === void 0 && (i.defaultJunctionPoint = "lr"), p("set defaultJunctionPoint=lr")))) : (n.layoutName === "fixed" || n.layoutName === "force") && (i.moveToCenterWhenRefresh = !1, i.zoomToFitWhenRefresh = !1), i.defaultNodeShape === void 0 && (i.defaultNodeShape = 0), i.defaultLineShape === void 0 && (i.defaultLineShape = 1), i.defaultJunctionPoint === void 0 && (i.defaultJunctionPoint = "border");
}, Ct = (n) => {
  const i = mo(n);
  return p("RGOptions:new RGOptions:by:", n), p("RGOptions:new RGOptions:", i), i.instanceId || (i.instanceId = `RGIns-${po++}`), i;
};
class yo {
  constructor(i, e) {
    L(this, "options");
    L(this, "listeners");
    L(this, "isReact", !1);
    L(this, "updateViewHook", () => {
    });
    this.listeners = e, this.options = Ct(i), p("new RelationGraph:", this);
  }
  enableDebugLog(i) {
    this.options.debug = i, window && (window.relationGraphDebug = i);
  }
  setUpdateViewHook(i) {
    this.isReact = !0, this.updateViewHook = i;
  }
  _dataUpdated() {
    this.updateViewHook();
  }
}
class go extends yo {
  constructor(e, t) {
    super(e, t);
    L(this, "$dom");
    L(this, "$canvasDom");
  }
  setDom(e) {
    this.$dom = e;
  }
  setCanvasDom(e) {
    this.$canvasDom = e;
  }
  getBoundingClientRect() {
    return this.$dom.getBoundingClientRect();
  }
}
class vo extends go {
  constructor(e, t) {
    super(e, t);
    L(this, "graphData", {
      rootNode: void 0,
      nodes: [],
      links: [],
      elementLines: []
    });
    L(this, "seeksNodeIdIndex", 0);
    L(this, "allLineColors", []);
    L(this, "userLayouerClass");
    L(this, "layouter");
    L(this, "reactiveData");
    L(this, "disableNextLayoutAnimation", !1);
    L(this, "elLineUpdating", !1);
  }
  setReactiveData(e, t) {
    this.graphData = e, this.allLineColors = t.allLineColors, t.options = this.options, this.reactiveData = t;
  }
  setReactiveDataVue3(e, t) {
    this.graphData = e, this.allLineColors = t.allLineColors, t.options = this.options, this.reactiveData = t;
  }
  _setOptions(e) {
    const t = Ct(e);
    this.reactiveData.options = t, this.options = this.reactiveData.options;
  }
  _initLayoutByLayoutOptions(e) {
    this.options.layoutClassName = e.layoutClassName, this.options.layoutLabel = e.label, this.options.layoutName = e.layoutName, this.options.layoutDirection = e.layoutDirection, this.layouter = vt(e, this.options);
  }
  initLayouter() {
    if (this.userLayouerClass)
      p("Use user layouter:", this.userLayouerClass), this.layouter = this.userLayouerClass;
    else if (this.options.layouts && this.options.layouts.length > 0) {
      const e = this.options.layouts[0];
      p("[change layout]Create default layouter\uFF1A", this.options.layoutName), this._initLayoutByLayoutOptions(e);
    } else
      p("Not set option: layout/layouts\uFF01");
    p("Layouter instance:", this.layouter);
  }
  async _setJsonData(e, t = !1) {
    await this.clearGraph(), p("set jsonData:", e), this.loadGraphJsonData(e);
  }
  async clearGraph() {
    this.graphData.nodes = [], this.graphData.links = [], this.graphData.elementLines = [], this.graphData.rootNode = void 0;
  }
  async clearElementLines() {
    this.graphData.elementLines = [];
  }
  generateNewNodeId(e = 1) {
    const t = "N" + (this.graphData.nodes.length + e);
    return this.getNodeById(t) ? this.generateNewNodeId(e + 1) : (p("generateNewNodeId:", e, t), t);
  }
  loadNodes(e) {
    e.forEach((t) => {
      let o = this.graphData.nodes.find((s) => s.id === t.id);
      o || (o = Ze(t), o && (o.seeks_id = this.seeksNodeIdIndex++, this.graphData.nodes.push(o)));
    });
  }
  loadLines(e) {
    e.forEach((t) => {
      let o = !1, s, a;
      if (typeof t.from == "object" ? s = t.from : s = this.graphData.nodes.find((y) => y.id === t.from), typeof t.to == "object" ? a = t.to : a = this.graphData.nodes.find((y) => y.id === t.to), !s) {
        console.error("Can not found from node:", t);
        return;
      }
      if (!a) {
        console.error("Can not found to node:", t);
        return;
      }
      const c = `${s.seeks_id}-${a.seeks_id}`, r = `${a.seeks_id}-${s.seeks_id}`, l = Ue(t);
      let h = this.graphData.links.find((y) => y.seeks_id === c), u = !1;
      h || (h = this.graphData.links.find((y) => y.seeks_id === r), h ? u = !0 : (o = !0, h = {
        seeks_id: c,
        fromNode: s,
        toNode: a,
        appended: !1,
        forDisplayOnly: !0,
        relations: []
      }));
      let f = l.arrow;
      l.isHideArrow || (f = this.getLineArrow(l.color)), s.targetNodes || (s.targetNodes = []), a.targetNodes || (a.targetNodes = []), l.forDisplayOnly ? h.forDisplayOnly = !1 : (s.targetNodes.includes(a) || s.targetNodes.push(a), a.targetNodes.includes(s) || a.targetNodes.push(s), s.targetTo.includes(a) || s.targetTo.push(a), a.targetFrom.includes(s) || a.targetFrom.push(s));
      let v = !1;
      for (let y = 0; y < h.relations.length; y++)
        if ((h.relations[y].id || l.id) && h.relations[y].id === l.id) {
          v = !0;
          break;
        }
      v === !1 && (l.id || (l.id = `${h.seeks_id}-${h.relations.length}`), l.isReverse = u, l.arrow = f, h.relations.push(l)), o && (this.graphData.links.push(h), h.appended = !1);
    });
  }
  flatNodeData(e, t, o, s) {
    e.forEach((a) => {
      o.push(a), t && s.push({
        from: t.id,
        to: a.id
      });
      const c = a.childs || a.children;
      c && c.length > 0 && this.flatNodeData(c, a, o, s);
    });
  }
  loadGraphJsonData(e) {
    e.lines || (e.lines = e.relations, console.warn("[relation-graph] For compatibility with older versionsm, Use jsonData.relations as jsonData.lines, It is recommended that you define your data using")), e.lines || (e.lines = e.links, console.warn("[relation-graph] For compatibility with older versionsm, Use jsonData.links as jsonData.lines, It is recommended that you define your data using"));
    const t = e.nodes, o = [], s = [];
    this.flatNodeData(t, null, o, s), e.lines.forEach((a) => {
      s.push(a);
    }), this.loadNodes(o), p("Nodes is initialized"), this.loadLines(s), this._dataUpdated(), setTimeout(() => {
      e.elementLines && this.addElementLines(e.elementLines);
    }, 500);
  }
  getLineArrow(e, t = !1, o = !1) {
    const s = t ? "start-" : "";
    if (o)
      return `${this.options.instanceId}-${s}arrow-checked`;
    if (e) {
      const a = to(e);
      return this.allLineColors.map((c) => c.id).includes(a) || this.allLineColors.push({ id: a, color: e }), `${this.options.instanceId}-${s}arrow-${a}`;
    } else
      return `${this.options.instanceId}-${s}arrow-default`;
  }
  getNodes() {
    return this.graphData.nodes;
  }
  getLinks() {
    return this.graphData.links;
  }
  getGraphJsonData() {
    const e = [], t = [];
    return this.graphData.nodes.forEach((o) => {
      const s = so(o);
      s && e.push(s);
    }), this.graphData.links.forEach((o) => {
      ro(o, t);
    }), {
      rootId: this.graphData.rootNode ? this.graphData.rootNode.id : "",
      nodes: e,
      lines: t
    };
  }
  getGraphJsonOptions() {
    const e = {}, t = [
      "layouter",
      "autoLayouting",
      "canvasNVInfo",
      "canvasOffset",
      "canvasZoom",
      "fullscreen",
      "instanceId",
      "layoutClassName",
      "layoutDirection",
      "layoutLabel",
      "layoutName",
      "resetViewSize",
      "viewELSize",
      "viewNVInfo",
      "viewSize",
      "canvasSize",
      "newLinkTemplate",
      "newLineTemplate",
      "newNodeTemplate"
    ];
    return Object.keys(this.options).forEach((o) => {
      t.includes(o) || (e[o] = this.options[o]);
    }), e;
  }
  printGraphJsonData() {
    p("graph options:", JSON.stringify(this.getGraphJsonOptions())), p("graph json data:", JSON.stringify(this.getGraphJsonData()));
  }
  getNodeById(e) {
    for (let t = 0; t < this.graphData.nodes.length; t++)
      if (this.graphData.nodes[t].id === e)
        return this.graphData.nodes[t];
  }
  getLinkById(e) {
    for (let t = 0; t < this.graphData.links.length; t++)
      if (this.graphData.links[t].seeks_id === e)
        return this.graphData.links[t];
  }
  getLinkByLineId(e) {
    for (let t = 0; t < this.graphData.links.length; t++)
      if (this.graphData.links[t].relations.findIndex((o) => o.id === e) !== -1)
        return this.graphData.links[t];
  }
  addNodes(e) {
    p("addNodes:", e), this.loadNodes(e);
  }
  addLines(e) {
    p("addLines:", e), this.loadLines(e);
  }
  addElementLines(e) {
    p("addElementLines:", e), e.forEach((t) => {
      const o = document.getElementById(t.from), s = document.getElementById(t.to);
      if (!o) {
        console.error("Can not found from HTMLElement: #" + t.from);
        return;
      }
      if (!s) {
        console.error("Can not found toHTMLElement: #" + t.to);
        return;
      }
      const a = Ue(t);
      let c = a.arrow;
      a.isHideArrow || (c = this.getLineArrow(a.color)), a.forDisplayOnly = !0;
      let r = !1;
      for (const l of this.graphData.elementLines)
        if (l.relations[0].from === a.from && l.relations[0].to === a.to || l.relations[0].from === a.to && l.relations[0].to === a.from) {
          r = !0;
          break;
        }
      if (!r) {
        a.id || (a.id = `rg-ell-${a.from}-${a.to}`), a.arrow = c;
        const l = {
          type: "el",
          nodeShape: 1,
          junctionPoint: "lr",
          x: 0,
          y: 0,
          el: {
            offsetWidth: 10,
            offsetHeight: 10
          }
        }, h = {
          type: "el",
          nodeShape: 1,
          junctionPoint: "lr",
          x: 0,
          y: 0,
          el: {
            offsetWidth: 10,
            offsetHeight: 10
          }
        }, u = {
          seeks_id: "ell-" + this.graphData.elementLines.length,
          fromNode: l,
          toNode: h,
          relations: [a],
          appended: !0,
          forDisplayOnly: !0
        };
        this._updateElementLinePosition(o, u.fromNode), this._updateElementLinePosition(s, u.toNode), this.graphData.elementLines.push(u);
      }
    }), this.updateElementLines(), this._dataUpdated();
  }
  getElementLineById(e) {
    for (const t of this.graphData.elementLines)
      if (t.seeks_id === e)
        return t;
  }
  getElementLines() {
    return this.graphData.elementLines.map((e) => e.relations[0]);
  }
  removeElementLine(e) {
    p("removeElementLine:", e), this.removeELementLineById(e.relations[0].id);
  }
  removeELementLineById(e) {
    p("removeELementLineById:", e);
    for (let t = 0; t < this.graphData.elementLines.length; t++)
      this.graphData.elementLines[t].relations[0].id === e && (this.graphData.elementLines.splice(t, 1), t--);
  }
  updateElementLines() {
    p("updateElementLines:", this.graphData.elementLines.length), !this.elLineUpdating && (this.elLineUpdating = !0, setTimeout(() => {
      this.elLineUpdating = !1, this._updateElementLines();
    }, 50));
  }
  _updateElementLines() {
    this.graphData.elementLines.forEach((e) => {
      const t = document.getElementById(e.relations[0].from), o = document.getElementById(e.relations[0].to);
      if (!t) {
        e.relations[0].isHide = !0;
        return;
      }
      if (!o) {
        e.relations[0].isHide = !0;
        return;
      }
      if (this._updateElementLinePosition(t, e.fromNode), this._updateElementLinePosition(o, e.toNode), e.fromNode.el.offsetWidth === 0 && e.fromNode.el.offsetHeight === 0) {
        e.relations[0].isHide = !0;
        return;
      }
      if (e.toNode.el.offsetWidth === 0 && e.toNode.el.offsetHeight === 0) {
        e.relations[0].isHide = !0;
        return;
      }
      e.relations[0].isHide = !1;
    }), this._dataUpdated();
  }
  _updateElementLinePosition(e, t) {
    const o = e.getBoundingClientRect(), s = this.$canvasDom.getBoundingClientRect();
    t.x = (o.x - s.x) / (this.options.canvasZoom / 100), t.y = (o.y - s.y) / (this.options.canvasZoom / 100), t.el.offsetWidth = o.width / (this.options.canvasZoom / 100), t.el.offsetHeight = o.height / (this.options.canvasZoom / 100);
  }
  removeNodeById(e) {
    let t = 0;
    for (let s = 0; s < this.graphData.links.length; s++) {
      const a = this.graphData.links[s];
      (a.fromNode.id === e || a.toNode.id === e) && (this.removeLink(a), s--, t++);
    }
    p("Removed link\uFF1A", e, t);
    let o = 0;
    for (let s = 0; s < this.graphData.nodes.length; s++)
      if (this.graphData.nodes[s].id === e) {
        this.graphData.nodes.splice(s, 1), o++;
        break;
      }
    p("Removed node\uFF1A", e, o);
  }
  removeNode(e) {
    this.removeNodeById(e.id);
  }
  removeLinkByTwoNode(e, t) {
    for (const o of this.getLinks())
      if (o.fromNode.id === e && o.toNode.id === t || o.fromNode.id === e && o.toNode.id === t) {
        this.removeLink(o);
        break;
      }
  }
  getGroupByNode(e, t = []) {
    t.includes(e) || t.push(e);
    for (const o of e.targetNodes)
      t.includes(o) || this.getGroupByNode(o, t);
    return t;
  }
  _clearItem(e, t) {
    for (let o = 0; o < e.length; o++)
      e[o] === t && (e.splice(o, 1), o--);
  }
  removeNodeRef(e, t) {
    e && (e.targetNodes && this._clearItem(e.targetNodes, t), e.targetFrom && this._clearItem(e.targetFrom, t), e.targetTo && this._clearItem(e.targetTo, t));
  }
  removeLinkById(e) {
    p("removeLinkById:", e);
    for (let t = 0; t < this.graphData.links.length; t++) {
      const o = this.graphData.links[t];
      o.seeks_id === e && (this.removeNodeRef(o.fromNode, o.toNode), this.removeNodeRef(o.toNode, o.fromNode), this.graphData.links.splice(t, 1), t--);
    }
  }
  removeLink(e) {
    p("removeLink:", e), this.removeLinkById(e.seeks_id);
  }
  removeLine(e, t) {
    p("removeLine:", e, t);
    for (let o = 0; o < e.relations.length; o++)
      e.relations[o] === t && e.relations.splice(o, 1);
    e.relations.length === 0 && this.removeLink(e);
  }
  setNodePosition(e, t, o) {
    e.x = t, e.y = o;
  }
  getGraphOffet() {
    const e = this.options.graphOffset_x || 0, t = this.options.graphOffset_y || 0;
    return {
      offset_x: e,
      offset_y: t
    };
  }
  setCanvasCenter(e, t) {
    const o = this.options.viewSize.width / 2, s = this.options.viewSize.height / 2, a = this.getGraphOffet();
    this.setCanvasOffset(o - e + a.offset_x, s - t + a.offset_y);
  }
  setCanvasOffset(e, t) {
    this.options.canvasOffset.x = e, this.options.canvasOffset.y = t;
  }
  findGroupNodes(e, t) {
    t.push(e), e.targetNodes.forEach((o) => {
      t.includes(o) || this.findGroupNodes(o, t);
    });
  }
  resetViewSize() {
    !this.options || (p("resetViewSize"), this.options.viewSize.width = this.$dom.getBoundingClientRect().width, this.options.viewSize.height = this.$dom.getBoundingClientRect().height, this.options.canvasZoom = 100, this.setCanvasCenter(0, 0), this.refreshNVAnalysisInfo());
  }
  refreshNVAnalysisInfo() {
    if (!this.$dom) {
      console.error("cannot get view size !");
      return;
    }
    const e = {
      NMCanvasCenter: { x: 0, y: 0 }
    }, t = this.$dom.getBoundingClientRect();
    this.options.viewNVInfo.x = t.left, this.options.viewNVInfo.y = t.top, this.options.viewNVInfo.width = t.width, this.options.viewNVInfo.height = t.height;
    const o = this.options.canvasSize.width * (this.options.canvasZoom / 100), s = this.options.canvasSize.height * (this.options.canvasZoom / 100);
    e.NMCanvasCenter.x = this.options.canvasOffset.x + this.options.canvasSize.width / 2, e.NMCanvasCenter.y = this.options.canvasOffset.y + this.options.canvasSize.height / 2, this.options.canvasNVInfo.x = e.NMCanvasCenter.x - o / 2, this.options.canvasNVInfo.y = e.NMCanvasCenter.y - s / 2, this.options.canvasNVInfo.width = o, this.options.canvasNVInfo.height = s, this.options.viewELSize.width = t.width, this.options.viewELSize.height = t.height, this.options.viewELSize.left = t.left, this.options.viewELSize.top = t.top;
  }
  getStuffSize(e) {
    const t = e || this.graphData.nodes;
    let o = 9999999, s = 9999999, a = 0, c = 0;
    t.forEach((u) => {
      x.isAllowShowNode(u) && (u.x < o && (o = u.x), u.x > a && (a = u.x + u.el.offsetWidth), u.y < s && (s = u.y), u.y > c && (c = u.y + u.el.offsetHeight));
    });
    const r = 100, l = a - o + r, h = c - s + r;
    return {
      width: l,
      height: h,
      minX: o,
      maxX: a,
      minY: s,
      maxY: c
    };
  }
  getNodesCenter() {
    const e = this.getStuffSize();
    p("getStuffSize:", e);
    const t = e.minX + (e.width - 100) / 2, o = e.minY + (e.height - 100) / 2;
    return {
      x: t,
      y: o
    };
  }
  querySearchAsync(e) {
    if (p("fetch-suggestions", e), e = e.trim(), e === "")
      return;
    const t = [];
    return this.graphData.nodes.forEach((o) => {
      p("fetch:", o.text), o.text.includes(e) && t.push(o);
    }), p("fetched:", t.length), t;
  }
  printOptions() {
    const e = this.getGraphJsonOptions();
    console.log("options:", e), console.log("options-json-string:"), console.log(JSON.stringify(e));
  }
  printData() {
    const e = this.getGraphJsonData();
    console.log("data:", e), console.log("data-json-string:"), console.log(JSON.stringify(e));
  }
  loading(e = "") {
    this.options.graphLoading = !0, this.options.graphLoadingText = e;
  }
  clearLoading() {
    this.options.graphLoading = !1, this.options.graphLoadingText = "";
  }
}
class _o extends vo {
  constructor(i, e) {
    super(i, e);
  }
  dataURLToBlob(i) {
    const e = i.split(","), t = e[0], o = t && t.match(/:(.*?);/)[1], s = atob(e[1]);
    let a = s.length;
    const c = new Uint8Array(a);
    for (; a--; )
      c[a] = s.charCodeAt(a);
    return new Blob([c], { type: o });
  }
  async createGraphCanvas(i = "png") {
    return new Promise((e, t) => {
      const o = this.options.canvasZoom, s = this.$canvasDom.clientWidth, a = this.$canvasDom.clientHeight, c = this.options.canvasOffset.x, r = this.options.canvasOffset.y;
      this.options.checkedNodeId = "", this.options.canvasZoom = 100;
      const l = this.$canvasDom;
      let h = 999999, u = 999999, f = 0, v = 0;
      const y = 200;
      this.loading("Generating..."), this.graphData.nodes.forEach((w) => {
        w.x < h && (h = w.x), w.x > f && (f = w.x + w.el.offsetWidth), w.y < u && (u = w.y), w.y > v && (v = w.y + w.el.offsetHeight);
      });
      const C = h - y, b = u - y;
      this.graphData.nodes.forEach((w) => {
        w.x = w.x - C, w.y = w.y - b;
      }), this.$canvasDom.querySelectorAll(".rel-canvas-slot").forEach((w) => {
        const O = w;
        O.style.left = -b + "px", O.style.top = -b + "px";
      }), this.updateElementLines(), this.$canvasDom.querySelectorAll(".rel-lines-svg-el-lines").forEach((w) => {
        const O = w;
        O.style.width = "4000px", O.style.height = "4000px";
      }), this.options.canvasOffset.x = y * -1, this.options.canvasOffset.y = y * -1;
      const S = f - h + 200 + y * 2, k = v - u + 100 + y * 2, D = window.devicePixelRatio;
      this.options.canvasSize.width = S * D, this.options.canvasSize.height = k * D, window.scrollTo(0, 0);
      const I = document.createElement("canvas");
      I.width = S * D, I.height = k * D, I.style.backgroundColor = getComputedStyle(l.parentElement, null).backgroundColor, p("canvas.style.backgroundColor:", I.style.backgroundColor), I.style.width = `${S * D}px`, I.style.height = `${k * D}px`, I.getContext("2d").scale(1, 1);
      const J = {
        backgroundColor: I.style.backgroundColor,
        scale: D,
        canvas: I,
        logging: !0,
        width: S,
        height: k,
        useCORS: !0
      };
      setTimeout(() => {
        this.createImage(l, J, i, "", (w) => {
          this.options.canvasSize.width = s, this.options.canvasSize.height = a, this.options.canvasOffset.x = c, this.options.canvasOffset.y = r, this.options.canvasZoom = o, this.$canvasDom.querySelectorAll(".rel-canvas-slot").forEach((j) => {
            const R = j;
            R.style.left = "0px", R.style.top = "0px";
          }), this.graphData.nodes.forEach((j) => {
            j.x = j.x + C, j.y = j.y + b;
          }), this.$canvasDom.querySelectorAll(".rel-lines-svg-el-lines").forEach((j) => {
            const R = j;
            R.style.width = "1px", R.style.height = "1px";
          }), this.updateElementLines(), this.clearLoading(), e(w);
        });
      }, 1e3);
    });
  }
  createImage(i, e, t, o, s) {
    p("createImage:", e), Zt(i, e).then((a) => {
      s && s(a);
    });
  }
  async getImageBase64(i = "png") {
    const e = await this.createGraphCanvas(i), t = document.body.appendChild(e);
    t.style.display = "none";
    const o = t.toDataURL(`image/${i}`);
    return document.body.removeChild(t), o;
  }
  async downloadAsImage(i = "png", e) {
    if (this.listeners.onImageDownload && this.listeners.onImageDownload(this.$canvasDom, i) === !1)
      return;
    if (this.graphData.nodes.length === 0)
      throw new Error("No nodes, no content to export!");
    e || (e = this.options.downloadImageFileName), e || (e = `relation-graph-${(Math.random() * 1e5).toFixed(0)}`);
    const t = await this.createGraphCanvas(i);
    p("downloadImageAsFile:", i, e);
    let o = !0;
    this.listeners.onImageSaveAsFile && this.listeners.onImageSaveAsFile(
      t,
      i,
      e
    ) === !1 && (o = !1), o && await this.downloadImageAsFile(t, i, e);
  }
  async downloadImageAsFile(i, e, t) {
    const o = document.body.appendChild(i);
    o.style.display = "none";
    const s = this.dataURLToBlob(o.toDataURL(`image/${e}`));
    document.body.removeChild(o);
    const a = document.createElement("a");
    a.style.display = "none";
    try {
      window.navigator.msSaveOrOpenBlob ? window.navigator.msSaveOrOpenBlob(s, `${t}.${e}`) : (a.setAttribute("href", URL.createObjectURL(s)), a.setAttribute("download", `${t}.${e}`), document.body.appendChild(a), a.click(), p("click ok!"), URL.revokeObjectURL(await s.text()), p("revokeObjectURL ok!"), document.body.removeChild(a), p("removeChild ok!"));
    } catch (c) {
      p("[SEEKS Graph]Create and download image error:", c);
    }
  }
}
class xo extends _o {
  constructor(i, e) {
    super(i, e);
  }
  createReturnValue(i, e) {
    return { path: i, textPosition: e };
  }
  createLinePath(i, e, t) {
    let o = i.fromNode;
    o || (o = {
      x: 0,
      y: 0,
      el: {
        offsetWidth: 10,
        offsetHeight: 10
      }
    });
    const s = i.toNode, a = i.relations.length;
    return t || (t = 0), this.createLinePathByTwoNode(o, s, e, t, a);
  }
  _getJunctionPoint(i, e) {
    return i === he.border ? ee.getBorderPoint4MultiLine(...e) : i === he.ltrb ? ee.getRectJoinPoint(...e) : i === he.tb ? ee.getRectVJoinPoint(...e) : i === he.lr ? ee.getRectHJoinPoint(...e) : i === he.left ? ee.getRectLeftJoinPoint(...e) : i === he.right ? ee.getRectRightJoinPoint(...e) : i === he.top ? ee.getRectTopJoinPoint(...e) : i === he.bottom ? ee.getRectBottomJoinPoint(...e) : ee.getBorderPoint4MultiLine(...e);
  }
  createLinePathByTwoNode(i, e, t, o = 0, s = 1) {
    const a = t.lineShape || this.options.defaultLineShape || 1, c = t.lineDirection || this.options.layoutDirection || "h";
    let r = i.x, l = i.y, h = e.x, u = e.y;
    const f = { x: 0, y: 0, rotate: 0 };
    if (Number.isNaN(r) || Number.isNaN(l))
      return p("error start node:", i.text, i.x, i.y), f.x = 50, f.y = 50, f.rotate = 0, this.createReturnValue("M 0 0 L 100 100", f);
    if (Number.isNaN(h) || Number.isNaN(u))
      return p("error end point:", e.text, e.x, e.y), f.x = 50, f.y = 50, f.rotate = 0, this.createReturnValue("M 0 0 L 100 100", f);
    let v = i.el.offsetWidth || i.width || 60, y = i.el.offsetHeight || i.height || 60;
    if (Number.isNaN(v) || Number.isNaN(y))
      return f.x = 50, f.y = 50, f.rotate = 0, this.createReturnValue("M 0 0 L 100 100", f);
    let C = e.el.offsetWidth || e.width || 60, b = e.el.offsetHeight || e.height || 60;
    if (Number.isNaN(C) || Number.isNaN(b))
      return f.x = 50, f.y = 50, f.rotate = 0, this.createReturnValue("M 0 0 L 100 100", f);
    t.isReverse && ([r, l, h, u, v, y, C, b] = [
      h,
      u,
      r,
      l,
      C,
      b,
      v,
      y
    ]);
    const z = [
      r,
      l,
      h,
      u,
      v,
      y,
      C,
      b,
      0,
      t.isReverse,
      s,
      o
    ], B = [
      h,
      u,
      r,
      l,
      C,
      b,
      v,
      y,
      0,
      !t.isReverse,
      s,
      o
    ], S = this.options.defaultJunctionPoint || he.border, k = t.fromJunctionPoint || i.junctionPoint || S, D = t.toJunctionPoint || e.junctionPoint || S, I = this._getJunctionPoint(k, z), J = this._getJunctionPoint(D, B);
    if (!I || !J)
      return this.createReturnValue(
        "Unable to calculate the starting point and ending point of the line.",
        f
      );
    const w = I.x, O = I.y, le = J.x, j = J.y;
    if (i === e) {
      const q = r + v / 2, U = l + y / 2, te = Math.atan2(O - U, w - q), H = Math.sin(te + Math.PI) * 5, P = Math.cos(te + Math.PI) * 5, X = { x: w - H, y: O - P }, se = { x: w + H, y: O + P }, ce = w - P * 5, ae = O - H * 5, oe = w - P * 5, K = O - H * 5, me = `M${X.x},${X.y} C${ce},${ae} ${oe},${K} ${se.x},${se.y}`;
      return f.x = w - P / (P + H) * 20, f.y = O + H / (P + H) * 20, f.rotate = 0, this.createReturnValue(me, f);
    }
    if (Number.isNaN(w) || Number.isNaN(O))
      return console.error("error start point:", i), f.x = 50, f.y = 50, f.rotate = 0, this.createReturnValue("M 0 0 L 100 100", f);
    if (Number.isNaN(le) || Number.isNaN(j))
      return console.error("error end point:", e), f.x = 50, f.y = 50, f.rotate = 0, this.createReturnValue("M 0 0 L 100 100", f);
    let R = le - w, $ = j - O, ie = R > 0 ? 1 : -1, ge = $ > 0 ? 1 : -1, Y = c === "v" ? ge : ie, fe = "";
    if (a === 4) {
      const q = Math.floor(60 / (s + 1) * (o + 1)) - 30;
      if (c === "v")
        $ = $ - (Y * 33 + q), f.x = w + R + 5, f.y = O + Y * 40 + q, f.rotate = 90, fe = `M ${w} ${O} v${Y * 33 + q} h${R + q} v${$}`;
      else {
        f.x = w + Y * 50 - (Y < 0 ? 30 : 0), f.y = O + $ - 5 + q, R = R - (Y * 33 + q), $ = $ + Y * q;
        let U = this.options.defaultPloyLineRadius || 0;
        const te = Y * 33 + q - U;
        if (U > 0) {
          Math.abs(O - j) < U * 2 && (U = Math.abs(O - j) / 2);
          const H = U * (w < le ? 1 : -1), P = U * (O < j ? 1 : -1), X = [];
          X.push(`M ${w - H} ${O}`), X.push(`h${te}`), X.push(`C${w + te + H},${O}, ${w + te + H},${O + P}, ${w + te + H},${O + P}`), X.push(`v${$ - P - P}`);
          const se = w + te + H, ce = O + P + ($ - P - P);
          X.push(`C${se},${ce + P}, ${se + H},${ce + P}, ${se + H},${ce + P}`), X.push(`h${R - U}`), fe = X.join(" ");
        } else
          fe = `M ${w} ${O} h${te} v${$ - U} h${R - U}`;
      }
    } else if (a === 2 || a === 3 || a === 5 || a === 6) {
      const q = r + v / 2, U = l + y / 2, te = h + C / 2, H = u + b / 2, P = w - q, X = O - U, se = le - te, ce = j - H, ae = 1 / (s + 1) * (o + 1);
      let oe, K;
      if (a === 2)
        oe = c === "v" ? { x: 0, y: Y * 30 } : { x: Y * 30, y: 0 }, K = c === "v" ? { x: R * ae, y: Y * -10 } : { x: Y * -10, y: $ * ae };
      else if (a === 3)
        oe = c === "v" ? { x: 0, y: $ * ae } : { x: Y * 30, y: 0 }, K = c === "v" ? { x: 0, y: 0 } : { x: Y * -10, y: $ * ae };
      else if (a === 5)
        oe = c === "v" ? { x: 0, y: 0 } : { x: 0, y: 0 }, K = c === "v" ? { x: 0, y: $ * ae } : { x: R * ae, y: 0 };
      else if (a === 6) {
        const de = Math.abs(le - w) / 2 * 0.6;
        k === he.left ? oe = { x: P + de - 100, y: X } : oe = { x: P + de, y: X }, se > 0 ? K = { x: se - de + R + 100, y: ce + $ } : K = { x: se - de + R, y: ce + $ };
      }
      const me = this.calcCurveCenter(
        { x: w, y: O },
        oe,
        K,
        { x: R, y: $ }
      );
      f.x = me.x, f.y = me.y, fe = `M${w},${O} c${oe.x},${oe.y} ${K.x},${K.y} ${R},${$}`;
    } else
      f.rotate = ee.getTextAngle(w, O, le, j), f.x = Math.round(I.x + R / 2), f.y = Math.round(I.y + $ / 2), Number.isNaN(f.rotate) && (f.rotate = 0), fe = `M ${w} ${O} L ${le} ${j}`;
    return this.createReturnValue(fe, f);
  }
  calcCurveCenter(i, e, t, o) {
    const a = i.x + 0.7 * e.x + 0.48999999999999994 * t.x + 0.3429999999999999 * o.x, c = i.y + 0.7 * e.y + 0.7 ** 2 * t.y + 0.7 ** 3 * o.y;
    return { x: a, y: c };
  }
  createCheckedLinePath() {
    const i = this.options.checkedLineId;
    if (!!i)
      try {
        const e = this.getElementLineById(this.options.checkedLinkId);
        if (e) {
          const { path: c } = this.createLinePath(
            e,
            e.relations[0],
            0
          );
          return c;
        }
        const t = this.getLinkByLineId(i);
        if (!t) {
          p("Can not find link by checkedLineId:", i);
          return;
        }
        if (!x.isAllowShowNode(t.fromNode)) {
          p("from hide:", i);
          return;
        }
        if (!x.isAllowShowNode(t.toNode)) {
          p("to hide:", i);
          return;
        }
        const o = t.relations.findIndex((c) => c.id === i);
        if (o === -1) {
          p("Can not find checkedLineId:", i);
          return;
        }
        const s = t.relations[o], { path: a } = this.createLinePath(
          t,
          s,
          o
        );
        return a;
      } catch (e) {
        p(e);
      }
  }
  createCheckedLineStrokeWidth() {
    const i = this.options.checkedLineId;
    if (!i)
      return this.options.defaultLineWidth + 8;
    try {
      const e = this.getLinkByLineId(i);
      if (!e)
        return this.options.defaultLineWidth + 8;
      const t = e.relations.findIndex((s) => s.id === i);
      if (t === -1)
        return this.options.defaultLineWidth + 8;
      const o = e.relations[t];
      return o.lineWidth ? o.lineWidth + 8 : this.options.defaultLineWidth + 8;
    } catch (e) {
      p(e);
    }
  }
  getTextTransform(i, e, t, o) {
    if (Number.isNaN(e) || Number.isNaN(t))
      return "translate(0,0)";
    const s = i.lineShape === void 0 ? this.options.defaultLineShape : i.lineShape;
    return s === 1 || s === 4 ? `translate(${e},${t})rotate(${o || 0})` : `translate(${e},${t})`;
  }
  getArrow(i, e, t = !1) {
    return i.isHideArrow ? "none" : `url('#${this.getLineArrow(
      i.color,
      t,
      !1
    )}')`;
  }
}
class wo extends xo {
  constructor(e, t) {
    super(e, t);
    L(this, "zoomCenter_of_newSize", { x: 0, y: 0 });
  }
  zoom(e, t) {
    this.options.canvasZoom + e < 10 && (p("zoom:reset zoom=10"), e = 10 - this.options.canvasZoom);
    const o = this.options.canvasZoom + e, s = this.showZoomCenter(t, e);
    this.options.canvasOffset.x += s.buff_x, this.options.canvasOffset.y += s.buff_y, this.options.canvasZoom = o, this.refreshNVAnalysisInfo();
  }
  setZoom(e, t) {
    const o = Math.floor(e - this.options.canvasZoom);
    this.zoom(o, t);
  }
  getCanvasCoordinateByClientCoordinate(e) {
    const t = this.options.canvasZoom / 100, { NMCanvasStart: o, NMZoomCenter: s } = this.analysisByZoom(t, e), a = {
      x: s.x - o.x,
      y: s.y - o.y
    };
    return {
      x: a.x / t,
      y: a.y / t
    };
  }
  getClientCoordinateByCanvasCoordinate(e) {
    const t = this.options.canvasZoom / 100, { NMCanvasStart: o } = this.analysisByZoom(t), s = {
      x: e.x * t + o.x,
      y: e.y * t + o.y
    };
    return {
      x: s.x + this.options.canvasOffset.x,
      y: s.y + this.options.canvasOffset.y
    };
  }
  analysisByZoom(e, t) {
    const o = {
      NMViewPosition: { x: 0, y: 0 },
      NMViewCenter: { x: 0, y: 0 },
      NMCanvasCenter: { x: 0, y: 0 },
      NMCanvasStart: { x: 0, y: 0 },
      NMCanvasEnd: { x: 0, y: 0 },
      NMZoomCenter: { x: 0, y: 0 },
      NMViewBuff: { x: 0, y: 0 },
      NMCanvasOffsetBuff: { x: 0, y: 0 },
      NMCanvasSize: { width: 0, height: 0 }
    }, s = this.$dom.getBoundingClientRect();
    o.NMViewPosition.x = s.left, o.NMViewPosition.y = s.top, o.NMViewCenter.x = s.width / 2, o.NMViewCenter.y = s.height / 2;
    const a = this.options.canvasSize.width * e, c = this.options.canvasSize.height * e;
    o.NMCanvasCenter.x = this.options.canvasOffset.x + this.options.canvasSize.width / 2, o.NMCanvasCenter.y = this.options.canvasOffset.y + this.options.canvasSize.height / 2, o.NMCanvasStart.x = o.NMCanvasCenter.x - a / 2, o.NMCanvasStart.y = o.NMCanvasCenter.y - c / 2, o.NMCanvasEnd.x = o.NMCanvasCenter.x + a / 2, o.NMCanvasEnd.y = o.NMCanvasCenter.y + c / 2, o.NMZoomCenter.x = o.NMViewCenter.x, o.NMZoomCenter.y = o.NMViewCenter.y, t && (o.NMZoomCenter.x = t.x - o.NMViewPosition.x, o.NMZoomCenter.y = t.y - o.NMViewPosition.y);
    let r = o.NMViewCenter.x - o.NMCanvasCenter.x, l = o.NMViewCenter.y - o.NMCanvasCenter.y;
    return t && (r = o.NMZoomCenter.x - o.NMCanvasCenter.x, l = o.NMZoomCenter.y - o.NMCanvasCenter.y), o.NMViewBuff.x = r, o.NMViewBuff.y = l, o.NMCanvasSize.width = a, o.NMCanvasSize.height = c, o;
  }
  showZoomCenter(e, t) {
    if (!this.$dom)
      return { buff_x: 0, buff_y: 0 };
    const o = this.options.canvasZoom / 100, s = this.analysisByZoom(o, e), a = (this.options.canvasZoom + t) / 100, c = this.analysisByZoom(a, e), r = a / o, l = 0, h = 0, u = a / o, f = 0, v = 0;
    this.zoomCenter_of_newSize.x = r * s.NMViewBuff.x + h * s.NMViewBuff.y + f, this.zoomCenter_of_newSize.y = l * s.NMViewBuff.x + u * s.NMViewBuff.y + v;
    const y = s.NMViewBuff.x - this.zoomCenter_of_newSize.x, C = s.NMViewBuff.y - this.zoomCenter_of_newSize.y;
    this.zoomCenter_of_newSize.x += s.NMCanvasCenter.x, this.zoomCenter_of_newSize.y += s.NMCanvasCenter.y;
    let b = s.NMCanvasStart.x - s.NMCanvasCenter.x, z = s.NMCanvasStart.y - s.NMCanvasCenter.y, B = r * b + h * z + f, S = l * b + u * z + v;
    return c.NMCanvasStart.x = y + s.NMCanvasCenter.x + B, c.NMCanvasStart.y = y + s.NMCanvasCenter.y + S, b = s.NMCanvasEnd.x - s.NMCanvasCenter.x, z = s.NMCanvasEnd.y - s.NMCanvasCenter.y, B = r * b + h * z + f, S = l * b + u * z + v, c.NMCanvasEnd.x = y + s.NMCanvasCenter.x + B, c.NMCanvasEnd.y = y + s.NMCanvasCenter.y + S, s.NMCanvasOffsetBuff.x = y, s.NMCanvasOffsetBuff.y = C, {
      buff_x: y,
      buff_y: C
    };
  }
}
class Co extends wo {
  constructor(i, e) {
    super(i, e);
  }
  async doLayout() {
    if (!this.layouter) {
      p("no layouter");
      return;
    }
    if (!this.graphData.rootNode) {
      p("Cant find rootNode!");
      return;
    }
    this.options.showMaskWhenLayouting && this.loading(), await oo(200), this.options.showMaskWhenLayouting && this.clearLoading(), p("node size\uFF1A", this.graphData.nodes.length);
    const i = this.options.useAnimationWhenExpanded;
    this.disableNextLayoutAnimation && (this.options.useAnimationWhenExpanded = !1), this.layouter.requireLinks && this.layouter.setLinks(this.getLinks()), await this.layouter.placeNodes(this.graphData.nodes, this.graphData.rootNode), this.options.useAnimationWhenExpanded = i, this.disableNextLayoutAnimation = !1, this.updateElementLines(), this._dataUpdated();
  }
  async refresh(i = !0) {
    this.resetViewSize(), this.disableNextLayoutAnimation = !0, this._dataUpdated(), i && await this.doLayout(), p("placeOtherNodes"), await this.placeOtherNodes(), p("placeOtherNodes ok!"), await this.playShowEffect(), this.updateElementLines(), this._dataUpdated();
  }
  async playShowEffect() {
    if (this.graphData.nodes.length === 0) {
      p("relation-graph:move to center: data not ready!");
      return;
    }
    if (p("playShowEffect:", this.options.moveToCenterWhenRefresh, this.options.zoomToFitWhenRefresh), this.graphData.rootNode && Number.isNaN(this.graphData.rootNode.x)) {
      p("rootNode.x is NaN, graph is currently hidden?");
      return;
    }
    this.options.moveToCenterWhenRefresh ? await this.moveToCenter() : (this.setCanvasCenter(0, 0), this._dataUpdated()), await this.zoomToFitWhenRefresh();
  }
  async moveToCenter() {
    if (this.options.useAnimationWhenRefresh) {
      const i = this.getNodesCenter();
      p("center:", i.x, i.y);
      const e = this.getGraphOffet();
      p("centerOffset:", e.offset_x, e.offset_y);
      const t = this.options.viewSize.width / 2 - i.x + e.offset_x, o = this.options.viewSize.height / 2 - i.y + e.offset_y;
      await this.animateGoto(t, o, 500), this._dataUpdated();
    } else {
      const i = this.getNodesCenter();
      this.setCanvasCenter(i.x, i.y), this._dataUpdated();
    }
  }
  async zoomToFitWhenRefresh() {
    this.options.zoomToFitWhenRefresh && await this.zoomToFit();
  }
  async placeOtherNodes() {
    const i = [];
    this.graphData.rootNode && this.findGroupNodes(this.graphData.rootNode, i);
    const e = [], t = [];
    this.graphData.nodes.forEach((o) => {
      i.includes(o) || (this.options.placeSingleNode && (!o.targetNodes || o.targetNodes.length === 0) && o.fixed !== !0 ? (o.x = Math.floor(Math.random() * 200) - 100, o.y = Math.floor(Math.random() * 200) - 100, o.lot || (o.lot = { childs: [] }), o.lot.placed = !0, o.singleNode = !0, t.push(o)) : e.push(o));
    }), this.options.placeSingleNode && this.options.layoutName !== "fixed" && this.placeSingleNodes(t), this.options.placeOtherGroup && this.options.layoutName !== "fixed" && (await this.placeOtherGroup(e, i), this._dataUpdated());
  }
  placeSingleNodes(i) {
    if (i.length > 0) {
      p("sigle nodes:", i.length);
      const e = new Me({ layoutName: "force" }, this.options);
      e.allNodes = this.graphData.nodes, e.fastStart = !0, e.justLayoutSingleNode = !0, e.maxLayoutTimes = 100, e.byLine = !1, e.autoLayout(!0);
    }
  }
  async placeOtherGroup(i, e) {
    if (i.length > 0) {
      p("[placeOtherGroup]notPlacedNodes nodes:", i.length);
      const t = JSON.parse(JSON.stringify(this.layouter.layoutOptions)), o = vt(t, this.options);
      o.isMainLayouer = !1;
      const s = i[0], a = this.getStuffSize(e);
      p("[placeOtherGroup]placeOtherGroup:", o.layoutOptions.layoutName, "root:", s.text);
      let c = o.layoutOptions.layoutName.includes("tree") ? 300 : 600;
      if (o.layoutOptions.layoutName === "force") {
        const h = o;
        h.force_node_repulsion = 0.2, h.force_line_elastic = 1.5, c = 100;
      }
      s.x = a.maxX + c, s.y = 0, o.layoutOptions.fixedRootNode = !0;
      const r = [];
      this.findGroupNodes(s, r), p("[placeOtherGroup]thisGroupNodes:", i.length), this.layouter.requireLinks && this.layouter.setLinks(this.getLinks()), await o.placeNodes(r, s), e.push(...r);
      const l = [];
      i.forEach((h) => {
        e.includes(h) || l.push(h);
      }), await this.placeOtherGroup(l, e), this._dataUpdated();
    }
  }
  async zoomToFit(i) {
    const e = this.getStuffSize(), t = this.options.viewSize.width / e.width, o = this.options.viewSize.height / e.height, s = Math.min(t, o, 1);
    p("zoomToFit:", { stuffSize: e, zoomPercent: s, zoomPercentX: t, zoomPercentY: o, viewSize: this.options.viewSize }), this.options.useAnimationWhenRefresh ? (await this.animateToZoom(s * 100, 300), this._dataUpdated(), i && i()) : (this.setZoom(s * 100), this._dataUpdated(), i && i());
  }
  async animateGoto(i, e, t) {
    return new Promise((o, s) => {
      p("animateGoto:", i, e);
      const a = i - this.options.canvasOffset.x, c = e - this.options.canvasOffset.y, r = t, l = 5, h = Math.round(a / l), u = Math.round(c / l), f = r / l;
      this.animateStepAction(0, f, l, () => {
        this.options.canvasOffset.x += h, this.options.canvasOffset.y += u, this._dataUpdated();
      }, () => {
        o();
      });
    });
  }
  async animateToZoom(i, e) {
    return new Promise((t, o) => {
      const s = i - this.options.canvasZoom, a = e, c = 5, r = Math.round(s / c), l = a / c;
      p("animateToZoom:", s, r), this.animateStepAction(0, l, c, () => {
        this.zoom(r), this._dataUpdated();
      }, () => {
        this.setZoom(i), this._dataUpdated(), t();
      });
    });
  }
  animateStepAction(i, e, t, o, s) {
    i < t ? (o(i, t), setTimeout(() => {
      this.animateStepAction(i + 1, e, t, o, s);
    }, e)) : s();
  }
  toggleAutoLayout() {
    this.options.autoLayouting = !this.options.autoLayouting, p("toggleAutoLayout:to:", this.options.autoLayouting), this.options.autoLayouting ? this.startAutoLayout() : this.stopAutoLayout();
  }
  startAutoLayout() {
    this.options.autoLayouting = !0, this.layouter.autoLayout ? this.layouter.autoLayout(!0, this.isReact && (() => {
      this._dataUpdated();
    })) : p("Current layout not support stop()");
  }
  stopAutoLayout() {
    this.options.autoLayouting = !1, this.layouter.stop ? this.layouter.stop() : p("Current layout not support stop()");
  }
}
let ve = { x: 0, y: 0 };
const _e = { x: 0, y: 0 }, xe = { x: 0, y: 0 };
let Fe, Ge;
const ut = (n) => {
  const i = {
    clientX: 0,
    clientY: 0
  };
  if (ye(n)) {
    const e = n.touches || n.targetTouches;
    if (!e)
      throw new Error("error targetTouches");
    i.clientX = e[0].clientX, i.clientY = e[0].clientY;
  } else
    i.clientX = n.clientX, i.clientY = n.clientY;
  return i;
}, re = {
  startDrag(n, i, e, t) {
    t ? Fe = (o, s, a) => {
      const c = o - xe.x, r = s - xe.y;
      t(c, r, _e, xe, a);
    } : Fe = (o, s) => {
      ve.x = _e.x + (o - xe.x), ve.y = _e.y + (s - xe.y);
    }, Ge = e, ve = i, _e.x = ve.x, _e.y = ve.y, p("[canvas]onDragStart...", ye(n), n);
    try {
      const o = ut(n);
      xe.x = o.clientX, xe.y = o.clientY, ye(n) ? (document.body.addEventListener("touchmove", re.onNodeMove), document.body.addEventListener("touchend", re.onNodeDragend), n.preventDefault()) : (document.body.addEventListener("mousemove", re.onNodeMove), document.body.addEventListener("mouseup", re.onNodeDragend));
    } catch (o) {
      console.error(o.message);
    }
  },
  onNodeMove(n) {
    const i = ut(n);
    Fe(i.clientX, i.clientY, n);
  },
  onNodeDragend(n) {
    ye(n) ? (document.body.removeEventListener("touchmove", re.onNodeMove), document.body.removeEventListener("touchend", re.onNodeDragend)) : (document.body.removeEventListener("mousemove", re.onNodeMove), document.body.removeEventListener("mouseup", re.onNodeDragend)), p("[canvas]onDragend...", ye(n), n), Ge && Ge(
      ve.x - _e.x,
      ve.y - _e.y,
      n
    );
  }
};
class Lo extends Co {
  constructor(e, t) {
    super(e, t);
    L(this, "prevClickTime", 0);
    L(this, "movingListener");
    L(this, "step1EventTime", 0);
    L(this, "onCreateLineCallback");
  }
  setDefaultLineShape(e) {
    this.options.defaultLineShape = e;
  }
  setDefaultJunctionPoint(e) {
    this.options.defaultJunctionPoint = e;
  }
  setCheckedNode(e) {
    this.options.checkedNodeId = e;
  }
  setCheckedLinkAndLine(e, t) {
    this.options.checkedLinkId = e.seeks_id, this.options.checkedLineId = t ? t.id : "";
  }
  clearChecked() {
    this.options.checkedNodeId = "", this.options.checkedLineId = "", this.options.checkedLinkId = "";
  }
  selectNode(e, t) {
    e.selected = t;
  }
  flashNode(e, t) {
    e.flashing = t;
  }
  updateNodeOffsetSize(e, t, o) {
    e.el.offsetWidth = t, e.el.offsetHeight = o;
  }
  onNodeClick(e, t) {
    if (Date.now() - this.prevClickTime < 200) {
      p("[node]click abort : time < 200");
      return;
    }
    p("[node]node click", e.text), this.prevClickTime = Date.now(), !t.shiftKey && this.options.disableNodeClickEffect !== !0 && e.disableDefaultClickEffect !== !0 && (this.options.checkedLinkId = "", this.options.checkedLineId = "", this.setCheckedNode(e.id)), this.options.creatingLinePlot && this.onNodeClickWhenCreatingLinePlot(e), this.listeners.onNodeClick && this.listeners.onNodeClick(e, t);
  }
  onLineClick(e, t, o) {
    p("onLineClick:", "line:", e, "link:", t), this.options.disableLineClickEffect !== !0 && e.disableDefaultClickEffect !== !0 && (this.setCheckedNode(""), this.setCheckedLinkAndLine(t, e)), this.listeners.onLineClick && this.listeners.onLineClick(e, t, o);
  }
  async expandOrCollapseNode(e, t) {
    e.expanded === !1 ? await this.expandNode(e, t) : await this.collapseNode(e, t);
  }
  setChildsFromPosition(e, t) {
    e.lot.childs.forEach((o) => {
      o.x = t.x, o.y = t.y, this.setChildsFromPosition(o, t);
    });
  }
  async expandNode(e, t) {
    p("onNodeExpand:", e), e.expanded = !0, this.options.useAnimationWhenExpanded && (await this.layouter.snapshotBeforeAnimation(), this.setChildsFromPosition(e, e), await this.layouter.animationLayout(!1)), p("relayout check:", this.options.reLayoutWhenExpandedOrCollapsed), this.options.reLayoutWhenExpandedOrCollapsed && (p("relayout..."), await this.layouter.snapshotBeforeAnimation(), await this.doLayout()), this.updateElementLines(), this._dataUpdated(), this.listeners.onNodeExpand && this.listeners.onNodeExpand(e, t);
  }
  setChildsToPosition(e, t) {
    e.lot.childs.forEach((o) => {
      o.lot.from_x = o.x, o.lot.from_y = o.y, o.lot.to_x = t.x, o.lot.to_y = t.y, this.setChildsToPosition(o, t);
    });
  }
  async collapseNode(e, t) {
    p("onNodeCollapse:", e), this.options.useAnimationWhenExpanded && (await this.layouter.snapshotBeforeAnimation(), this.setChildsToPosition(e, e), await this.layouter.animationLayout(!1)), e.expanded = !1, p("relayout check:", this.options.reLayoutWhenExpandedOrCollapsed), this.options.reLayoutWhenExpandedOrCollapsed && (p("relayout..."), await this.layouter.snapshotBeforeAnimation(), await this.doLayout()), this.updateElementLines(), this._dataUpdated(), this.listeners.onNodeCollapse && this.listeners.onNodeCollapse(e, t);
  }
  onNodeDragEnd(e, t) {
    this.updateElementLines(), this.listeners.onNodeDragEnd && this.listeners.onNodeDragEnd(e, t);
  }
  onCanvasDragEnd(e) {
    this.listeners.onCanvasDragEnd && this.listeners.onCanvasDragEnd(e);
  }
  onCanvasClick(e) {
    this.options.creatingLinePlot && this.onCanvasClickWhenCreatingLinePlot(e), this.listeners.onCanvasClick && this.listeners.onCanvasClick(e);
  }
  clickGraphMask(e) {
    this.clearLoading();
  }
  onCanvasSelectionEnd(e, t) {
    this.listeners.onCanvasSelectionEnd && this.listeners.onCanvasSelectionEnd(e, t);
  }
  startCreatingNodePlot(e, t) {
    this.options.newNodeTemplate = Ze(JSON.parse(JSON.stringify(xt))), this.options.creatingNodePlot = !0;
    const o = ye(e);
    this.options.showTemplateNode = !o, console.log("is touch event:", o);
    let s = (y, C) => {
      this.options.newNodeTemplate.x = y, this.options.newNodeTemplate.y = C, this._dataUpdated();
    }, a = (y, C) => {
      const b = "s-" + Date.now();
      this.addNodes([{
        id: b,
        text: this.options.newNodeTemplate.text,
        x: y,
        y: C
      }]);
    };
    t && t.templateText && (this.options.newNodeTemplate.text = t.templateText), t && t.templateStyleClass && (this.options.newNodeTemplate.styleClass = t.templateStyleClass), t && t.templateNode && Object.keys(t.templateNode).forEach((y) => {
      this.options.newNodeTemplate[y] = t.templateNode[y];
    }), t && t.templateMove && (s = t.templateMove), t && t.onCreateNode && (a = t.onCreateNode);
    const c = this.$dom.getBoundingClientRect();
    p("[CreatingNodePlot]startCreatingNodePlot:");
    const r = je(e), l = r.clientX - c.x + 10, h = r.clientY - c.y + 10;
    o || s(l, h);
    const u = (y) => {
      const C = this.$dom.getBoundingClientRect();
      p("[CreatingNodePlot]objectTemplateMove");
      const b = y.clientX - C.x + 10, z = y.clientY - C.y + 10;
      s(b, z);
    }, f = (y) => {
      p("[CreatingNodePlot]user abort!"), this.$dom.removeEventListener("mousemove", u), this.$dom.removeEventListener("click", v), this.$dom.removeEventListener("contextmenu", f), this.options.creatingNodePlot = !1;
    }, v = (y) => {
      let C = !1;
      if (this.options.creatingNodePlot || (C = !0), this.$dom.removeEventListener("mousemove", u), this.$dom.removeEventListener("click", v), this.$dom.removeEventListener("contextmenu", f), this.options.creatingNodePlot = !1, C) {
        p("[CreatingNodePlot]action be abort!");
        return;
      }
      const b = je(y), z = b.clientX - c.x + 10, B = b.clientY - c.y + 10;
      if (t && t.disableClickCreate && Math.abs(l - z) < 5 && Math.abs(h - B) < 5) {
        p("[CreatingNodePlot]create node be abort!");
        return;
      }
      const S = this.getCanvasCoordinateByClientCoordinate({ x: b.clientX, y: b.clientY });
      p("[CreatingNodePlot]objectBePlaced:", S), a(S.x, S.y), this._dataUpdated();
    };
    setTimeout(() => {
      this.$dom.addEventListener("click", v), this.$dom.addEventListener("contextmenu", f);
    }, 300), o || this.$dom.addEventListener("mousemove", u);
  }
  startCreatingLinePlot(e, t) {
    const o = ye(e);
    t && t.onCreateLine && (this.onCreateLineCallback = t.onCreateLine), t && t.template && Object.assign(this.options.newLineTemplate, t.template), this.options.newLinkTemplate.fromNode = null, t && t.fromNode && (this.options.newLinkTemplate.toNode.x = t.fromNode.x + 50, this.options.newLinkTemplate.toNode.y = t.fromNode.y + 50, this.options.newLinkTemplate.fromNode = t.fromNode, this.step1EventTime = Date.now()), this.options.creatingLinePlot = !0, this.options.newLinkTemplate.toNodeObject = null, p("[CreatingLinePlot]startCreatingLinePlot:", o), o || (p("[CreatingLinePlot]Listener move"), this.movingListener = this.onMovingWhenCreatingLinePlot.bind(this), this.$dom.addEventListener("mousemove", this.movingListener));
  }
  stopCreatingLinePlot() {
    p("[CreatingLinePlot]stop CreatingLinePlot!"), this.options.creatingLinePlot = !1, this.options.newLinkTemplate.fromNode = null, this.options.newLinkTemplate.toNodeObject = null, this.onCreateLineCallback = void 0, this.$dom.removeEventListener("mousemove", this.movingListener), this._dataUpdated();
  }
  onMovingWhenCreatingLinePlot(e) {
    if (p("[CreatingLinePlot]mousemove"), this.options.newLinkTemplate.fromNode) {
      const t = this.getCanvasCoordinateByClientCoordinate({
        x: e.clientX,
        y: e.clientY
      });
      this.options.newLinkTemplate.toNode.x = t.x, this.options.newLinkTemplate.toNode.y = t.y, this._dataUpdated();
    }
  }
  onCanvasClickWhenCreatingLinePlot(e) {
    if (Date.now() - this.step1EventTime < 500) {
      p("[CreatingLinePlot]step1EventTime:", this.step1EventTime);
      return;
    }
    if (!this.options.newLinkTemplate.fromNode) {
      p("[CreatingLinePlot]CreatingLinePlot:fromNode not set!");
      return;
    }
    if (!this.options.newLinkTemplate.toNodeObject) {
      p("[CreatingLinePlot]CreatingLinePlot:toNodeObject not set!");
      const t = je(e), o = this.getCanvasCoordinateByClientCoordinate({ x: t.clientX, y: t.clientY });
      this.onCreateLine(this.options.newLinkTemplate.fromNode, o);
    }
    this.stopCreatingLinePlot();
  }
  onNodeClickWhenCreatingLinePlot(e) {
    this.options.newLinkTemplate.fromNode ? (p("[CreatingLinePlot]step 2: set toNodeObjecct:", this.options.newLinkTemplate.fromNode, e), this.options.newLinkTemplate.toNodeObject = e, this.onCreateLine(this.options.newLinkTemplate.fromNode, e), this.stopCreatingLinePlot()) : (p("[CreatingLinePlot]step 1: set fromNode:", e), this.options.newLinkTemplate.fromNode = e, this.options.newLinkTemplate.toNode.x = e.x + 50, this.options.newLinkTemplate.toNode.y = e.y + 50, this.step1EventTime = Date.now());
  }
  onCreateLine(e, t) {
    p("[CreatingLinePlot][fire-event]onCreateLine:", e, t), this.onCreateLineCallback && this.onCreateLineCallback(e, t, this.options.newLineTemplate);
  }
  isNode(e) {
    const t = Ye(e, "rel-node-peel", "rel-map");
    return t ? this.getNodeById(t.dataset.id) : void 0;
  }
  isLink(e) {
    const t = Ye(e, "rel-link-peel", "rel-map");
    return t ? this.getLinkById(t.dataset.id) : void 0;
  }
  onContextmenu(e) {
    let t = "canvas", o = this.isNode(e.target);
    o ? t = "node" : (o = this.isLink(e.target), o && (t = "link")), p("contextmenu:objectType", t, o), this.listeners.onContextmenu && this.listeners.onContextmenu(e, t, o);
  }
  fullscreen(e) {
    e === void 0 ? (this.options.fullscreen = !this.options.fullscreen, Se.toggle(this.$dom).then(() => {
      setTimeout(() => {
        this.refreshNVAnalysisInfo();
      }, 1e3);
    })) : (this.options.fullscreen = e, setTimeout(() => {
      this.refreshNVAnalysisInfo();
    }, 1e3));
  }
  async focusNodeById(e) {
    let t;
    this.graphData.nodes.forEach((o) => {
      o.id === e && (t = o);
    }), t && await this.handleSelect(t);
  }
  async focusRootNode() {
    p("relation-graph:focusRootNode"), this.graphData.rootNode && await this.handleSelect(this.graphData.rootNode);
  }
  async handleSelect(e) {
    p("checked:", e), scrollTo({
      top: this.$dom.offsetTop
    }), await this.animateToZoom(100, 300);
    const t = e.width || 50, o = e.height || 50, s = e.x * -1 + this.options.viewSize.width / 2 - t / 2, a = e.y * -1 + this.options.viewSize.height / 2 - o / 2;
    await this.animateGoto(s, a, 500), this.options.checkedNodeId = e.id, this.refreshNVAnalysisInfo();
  }
  onMouseWheel(e) {
    if (this.options.disableZoom)
      return e.cancelBubble = !1, !0;
    try {
      e.cancelBubble = !0, e.preventDefault(), e.stopPropagation();
    } catch {
    }
    const t = {
      x: e.clientX,
      y: e.clientY
    };
    let o = e.deltaY;
    o === void 0 && (o = e.wheelDelta);
    const s = -1;
    o > 0 ? this.zoom(5 * s, t) : this.zoom(-5 * s, t);
  }
  onLineDragStart(e, t) {
    p("onLineDragStart...");
    const o = { x: e.fromNode.x, y: e.fromNode.y }, s = { x: e.toNode.x, y: e.toNode.y }, a = (c, r, l, h, u) => {
      e.fromNode.x = o.x + c / (this.options.canvasZoom / 100), e.fromNode.y = o.y + r / (this.options.canvasZoom / 100), e.toNode.x = s.x + c / (this.options.canvasZoom / 100), e.toNode.y = s.y + r / (this.options.canvasZoom / 100), this._dataUpdated();
    };
    re.startDrag(t, { x: 0, y: 0 }, (...c) => {
      this.onLineDragEnd(...c);
    }, a);
  }
  onLineDragEnd(e, t, o) {
    p("onLineDragEnd"), this.updateElementLines();
  }
  onCanvasDragStart(e) {
    if (p("[canvas]onCanvasDragStart..."), this.options.disableDragCanvas || e.shiftKey) {
      this.startCreateSelection(e);
      return;
    }
    if (!this.options.disableDragLine) {
      const o = this.isLink(e.target);
      if (o) {
        this.onLineDragStart(o, e);
        return;
      }
    }
    let t;
    if (ye(e)) {
      let o, s = 1;
      t = (a, c, r, l, h) => {
        const u = h.touches || h.targetTouches, f = u[0];
        if (u && u.length > 1) {
          h.preventDefault();
          const v = u[1];
          o || (o = { x: v.clientX, y: v.clientY }, s = this.options.canvasZoom);
          const y = { x: f.clientX, y: f.clientY }, C = { x: v.clientX, y: v.clientY }, b = Math.hypot(o.x - l.x, o.y - l.y), B = Math.hypot(C.x - y.x, C.y - y.y) / b, S = s * B;
          this.setZoom(S), this._dataUpdated();
        } else {
          const v = f.clientX, y = f.clientY;
          let C = r.x + (v - l.x), b = r.y + (y - l.y);
          this.options.useHorizontalView ? (C = r.x + (y - l.y), b = r.y - (v - l.x), this.setCanvasOffset(C, b)) : this.setCanvasOffset(C, b), this._dataUpdated();
        }
      };
    } else
      t = (o, s, a, c, r) => {
        const l = a.x + o, h = a.y + s;
        this.setCanvasOffset(l, h), this._dataUpdated();
      };
    re.startDrag(e, this.options.canvasOffset, (...o) => {
      this.onCanvasDragStop(...o);
    }, t);
  }
  onCanvasDragStop(e, t, o) {
    if (p("[canvas]onCanvasDragStop..."), this.options.creatingSelection) {
      console.log("creatingSelection end"), this.options.creatingSelection = !1, this._dataUpdated(), this.onCanvasSelectionEnd(this.options.selectionView, o);
      return;
    }
    if (e === 0 && t === 0) {
      p("[canvas]click2"), this._dataUpdated(), this.onCanvasClick(o);
      return;
    }
    Math.abs(e) + Math.abs(t) > 6 ? setTimeout(() => {
      p("[canvas]onDragEnd1"), this._dataUpdated(), this.onCanvasDragEnd(o);
    }, 100) : (p("[canvas]onDragEnd2"), this._dataUpdated(), this.onCanvasDragEnd(o));
  }
  startCreateSelection(e) {
    let t = !1;
    const o = (s, a, c, r, l) => {
      if (!t && Math.abs(s) + Math.abs(a) > 6 && (t = !0, this.options.creatingSelection = !0, this.options.selectionView.x = r.x, this.options.selectionView.y = r.y), t) {
        const h = this.getBoundingClientRect();
        s < 0 ? (this.options.selectionView.x = r.x + s - h.x, this.options.selectionView.width = Math.abs(s)) : (this.options.selectionView.x = r.x - h.x, this.options.selectionView.width = s), a < 0 ? (this.options.selectionView.y = r.y + a - h.y, this.options.selectionView.height = Math.abs(a)) : (this.options.selectionView.y = r.y - h.y, this.options.selectionView.height = a);
      }
      this._dataUpdated();
    };
    re.startDrag(e, { x: 0, y: 0 }, (...s) => {
      this.onCanvasDragStop(...s);
    }, o);
  }
  onNodeDragStart(e, t) {
    if (this.options.disableDragNode || e.disableDrag)
      return;
    isNaN(e.x) && (e.x = 0), isNaN(e.y) && (e.y = 0);
    const o = (s, a, c) => {
      this.onNodeDraged(e, s, a, c), this._dataUpdated();
    };
    re.startDrag(t, e, o, (s, a, c) => {
      let r = s / (this.options.canvasZoom / 100) + c.x, l = a / (this.options.canvasZoom / 100) + c.y;
      this.setNodePosition(e, r, l), this.options.useHorizontalView ? (r = a / (this.options.canvasZoom / 100) + c.x, l = -s / (this.options.canvasZoom / 100) + c.y, this.setNodePosition(e, r, l)) : this.setNodePosition(e, r, l), this.updateElementLines(), this._dataUpdated();
    });
  }
  onNodeDraged(e, t, o, s) {
    if (t === 0 && o === 0) {
      p("[node]node click by drag"), this.onNodeClick(e, s);
      return;
    }
    this.options.isMoveByParentNode && e.lot.childs.forEach((a) => {
      a.x += t, a.y += o;
    }), Math.abs(t) + Math.abs(o) > 6 ? (this.prevClickTime = Date.now(), setTimeout(() => {
      p("[node]onDragEnd2"), this.onNodeDragEnd(e, s);
    }, 100)) : (p("[node]onDragEnd1"), this.onNodeDragEnd(e, s));
  }
}
class bo extends Lo {
  constructor(i, e) {
    super(i, e);
  }
  dataUpdated() {
    this.isReact ? this._dataUpdated() : (this.zoom(1), this.zoom(-1));
  }
  async setOptions(i, e = !1) {
    if (this.disableNextLayoutAnimation = !0, this._setOptions(i), e === !0) {
      p("setOptions:justUpdateOptionsValue");
      return;
    }
    this.initLayouter(), this.resetViewSize(), await this.doLayout(), this.resetViewSize();
  }
  setLayouter(i) {
    p("setLayouterClass::", i), this.userLayouerClass = i, this.layouter = this.userLayouerClass;
  }
  async switchLayout(i, e = !0, t = !1) {
    this.listeners.beforeChangeLayout && this.listeners.beforeChangeLayout(i) === !1 && (e = !1);
    const o = this.layouter ? this.layouter.allNodes : [], s = this.layouter && this.layouter.rootNode;
    p("[change layout]switchLayout"), this.stopAutoLayout(), wt(i, this.options), this._initLayoutByLayoutOptions(i), this.layouter.allNodes = o, this.layouter.rootNode = s, e ? await this.refresh() : (t || (this.disableNextLayoutAnimation = !0), await this.doLayout());
  }
  async setJsonData(i, e = !1) {
    await this._setJsonData(i);
    const t = i.rootId;
    if (t && (this.graphData.rootNode = this.graphData.nodes.find((o) => o.id === t)), !this.graphData.rootNode && this.graphData.nodes.length > 0 && (this.graphData.rootNode = this.graphData.nodes[0]), this.graphData.rootNode)
      this.options.defaultFocusRootNode && this.setCheckedNode(this.graphData.rootNode.id);
    else
      throw new Error("The root node [rootId] is not set! Or cannot get the root node:" + i.rootId + ", If you don't have any nodes to display, you can simply set an invisible node: {id:'root', opacity:0}");
    e && (p("resetViewSize:", e), this.resetViewSize()), this.disableNextLayoutAnimation = !0, await this.doLayout();
  }
  async appendJsonData(i, e = !0) {
    p("appendData:", i), this.loadGraphJsonData(i), e && (this.disableNextLayoutAnimation = !0, await this.doLayout());
  }
}
class So extends bo {
  constructor(i, e) {
    super(i, e);
  }
  ready() {
    this.initLayouter(), this.resetViewSize(), this.refreshNVAnalysisInfo();
  }
}
(function(n) {
  var i, e, t, o, s, a, c = '<svg><symbol id="icon-iconset0444" viewBox="0 0 1024 1024"><path d="M960 682.666667l-106.666667 0C844.8 569.6 763.733333 42.666667 64 42.666667 51.2 42.666667 42.666667 51.2 42.666667 64c0 12.8 8.533333 21.333333 21.333333 21.333333 219.733333 0 377.6 106.666667 465.066667 315.733333 51.2 123.733333 64 236.8 66.133333 281.6L490.666667 682.666667c-12.8 0-21.333333 8.533333-21.333333 21.333333 0 6.4 2.133333 10.666667 6.4 14.933333l234.666667 256c4.266667 4.266667 8.533333 6.4 14.933333 6.4 6.4 0 10.666667-2.133333 14.933333-6.4l234.666667-256c4.266667-4.266667 6.4-8.533333 6.4-14.933333C981.333333 691.2 972.8 682.666667 960 682.666667zM725.333333 928 539.733333 725.333333 618.666667 725.333333c12.8 0 21.333333-8.533333 21.333333-21.333333l0-21.333333c-4.266667-87.466667-38.4-396.8-273.066667-554.666667C755.2 251.733333 804.266667 588.8 810.666667 682.666667l0 21.333333c0 12.8 8.533333 21.333333 21.333333 21.333333l78.933333 0L725.333333 928z"  ></path></symbol><symbol id="icon-iconset0445" viewBox="0 0 1024 1024"><path d="M974.933333 305.066667l-234.666667-256C736 44.8 731.733333 42.666667 725.333333 42.666667c-6.4 0-10.666667 2.133333-14.933333 6.4l-234.666667 256C471.466667 309.333333 469.333333 313.6 469.333333 320c0 12.8 8.533333 21.333333 21.333333 21.333333l104.533333 0c-2.133333 44.8-14.933333 157.866667-66.133333 281.6C441.6 832 283.733333 938.666667 64 938.666667c-12.8 0-21.333333 8.533333-21.333333 21.333333 0 12.8 8.533333 21.333333 21.333333 21.333333 699.733333 0 780.8-526.933333 789.333333-640l106.666667 0c12.8 0 21.333333-8.533333 21.333333-21.333333C981.333333 313.6 979.2 309.333333 974.933333 305.066667zM832 298.666667c-12.8 0-21.333333 8.533333-21.333333 21.333333l0 21.333333c-6.4 93.866667-55.466667 430.933333-443.733333 554.666667 234.666667-157.866667 268.8-467.2 273.066667-554.666667l0-21.333333c0-12.8-8.533333-21.333333-21.333333-21.333333l-78.933333 0L725.333333 96l185.6 202.666667L832 298.666667z"  ></path></symbol><symbol id="icon-yuanquanfenxiang" viewBox="0 0 1024 1024"><path d="M751.148705 578.773799c-61.987796 0-117.066229 30.121018-151.388942 76.488045L398.287145 536.382317c1.991354-10.171664 3.046383-20.673855 3.046383-31.419594 0-18.776645-3.196809-36.817534-9.058306-53.621245l193.486736-107.492176c31.949666 58.566884 94.104261 98.391914 165.386748 98.391914 103.803157 0 188.254571-84.450391 188.254571-188.254571S854.951863 65.73105 751.148705 65.73105c-103.804181 0-188.255595 84.450391-188.255595 188.254571 0 14.246469 1.600451 28.125571 4.613064 41.4746L368.032074 406.279167c-29.841655-39.193651-76.976162-64.544015-129.927141-64.544015-90.004897 0-163.228595 73.223698-163.228595 163.228595 0 90.003873 73.223698 163.228595 163.228595 163.228595 60.882626 0 114.078175-33.510208 142.134161-83.049484L575.173808 700.16452c-7.925507 20.788465-12.280698 43.325761-12.280698 66.86385 0 103.803157 84.450391 188.254571 188.255595 188.254571 103.803157 0 188.254571-84.450391 188.254571-188.254571S854.951863 578.773799 751.148705 578.773799zM751.148705 116.89636c75.590606 0 137.089261 61.498656 137.089261 137.089261s-61.498656 137.089261-137.089261 137.089261c-75.591629 0-137.090285-61.498656-137.090285-137.089261S675.557076 116.89636 751.148705 116.89636zM238.105956 617.026008c-61.791321 0-112.063285-50.27094-112.063285-112.063285 0-61.791321 50.27094-112.063285 112.063285-112.063285s112.063285 50.27094 112.063285 112.063285C350.168218 566.755068 299.897278 617.026008 238.105956 617.026008zM751.148705 904.117632c-75.591629 0-137.090285-61.498656-137.090285-137.089261s61.498656-137.089261 137.090285-137.089261c75.590606 0 137.089261 61.498656 137.089261 137.089261S826.739311 904.117632 751.148705 904.117632z"  ></path></symbol><symbol id="icon-hj2" viewBox="0 0 1024 1024"><path d="M963.66 256.607c0-0.244 0-0.607-0.126-0.851 0-0.369 0-0.614-0.119-0.978 0-0.369-0.119-0.733-0.119-1.104 0-0.244 0-0.487-0.126-0.725 0-0.369-0.119-0.859-0.244-1.222 0-0.244-0.119-0.369-0.119-0.613-0.126-0.365-0.126-0.852-0.245-1.216 0-0.244-0.126-0.369-0.126-0.613-0.119-0.365-0.244-0.734-0.364-1.222-0.126-0.244-0.126-0.49-0.244-0.609l-0.369-1.095c-0.119-0.245-0.119-0.49-0.244-0.734-0.121-0.369-0.245-0.613-0.365-0.978-0.126-0.244-0.244-0.613-0.369-0.851-0.119-0.244-0.238-0.613-0.364-0.859-0.119-0.364-0.244-0.607-0.364-0.977l-0.371-0.734c-0.119-0.364-0.364-0.725-0.487-0.971-0.119-0.245-0.244-0.371-0.364-0.614-0.244-0.364-0.369-0.733-0.614-1.097-0.119-0.126-0.244-0.369-0.364-0.487l-0.733-1.097c-0.119-0.126-0.244-0.369-0.365-0.487-0.244-0.369-0.487-0.733-0.733-0.978-0.126-0.244-0.244-0.369-0.487-0.613-0.245-0.238-0.49-0.607-0.734-0.851-0.244-0.245-0.487-0.49-0.607-0.734-0.244-0.244-0.369-0.487-0.614-0.733-0.851-0.972-1.829-1.83-2.681-2.682-0.245-0.244-0.49-0.369-0.734-0.614-0.244-0.244-0.487-0.487-0.733-0.607-0.245-0.244-0.614-0.487-0.859-0.733-0.238-0.121-0.364-0.365-0.607-0.49-0.365-0.244-0.734-0.487-0.978-0.733-0.119-0.119-0.364-0.244-0.487-0.365l-1.097-0.733c-0.119-0.119-0.364-0.244-0.487-0.364-0.365-0.244-0.734-0.369-1.097-0.614-0.244-0.119-0.369-0.244-0.613-0.364-0.365-0.126-0.734-0.369-0.972-0.487l-0.734-0.369c-0.369-0.121-0.613-0.245-0.977-0.365-0.244-0.126-0.614-0.244-0.859-0.369-0.244-0.119-0.607-0.238-0.851-0.364-0.365-0.119-0.609-0.244-0.978-0.364-0.244-0.126-0.487-0.126-0.733-0.245l-1.097-0.369c-0.244-0.119-0.487-0.119-0.609-0.244-0.369-0.119-0.733-0.244-1.22-0.364-0.245 0-0.371-0.126-0.614-0.126-0.364-0.119-0.851-0.244-1.216-0.244-0.244 0-0.487-0.121-0.613-0.121-0.364-0.126-0.852-0.126-1.222-0.244-0.244 0-0.482-0.126-0.725-0.126-0.369 0-0.734-0.119-1.104-0.119-0.364 0-0.607 0-0.978-0.126-0.244 0-0.607 0-0.851-0.119h-242.407c-21.604 0-39.062 17.456-39.062 39.062 0 21.604 17.458 39.055 39.062 39.055h146.102l-3.171 3.177-217.27 217.265 0.369 0.369-49.676 49.676-155.87-155.87c-7.694-7.689-17.827-11.472-27.953-11.472-10.13-0.126-20.263 3.659-27.952 11.472l-282.446 282.322c-15.258 15.258-15.258 40.041 0 55.298 15.258 15.258 40.033 15.258 55.291 0l255.108-255.11 155.746 155.751c7.813 7.815 17.945 11.593 28.076 11.474 10.126 0.119 20.382-3.659 28.070-11.474l182.964-182.969c0.734-0.734 1.347-1.342 1.956-2.075l111.564-111.564v146.109c0 21.604 17.451 39.060 39.055 39.060s39.062-17.456 39.062-39.060v-235.085c0-0.244 0.126-0.49 0.126-0.614 0-0.244 0.119-0.487 0.119-0.733 0-0.364 0.119-0.734 0.119-1.097s0-0.607 0.126-0.977c0-0.245 0-0.609 0.119-0.852-0.122-1.466-0.122-2.807-0.122-4.030v0zM963.66 256.607z"  ></path></symbol><symbol id="icon-circleyuanquan" viewBox="0 0 1024 1024"><path d="M150.1184 150.1184C250.2656 50.0736 370.8928 0 512 0c141.1072 0 261.7344 50.0736 361.8816 150.1184C973.9264 250.2656 1024 370.8928 1024 512c0 141.2096-50.0736 261.8368-150.1184 361.8816C773.7344 973.9264 653.1072 1024 512 1024c-141.1072 0-261.7344-50.0736-361.8816-150.1184C50.0736 773.8368 0 653.2096 0 512 0 370.8928 50.0736 250.2656 150.1184 150.1184zM512 41.8816c-85.2992 0-164.1472 20.8896-236.3392 62.7712C203.4688 146.432 146.432 203.4688 104.6528 275.6608 62.7712 347.9552 41.8816 426.7008 41.8816 512c0 129.6384 45.9776 240.4352 137.8304 332.288C271.5648 936.2432 382.3616 982.1184 512 982.1184c129.6384 0 240.4352-45.8752 332.288-137.8304C936.2432 752.4352 982.1184 641.6384 982.1184 512c0-129.6384-45.9776-240.3328-137.8304-332.288C752.4352 87.7568 641.6384 41.8816 512 41.8816zM512 256c-36.1472 0-70.144 7.0656-102.1952 20.8896C377.856 290.9184 349.4912 309.3504 324.9152 332.288c-22.9376 24.576-41.472 52.9408-55.3984 84.8896S248.6272 483.328 248.6272 519.3728c0 36.1472 6.9632 70.144 20.8896 102.1952s32.4608 60.3136 55.3984 84.8896C349.4912 729.4976 377.856 747.9296 409.8048 761.856 441.856 775.7824 475.8528 782.7456 512 782.7456c36.1472 0 70.144-6.9632 102.1952-20.8896C646.144 747.9296 674.5088 729.4976 699.0848 706.4576c22.9376-24.576 41.472-52.9408 55.3984-84.8896s20.8896-66.048 20.8896-102.1952c0-36.0448-6.9632-70.144-20.8896-102.1952S722.0224 356.9664 699.0848 332.288C674.5088 309.3504 646.144 290.9184 614.1952 276.8896 582.144 263.0656 548.1472 256 512 256z"  ></path></symbol><symbol id="icon-bhjlink" viewBox="0 0 1024 1024"><path d="M901.920618 465.785468c-50.993571 0-94.522533 32.698367-110.688942 78.273953L702.244627 544.059421c1.764013-10.590222 2.890616-21.423121 2.890616-32.694527 0-72.177856-40.480145-134.923579-99.898281-166.857822l34.099901-112.776268c8.829281 2.126492 18.1347 3.327588 27.724265 3.327588 64.833817 0 117.472367-52.597848 117.472367-117.589097C784.532727 52.594008 731.894177 0 667.06036 0c-64.911381 0-117.509229 52.594008-117.509229 117.470063 0 49.305587 30.248562 91.349307 73.177745 108.842756l-33.419485 110.692013c-22.548956-9.588797-47.462473-14.807112-73.540224-14.807112-49.18732 0-93.841349 18.658451-127.540374 49.309426L213.348053 196.583401l-1.886119 2.008226c19.940183-21.103648 32.256788-49.588197 32.256788-81.003297 0-64.872983-52.517212-117.470063-117.470063-117.470063-64.913685 0-117.511533 52.59708-117.511533 117.470063 0 65.034255 52.59708 117.592169 117.511533 117.592169 31.412796 0 59.898881-12.358075 80.921125-32.335888l-6.179038 6.056931 174.960609 174.879973c-30.729308 33.66293-49.506025 78.47516-49.506025 127.661712 0 43.008283 14.401627 82.685138 38.593258 114.501114l-149.845117 120.999625c-21.503757-28.044506-55.285722-46.218372-93.357532-46.218372-64.874519 0-117.430897 52.719186-117.430897 117.592169 0 64.833049 52.556378 117.470063 117.430897 117.470063 64.872983 0 117.549163-52.637014 117.549163-117.470063 0-20.541499-5.335813-39.878062-14.602834-56.68956l151.369526-122.203792c34.584487 37.633303 84.29095 61.384123 139.618142 61.384123 28.082136 0 54.602234-6.057699 78.553492-17.091805l52.716114 119.514383c-35.585143 20.222026-59.497236 58.335306-59.497236 102.106945 0 64.912149 52.637014 117.549163 117.592169 117.549163 64.872983 0 117.388659-52.637014 117.388659-117.549163 0-64.833049-52.516444-117.513069-117.388659-117.513069-15.047485 0-29.248673 2.929782-42.446133 7.903885l-52.798286-120.034294c42.807844-24.554878 75.182898-65.518073 88.46253-114.221576l88.222926 0c-1.405374 7.018422-1.96522 14.241123-1.96522 21.743362 0 64.872983 52.557914 117.509997 117.387123 117.509997 64.995089 0 117.596009-52.637014 117.596009-117.509997C1019.508947 518.383316 966.994039 465.785468 901.920618 465.785468L901.920618 465.785468zM901.920618 465.785468"  ></path></symbol><symbol id="icon-lianjie_connecting5" viewBox="0 0 1024 1024"><path d="M801.25952 251.74016l-28.9792-28.99968-150.79424 150.8352-35.1232-35.10272-99.14368 99.16416 99.14368 99.16416 99.16416-99.16416-35.10272-35.1232zM487.19872 476.8768l-29.94176 29.94176-19.61984-19.61984-99.16416 99.16416 35.10272 35.1232-150.8352 150.79424 28.95872 28.95872 150.8352-150.79424 35.10272 35.10272 99.14368-99.14368-19.61984-19.64032 29.96224-29.96224-59.92448-59.92448z m-15.48288 44.4416l15.4624-15.4624 30.98624 30.98624-15.4624 15.44192-30.98624-30.96576z" fill="" ></path></symbol><symbol id="icon-xiazai" viewBox="0 0 1024 1024"><path d="M840.5 900.3h-657c-16.5 0-29.9 13.4-29.9 29.9s13.4 29.9 29.9 29.9h657.1c16.5 0 29.9-13.4 29.9-29.9-0.1-16.6-13.5-29.9-30-29.9zM631.5 123.7V541.8H763.1L512 769.9l-251.2-228h131.7V123.7h239m0-59.7h-239c-33 0-59.7 26.7-59.7 59.7v358.4H183.5c-26.6 0-39.9 32.2-21.1 51l328.5 298.2c5.8 5.8 13.5 8.7 21.1 8.7s15.3-2.9 21.1-8.7l328.5-298.2c18.8-18.8 5.5-51-21.1-51H691.2V123.7c0-33-26.7-59.7-59.7-59.7z"  ></path></symbol><symbol id="icon-ico_reset" viewBox="0 0 1024 1024"><path d="M925.97087933 277.33133334a479.997 479.997 0 1 0 54.33566 255.9984H916.05094133a415.9974 415.9974 0 1 1-64.191599-255.9984h74.047537z"  ></path><path d="M978.64255033 61.01268534L725.33213333 371.09074734h297.59814z"  ></path></symbol><symbol id="icon-fangda" viewBox="0 0 1024 1024"><path d="M768 448a320 320 0 1 0-320 320 320 320 0 0 0 320-320z m64 0A384 384 0 1 1 448 64a384 384 0 0 1 384 384z"  ></path><path d="M681.28 726.72a32 32 0 0 1 45.44-45.44l160 160a32 32 0 0 1-45.44 45.44zM320 480a32 32 0 0 1 0-64h256a32 32 0 0 1 0 64z"  ></path><path d="M480 576a32 32 0 0 1-64 0V320a32 32 0 0 1 64 0z"  ></path></symbol><symbol id="icon-zidong" viewBox="0 0 1024 1024"><path d="M131.3 363.3c-19.2 47.3-28.9 97.3-28.9 148.7 0 51.3 9.7 101.3 28.9 148.7 7 17.2 15.1 33.8 24.3 49.7l15.8-49.1 42.8 13.8-39.8 123.8-42.8-13.9-80.9-26 13.8-42.8 52.3 16.8c-98-168.4-74.8-387.9 69.4-532.1C342.4 44.7 586.9 30.5 759.1 158.3l-32.2 32.2c-25.1-18-52.1-32.9-80.9-44.6-47.3-19.2-97.3-28.9-148.7-28.9-51.3 0-101.3 9.7-148.7 28.9-49 19.9-92.9 49.1-130.6 86.8s-66.9 81.7-86.7 130.6z m828.3-60.2l13.8-42.8-80.9-26-42.8-13.8-39.8 123.8 42.8 13.8 15-46.7c9.8 16.6 18.4 34 25.8 52.1 19.2 47.3 28.9 97.3 28.9 148.7 0 51.3-9.7 101.3-28.9 148.7-19.9 49-49.1 92.9-86.8 130.6C768.9 829 725 858.2 676 878.1c-47.3 19.2-97.3 28.9-148.7 28.9-51.3 0-101.3-9.7-148.7-28.9-28.8-11.7-55.9-26.6-80.9-44.6l-32.2 32.2c126.3 93.7 382.6 147.7 572.9-42.6 145.8-145.8 167.9-368.6 66.1-537.7l55.1 17.7zM474 241.2L295 730.4h64.8l50.5-148.2h195.3l54 148.2h70.3L539.6 241.2H474z m-45.9 288.3L479.8 386c11-30.9 19.4-62.1 25.4-93.4 6.9 26 17.9 59.9 32.8 101.5l48.2 135.5H428.1z" fill="" ></path></symbol><symbol id="icon-quanping" viewBox="0 0 1024 1024"><path d="M795.5 192H581c-19.6 0-35.6 15.7-36 35.3-0.4 20.3 16.4 36.7 36.7 36.7h128.4L581 393.1c-14 14-14 36.9 0 50.9s36.9 14 50.9 0L760 315.9v129c0 19.6 15.8 35.6 35.3 36 20.2 0.4 36.7-16.4 36.7-36.7V228.5c0-20.1-16.3-36.5-36.5-36.5zM442.2 760H313.8L443 630.9c14-14 14-36.9 0-50.9s-36.9-14-50.9 0L264 708.1V579c0-19.6-15.8-35.6-35.3-36-20.2-0.4-36.7 16.4-36.7 36.7v215.6c0 20.3 16.4 36.7 36.7 36.7H443c19.6 0 35.6-15.7 36-35.3 0.3-20.3-16.5-36.7-36.8-36.7z"  ></path><path d="M838 136c27.6 0 50 22.4 50 50v652c0 27.6-22.4 50-50 50H186c-27.6 0-50-22.4-50-50V186c0-27.6 22.4-50 50-50h652m0-72H186c-16.4 0-32.4 3.2-47.5 9.6-14.5 6.1-27.6 14.9-38.8 26.1-11.2 11.2-20 24.2-26.1 38.8-6.4 15.1-9.6 31.1-9.6 47.5v652c0 16.4 3.2 32.4 9.6 47.5 6.1 14.5 14.9 27.6 26.1 38.8 11.2 11.2 24.2 20 38.8 26.1 15.1 6.4 31.1 9.6 47.5 9.6h652c16.4 0 32.4-3.2 47.5-9.6 14.5-6.1 27.6-14.9 38.8-26.1 11.2-11.2 20-24.2 26.1-38.8 6.4-15.1 9.6-31.1 9.6-47.5V186c0-16.4-3.2-32.4-9.6-47.5-6.1-14.5-14.9-27.6-26.1-38.8-11.2-11.2-24.2-20-38.8-26.1-15.1-6.4-31.1-9.6-47.5-9.6z"  ></path></symbol><symbol id="icon-lianjieliu" viewBox="0 0 1024 1024"><path d="M280.224 425.856h348.608a29.536 29.536 0 1 0 0-59.072H280.224c-52.448 0-93.152-34.304-93.152-73.856s40.704-73.856 93.152-73.856h140.128C432.096 258.816 468.448 288 512 288s79.904-29.184 91.648-68.928h178.08a29.536 29.536 0 1 0 0-59.072h-179.584C588.896 122.784 553.728 96 512 96s-76.896 26.784-90.112 64H280.224C197.184 160 128 218.272 128 292.928s69.184 132.928 152.224 132.928z"  ></path><path d="M895.936 415.2A96 96 0 1 0 800 512c30.656 0 57.632-14.624 75.2-36.992 10.56 12.064 16.832 26.56 16.832 41.92 0 39.552-40.704 73.856-93.152 73.856H306.016A95.584 95.584 0 0 0 224 544a95.68 95.68 0 0 0-95.232 88.352C89.888 656.224 64 695.424 64 740.928c0 74.656 69.184 132.928 152.224 132.928h241.728A95.808 95.808 0 0 0 544 928a96 96 0 1 0 0-192 95.904 95.904 0 0 0-94.272 78.752H216.224c-52.448 0-93.152-34.304-93.152-73.856 0-17.504 8.32-33.792 21.76-46.72A95.808 95.808 0 0 0 224 736a95.68 95.68 0 0 0 95.008-86.144h479.84c83.072 0 152.224-58.272 152.224-132.928 0.032-41.536-21.824-77.568-55.136-101.728z"  ></path></symbol><symbol id="icon-shuaxin" viewBox="0 0 1024 1024"><path d="M512 919.552c-224.768 0-407.552-182.784-407.552-407.552 0-8.704 0.512-17.408 1.024-26.112l71.68 4.608c-0.512 7.168-0.512 14.336-0.512 21.504 0 185.344 150.528 335.872 335.872 335.872 86.528 0 168.448-32.768 230.912-92.16l49.152 52.224C716.288 880.128 616.96 919.552 512 919.552zM919.552 512h-71.68c0-11.776-0.512-23.552-2.048-35.328-17.92-171.52-161.28-300.544-334.336-300.544-67.584 0-132.096 19.968-187.904 57.344L284.16 174.08c67.072-45.568 145.92-69.632 227.84-69.632 209.408 0 384 156.672 405.504 365.056 1.536 13.824 2.048 28.16 2.048 42.496z" fill="#707070" ></path><path d="M140.288 290.816L28.16 491.52c-3.072 5.12 1.024 11.776 6.656 11.776H258.56c6.144 0 9.728-6.144 6.656-11.776L153.6 290.816c-3.072-5.632-10.752-5.632-13.312 0zM870.4 675.84L758.272 475.136c-3.072-5.12 1.024-11.776 6.656-11.776h223.744c6.144 0 9.728 6.144 6.656 11.776L883.712 675.84c-2.56 5.12-10.24 5.12-13.312 0zM270.336 202.24a35.84 35.84 0 1 0 71.68 0 35.84 35.84 0 1 0-71.68 0zM728.576 784.896a35.84 35.84 0 1 0 71.68 0 35.84 35.84 0 1 0-71.68 0z" fill="#707070" ></path></symbol><symbol id="icon-resize-" viewBox="0 0 1024 1024"><path d="M410.816 673.514667L230.997333 853.333333H384v85.333334H85.333333V640h85.333334v153.002667l179.818666-179.84 60.330667 60.373333z m-53.632-256L170.666667 230.997333V384H85.333333V85.333333h298.666667v85.333334h-153.002667l186.517334 186.517333-60.330667 60.330667z m234.666667-45.696L793.002667 170.666667H640V85.333333h298.666667v298.666667h-85.333334v-153.002667l-201.152 201.173334-60.330666-60.373334z m67.029333 226.709333L853.333333 793.002667V640h85.333334v298.666667H640v-85.333334h153.002667l-194.474667-194.453333 60.352-60.352z"  ></path></symbol><symbol id="icon-guanxitu" viewBox="0 0 1024 1024"><path d="M209.003789 401.084632l29.749895-44.948211 107.843369 71.464421-29.749895 44.894316zM682.469053 546.600421l-14.551579-51.846737 124.496842-35.031579 14.551579 51.846737zM315.068632 812.840421l-40.367158-35.678316 85.692631-96.902737 40.421053 35.732211zM597.962105 390.251789l-46.672842-26.947368 43.11579-74.64421 46.672842 26.947368zM615.639579 728.764632l41.121684-34.816 83.536842 98.735157-41.121684 34.816z" fill="#444A5C" ></path><path d="M501.221053 765.305263c-118.568421 0-215.578947-97.010526-215.578948-215.578947s97.010526-215.578947 215.578948-215.578948 215.578947 97.010526 215.578947 215.578948-97.010526 215.578947-215.578947 215.578947z m0-377.263158c-91.621053 0-161.684211 70.063158-161.684211 161.684211s70.063158 161.684211 161.684211 161.68421 161.684211-70.063158 161.68421-161.68421-75.452632-161.684211-161.68421-161.684211zM167.073684 452.715789c-59.284211 0-107.789474-48.505263-107.789473-107.789473s48.505263-107.789474 107.789473-107.789474 107.789474 48.505263 107.789474 107.789474-48.505263 107.789474-107.789474 107.789473z m0-161.68421c-32.336842 0-53.894737 21.557895-53.894737 53.894737s21.557895 53.894737 53.894737 53.894737 53.894737-21.557895 53.894737-53.894737-26.947368-53.894737-53.894737-53.894737zM253.305263 948.547368c-59.284211 0-107.789474-48.505263-107.789474-107.789473s48.505263-107.789474 107.789474-107.789474 107.789474 48.505263 107.789474 107.789474-48.505263 107.789474-107.789474 107.789473z m0-161.68421c-32.336842 0-53.894737 21.557895-53.894737 53.894737s21.557895 53.894737 53.894737 53.894737 53.894737-21.557895 53.894737-53.894737-21.557895-53.894737-53.894737-53.894737zM856.926316 576.673684c-59.284211 0-107.789474-48.505263-107.789474-107.789473s48.505263-107.789474 107.789474-107.789474 107.789474 48.505263 107.789473 107.789474-48.505263 107.789474-107.789473 107.789473z m0-161.68421c-32.336842 0-53.894737 21.557895-53.894737 53.894737s21.557895 53.894737 53.894737 53.894736 53.894737-21.557895 53.894737-53.894736-21.557895-53.894737-53.894737-53.894737zM662.905263 350.315789C592.842105 350.315789 528.168421 291.031579 528.168421 215.578947s59.284211-134.736842 134.736842-134.736842 134.736842 59.284211 134.736842 134.736842-59.284211 134.736842-134.736842 134.736842z m0-215.578947c-43.115789 0-80.842105 37.726316-80.842105 80.842105s37.726316 80.842105 80.842105 80.842106 80.842105-37.726316 80.842105-80.842106-32.336842-80.842105-80.842105-80.842105zM749.136842 921.6c-43.115789 0-80.842105-37.726316-80.842105-80.842105s37.726316-80.842105 80.842105-80.842106 80.842105 37.726316 80.842105 80.842106-37.726316 80.842105-80.842105 80.842105z m0-107.789474c-16.168421 0-26.947368 10.778947-26.947368 26.947369s10.778947 26.947368 26.947368 26.947368 26.947368-10.778947 26.947369-26.947368-10.778947-26.947368-26.947369-26.947369z" fill="#444A5C" ></path></symbol><symbol id="icon-tupian" viewBox="0 0 1024 1024"><path d="M938.666667 553.92V768c0 64.8-52.533333 117.333333-117.333334 117.333333H202.666667c-64.8 0-117.333333-52.533333-117.333334-117.333333V256c0-64.8 52.533333-117.333333 117.333334-117.333333h618.666666c64.8 0 117.333333 52.533333 117.333334 117.333333v297.92z m-64-74.624V256a53.333333 53.333333 0 0 0-53.333334-53.333333H202.666667a53.333333 53.333333 0 0 0-53.333334 53.333333v344.48A290.090667 290.090667 0 0 1 192 597.333333a286.88 286.88 0 0 1 183.296 65.845334C427.029333 528.384 556.906667 437.333333 704 437.333333c65.706667 0 126.997333 16.778667 170.666667 41.962667z m0 82.24c-5.333333-8.32-21.130667-21.653333-43.648-32.917333C796.768 511.488 753.045333 501.333333 704 501.333333c-121.770667 0-229.130667 76.266667-270.432 188.693334-2.730667 7.445333-7.402667 20.32-13.994667 38.581333-7.68 21.301333-34.453333 28.106667-51.370666 13.056-16.437333-14.634667-28.554667-25.066667-36.138667-31.146667A222.890667 222.890667 0 0 0 192 661.333333c-14.464 0-28.725333 1.365333-42.666667 4.053334V768a53.333333 53.333333 0 0 0 53.333334 53.333333h618.666666a53.333333 53.333333 0 0 0 53.333334-53.333333V561.525333zM320 480a96 96 0 1 1 0-192 96 96 0 0 1 0 192z m0-64a32 32 0 1 0 0-64 32 32 0 0 0 0 64z"  ></path></symbol><symbol id="icon-juhejiedian" viewBox="0 0 1024 1024"><path d="M533.333333 725.333333a64 64 0 1 1-64 64 64 64 0 0 1 64-64m0-85.333333a149.333333 149.333333 0 1 0 149.333334 149.333333 149.333333 149.333333 0 0 0-149.333334-149.333333z" fill="#666666" ></path><path d="M533.333333 277.333333m-106.666666 0a106.666667 106.666667 0 1 0 213.333333 0 106.666667 106.666667 0 1 0-213.333333 0Z" fill="#666666" ></path><path d="M277.333333 320m-106.666666 0a106.666667 106.666667 0 1 0 213.333333 0 106.666667 106.666667 0 1 0-213.333333 0Z" fill="#666666" ></path><path d="M789.333333 320m-106.666666 0a106.666667 106.666667 0 1 0 213.333333 0 106.666667 106.666667 0 1 0-213.333333 0Z" fill="#666666" ></path><path d="M512 341.333333h42.666667v384h-42.666667z" fill="#666666" ></path><path d="M741.290667 357.504l30.165333 30.165333-225.066667 225.066667-30.165333-30.165333z" fill="#666666" ></path><path d="M558.08 582.016l-30.165333 30.165333-228.693334-228.693333 30.165334-30.165333z" fill="#666666" ></path></symbol><symbol id="icon-ziyuan" viewBox="0 0 1024 1024"><path d="M236.615854 752.86913h-0.484162A241.500139 241.500139 0 0 1 0.538332 527.733676a238.78883 238.78883 0 0 1 64.684079-180.011531 242.081134 242.081134 0 0 1 149.025146-74.367324 298.534454 298.534454 0 0 1 596.003751 25.951097V300.95207a221.262156 221.262156 0 0 1 213.031398 233.075715 222.714643 222.714643 0 0 1-221.262156 209.1581h-3.098639a27.500417 27.500417 0 0 1 0-54.904001h2.711309A167.520145 167.520145 0 0 0 968.378705 531.219644a166.261323 166.261323 0 0 0-166.16449-175.363573 151.058627 151.058627 0 0 0-18.204502 1.065157 27.500417 27.500417 0 0 1-30.211725-30.308558 240.822312 240.822312 0 0 0 1.549319-27.306752 243.727285 243.727285 0 0 0-487.357738 0 27.500417 27.500417 0 0 1-27.403584 27.500417 185.627813 185.627813 0 0 0-185.240484 197.538205A186.30564 186.30564 0 0 0 237.100016 697.965129a27.500417 27.500417 0 0 1-0.484162 54.904001z"  ></path><path d="M513.266174 1021.869686a27.500417 27.500417 0 0 1-27.500417-27.403584v-484.162268a27.500417 27.500417 0 1 1 54.904001 0v484.162268a27.403584 27.403584 0 0 1-27.403584 27.403584z"  ></path><path d="M513.266174 1024a27.500417 27.500417 0 0 1-19.366491-8.037094L342.260061 864.129619a27.500417 27.500417 0 1 1 38.732981-38.732981L513.266174 957.766602l130.530147-130.336483a27.500417 27.500417 0 0 1 38.732981 38.732982L532.632664 1015.962906a27.403584 27.403584 0 0 1-19.36649 8.037094z"  ></path></symbol><symbol id="icon-add-select" viewBox="0 0 1024 1024"><path d="M544 213.333333v266.666667H810.666667v64H544V810.666667h-64V544H213.333333v-64h266.666667V213.333333z"  ></path></symbol><symbol id="icon-sami-select" viewBox="0 0 1024 1024"><path d="M810.666667 480v64H213.333333v-64z"  ></path></symbol><symbol id="icon-icon_shuaxin" viewBox="0 0 1024 1024"><path d="M512 938.666667c-55.371852 0-109.226667-10.903704-159.857778-32.237037-48.924444-20.66963-92.823704-50.251852-130.465185-87.988149-37.736296-37.736296-67.318519-81.635556-87.988148-130.465185-21.428148-50.631111-32.237037-104.391111-32.237037-159.857777s10.903704-109.226667 32.237037-159.857778c20.66963-48.924444 50.251852-92.823704 87.988148-130.465185 37.736296-37.736296 81.635556-67.318519 130.465185-87.988149 50.631111-21.428148 104.391111-32.237037 159.857778-32.237037 63.81037 0 125.060741 14.222222 181.854815 42.382223 54.139259 26.832593 102.684444 66.085926 140.325926 113.682963 7.300741 9.197037 5.783704 22.660741-3.508148 29.961481-9.197037 7.300741-22.660741 5.783704-29.961482-3.508148-70.257778-88.936296-175.502222-139.946667-288.711111-139.946667-202.808889 0-367.881481 165.072593-367.881481 367.881482s165.072593 367.881481 367.881481 367.881481 367.881481-165.072593 367.881481-367.881481c0-11.757037 9.576296-21.333333 21.333334-21.333334S922.548148 516.361481 922.548148 528.118519c0 55.371852-10.903704 109.226667-32.237037 159.857777-20.66963 48.924444-50.251852 92.823704-87.988148 130.465185-37.736296 37.736296-81.635556 67.318519-130.465185 87.988149-50.631111 21.428148-104.485926 32.237037-159.857778 32.237037z"  ></path><path d="M817.398519 308.242963c-11.757037 0-21.333333-9.576296-21.333334-21.333333V106.666667c0-11.757037 9.576296-21.333333 21.333334-21.333334s21.333333 9.576296 21.333333 21.333334v180.242963c0 11.757037-9.481481 21.333333-21.333333 21.333333z"  ></path><path d="M817.398519 308.242963H637.155556c-11.757037 0-21.333333-9.576296-21.333334-21.333333s9.576296-21.333333 21.333334-21.333334h180.242963c11.757037 0 21.333333 9.576296 21.333333 21.333334s-9.481481 21.333333-21.333333 21.333333z"  ></path></symbol><symbol id="icon-lianjiezhong" viewBox="0 0 1024 1024"><path d="M883.396923 298.141538a99.721846 99.721846 0 0 1-142.414769 0 103.187692 103.187692 0 0 1 0-144.423384 99.721846 99.721846 0 0 1 142.414769 0 103.187692 103.187692 0 0 1 0 144.423384zM285.144615 760.438154a87.276308 87.276308 0 0 0-124.652307 0 90.269538 90.269538 0 0 0 0 126.385231c34.422154 34.894769 90.230154 34.894769 124.652307 0a90.269538 90.269538 0 0 0 0-126.424616z m482.579693 108.307692a64.472615 64.472615 0 0 1 0-90.269538 62.345846 62.345846 0 0 1 89.00923 0c24.576 24.930462 24.576 65.378462 0 90.269538a62.345846 62.345846 0 0 1-89.00923 0zM294.006154 298.141538a103.187692 103.187692 0 0 0 0-144.423384 99.721846 99.721846 0 0 0-142.454154 0 103.187692 103.187692 0 0 0 0 144.423384 99.721846 99.721846 0 0 0 142.454154 0z m324.214154-196.01723c0 56.438154-45.095385 102.163692-100.745846 102.163692-55.611077 0-100.706462-45.725538-100.706462-102.163692C416.768 45.725538 461.863385 0 517.474462 0c55.650462 0 100.745846 45.725538 100.745846 102.124308zM517.474462 870.793846c-41.747692 0-75.539692 34.264615-75.539693 76.603077 0 42.299077 33.831385 76.603077 75.539693 76.603077 41.747692 0 75.539692-34.264615 75.539692-76.603077 0-42.299077-33.792-76.603077-75.539692-76.603077z m416.768-294.990769c-27.805538 0-50.333538-22.843077-50.333539-51.042462 0-28.199385 22.528-51.042462 50.333539-51.042461 27.844923 0 50.412308 22.843077 50.372923 51.042461 0 28.199385-22.567385 51.081846-50.372923 51.081847zM201.452308 524.8c0-56.398769-45.095385-102.124308-100.745846-102.124308C45.095385 422.596923 0 468.283077 0 524.760615c0 56.398769 45.095385 102.124308 100.706462 102.124308 55.650462 0 100.745846-45.686154 100.745846-102.124308z"  ></path></symbol><symbol id="icon-loading" viewBox="0 0 1024 1024"><path d="M563.2 819.2a102.4 102.4 0 1 1 0 204.8 102.4 102.4 0 0 1 0-204.8z m-320.4608-153.6a128 128 0 1 1 0 256 128 128 0 0 1 0-256z m592.7936 25.6a102.4 102.4 0 1 1 0 204.8 102.4 102.4 0 0 1 0-204.8zM947.2 477.1328a76.8 76.8 0 1 1 0 153.6 76.8 76.8 0 0 1 0-153.6zM128 307.2a128 128 0 1 1 0 256 128 128 0 0 1 0-256z m782.6432-40.6016a51.2 51.2 0 1 1 0 102.4 51.2 51.2 0 0 1 0-102.4zM409.6 0a153.6 153.6 0 1 1 0 307.2 153.6 153.6 0 0 1 0-307.2z m384 153.6a25.6 25.6 0 1 1 0 51.2 25.6 25.6 0 0 1 0-51.2z" fill="#555555" ></path></symbol><symbol id="icon-tupushujuyuan" viewBox="0 0 1024 1024"><path d="M851.456 588.288c-13.312 0-25.6 2.048-37.888 5.12l-90.112-155.648 55.296-31.744c18.944 17.92 44.032 29.184 72.192 29.184 57.344 0 103.936-46.592 103.936-103.936s-46.592-103.936-103.936-103.936c-57.344 0-103.936 46.592-103.936 103.936 0 5.12 0.512 10.24 1.536 15.36l-58.368 33.792-82.944-143.872c26.112-25.088 41.984-59.904 41.984-98.816 0-75.776-61.44-137.216-137.216-137.216s-137.216 61.44-137.216 137.216c0 38.912 15.872 73.728 41.984 98.816l-84.992 146.944-56.832-32.768c1.024-6.144 2.048-12.8 2.048-19.456 0-57.344-46.592-103.936-103.936-103.936-57.344 0-103.936 46.592-103.936 103.936s46.592 103.936 103.936 103.936c26.624 0 51.2-10.24 69.12-26.624l56.32 32.768-88.064 152.576c-11.776-3.584-24.576-5.12-37.888-5.12-75.776 0-137.216 61.44-137.216 137.216s61.44 137.216 137.216 137.216c64.512 0 118.272-44.544 133.12-103.936h173.056v61.44c-40.96 13.824-70.656 52.736-70.656 98.816 0 57.344 46.592 103.936 103.936 103.936s103.936-46.592 103.936-103.936c0-46.08-29.696-84.48-70.656-98.816v-61.44h173.056c14.848 59.904 69.12 103.936 133.12 103.936 75.776 0 137.216-61.44 137.216-137.216s-61.44-137.728-137.216-137.728z m-410.112-450.048c0-38.912 31.744-70.656 70.656-70.656s70.656 31.744 70.656 70.656c0 13.824-4.096 26.624-10.752 37.376-12.288 19.456-33.28 32.256-57.856 33.28h-5.12c-24.576-1.024-45.568-13.824-57.856-33.28-6.144-10.752-9.728-24.064-9.728-37.376z m32.768 132.096c11.776 3.584 24.576 5.12 37.888 5.12s25.6-2.048 37.888-5.12l82.944 143.872-124.416 72.192-118.784-68.608 84.48-147.456z m-301.568 526.336c-38.912 0-70.656-31.744-70.656-70.656 0-38.912 31.744-70.656 70.656-70.656h2.56c24.576 1.024 45.568 13.824 57.856 33.28 1.024 1.536 1.536 2.56 2.56 4.096 5.12 9.728 8.192 20.992 8.192 33.28 0 11.776-3.072 23.552-8.192 33.28-12.288 22.016-35.84 37.376-62.976 37.376z m133.12-103.936c-6.144-25.6-19.456-48.128-37.888-65.536l88.064-152.576 122.88 70.656v146.944h-173.056z m239.616-151.552l120.832-69.632 90.112 155.648c-18.432 17.408-31.744 39.936-37.888 65.536h-173.056v-151.552z m306.176 255.488c-27.136 0-50.688-15.36-62.464-37.376-5.12-9.728-8.192-21.504-8.192-33.28 0-12.288 3.072-23.552 8.192-33.28 0.512-1.536 1.536-3.072 2.56-4.096 12.288-19.456 33.28-32.768 57.856-33.28h2.56c38.912 0 70.656 31.744 70.656 70.656-0.512 38.912-32.256 70.656-71.168 70.656z"  ></path></symbol><symbol id="icon-jiedian" viewBox="0 0 1024 1024"><path d="M882.1914 744.849921c-60.501005 0-112.097749 38.645092-131.425292 92.560342H244.912146c-80.468136 0-145.955927-62.61964-145.955926-139.570043 0-77.000371 65.487791-139.570043 145.955926-139.570043h136.312143c19.497433 53.585462 70.934281 91.950735 131.205434 91.950735 60.241173 0 111.688014-38.375266 131.205434-91.950735h136.452052C914.210763 558.280171 1023.340425 453.92743 1023.340425 325.660102S914.210763 93.040033 780.077216 93.040033H273.093982c-19.197627-54.165089-70.944274-93.040033-131.595182-93.040033C64.508422 0 1.928757 62.569672 1.928757 139.560049c0 76.950403 62.579665 139.570043 139.570043 139.570043 60.640915 0 112.377569-38.894931 131.585189-93.040033h506.993227c80.468136 0 145.955927 62.61964 145.955927 139.570043 0 77.000371-65.487791 139.570043-145.955927 139.570043H644.414655c-18.887826-54.734722-70.924287-94.139324-131.974938-94.139325-61.090625 0-113.097105 39.394609-131.974938 94.139325H244.912146c-134.133547 0-243.263209 104.352741-243.263209 232.620069 0 128.267328 109.129663 232.620069 243.263209 232.620069h505.524174c19.057717 54.394941 70.9043 93.529717 131.75508 93.529717 76.950403 0 139.570043-62.61964 139.570043-139.570043 0.009994-77.000371-62.61964-139.580036-139.570043-139.580036zM141.428845 207.036558c-37.166045 0-67.376574-30.230515-67.376574-67.376573 0-37.166045 30.210528-67.376574 67.376574-67.376574 37.146058 0 67.376574 30.210528 67.376573 67.376574 0 37.146058-30.230515 67.376574-67.376573 67.376573z m371.000878 236.257725c37.146058 0 67.376574 30.210528 67.376574 67.376574 0 37.146058-30.230515 67.376574-67.376574 67.376573-37.166045 0-67.376574-30.230515-67.376574-67.376573 0.009994-37.176039 30.210528-67.376574 67.376574-67.376574z m369.761677 508.502254c-37.166045 0-67.376574-30.230515-67.376574-67.376573 0-37.166045 30.210528-67.376574 67.376574-67.376574 37.146058 0 67.376574 30.210528 67.376574 67.376574 0 37.146058-30.230515 67.376574-67.376574 67.376573z"  ></path></symbol><symbol id="icon-shitujiedianxianshi" viewBox="0 0 1367 1024"><path d="M1235.403267 512.03593a130.596433 130.596433 0 0 0-42.68749 7.796802l-193.295715-290.430872A149.113837 149.113837 0 1 0 724.647767 149.48464a151.777744 151.777744 0 0 0 37.229729 97.849864l-194.920048 357.873209a220.519548 220.519548 0 0 0-55.162374-8.511508 207.914718 207.914718 0 0 0-114.807909 34.046035L240.401393 443.683967a126.763005 126.763005 0 0 0-75.564005-182.380192 127.737605 127.737605 0 1 0 12.99467 239.816633l157.625345 188.422713A213.307506 213.307506 0 1 0 643.23616 643.282096l190.956674-350.856087a164.187654 164.187654 0 0 0 39.56877 6.172468 143.591102 143.591102 0 0 0 60.555162-12.99467l192.516034 288.026859a121.760057 121.760057 0 0 0-18.582377 64.973349 128.127445 128.127445 0 1 0 127.152844-126.568085zM129.621832 448.362048a68.157044 68.157044 0 1 1 68.157044-68.092071A68.157044 68.157044 0 0 1 129.621832 448.362048z m528.948039 365.670011a145.86517 145.86517 0 1 1-145.86517-145.86517 145.86517 145.86517 0 0 1 145.86517 145.86517z m215.12676-577.937944a87.389155 87.389155 0 1 1 87.389155-87.389155 87.389155 87.389155 0 0 1-87.389155 87.389155z m365.085251 474.305451a68.157044 68.157044 0 1 1 68.222017-68.416937 68.157044 68.157044 0 0 1-68.222017 68.157044z"  ></path></symbol><symbol id="icon-shituxianshiquanbujiedian" viewBox="0 0 1367 1024"><path d="M1235.403267 512.03593a130.596433 130.596433 0 0 0-42.68749 7.796802l-193.295715-290.430872A149.113837 149.113837 0 1 0 724.647767 149.48464a151.777744 151.777744 0 0 0 37.229729 97.849864l-194.920048 357.873209a220.519548 220.519548 0 0 0-55.162374-8.511508 207.914718 207.914718 0 0 0-114.807909 34.046035L240.401393 443.683967a126.763005 126.763005 0 0 0-75.564005-182.380192 127.737605 127.737605 0 1 0 12.99467 239.816633l157.625345 188.422713A213.307506 213.307506 0 1 0 643.23616 643.282096l190.956674-350.856087a164.187654 164.187654 0 0 0 39.56877 6.172468 143.591102 143.591102 0 0 0 60.555162-12.99467l192.516034 288.026859a121.760057 121.760057 0 0 0-18.582377 64.973349 128.127445 128.127445 0 1 0 127.152844-126.568085zM129.621832 448.362048a68.157044 68.157044 0 1 1 68.157044-68.092071A68.157044 68.157044 0 0 1 129.621832 448.362048z m528.948039 365.670011a145.86517 145.86517 0 1 1-145.86517-145.86517 145.86517 145.86517 0 0 1 145.86517 145.86517z m215.12676-577.937944a87.389155 87.389155 0 1 1 87.389155-87.389155 87.389155 87.389155 0 0 1-87.389155 87.389155z m365.085251 474.305451a68.157044 68.157044 0 1 1 68.222017-68.416937 68.157044 68.157044 0 0 1-68.222017 68.157044z"  ></path></symbol><symbol id="icon-suoxiao" viewBox="0 0 1024 1024"><path d="M768 448a320 320 0 1 0-320 320 320 320 0 0 0 320-320z m64 0A384 384 0 1 1 448 64a384 384 0 0 1 384 384z"  ></path><path d="M681.28 726.72a32 32 0 0 1 45.44-45.44l160 160a32 32 0 0 1-45.44 45.44zM288 480a32 32 0 0 1 0-64h320a32 32 0 0 1 0 64z"  ></path></symbol><symbol id="icon-lianjie" viewBox="0 0 1024 1024"><path d="M922.243 97.755c11.49 11.489 11.673 30.002 0.547 41.713l-0.547 0.562-109.119 109.1c57.22 78.348 42.673 195.388-35.778 273.839l-92.83 92.585c-11.572 11.54-30.264 11.653-41.97 0.253l-45.746-44.55-18.089 18.086a29.891 29.891 0 0 1-7.171 5.3l48.764 47.489c11.947 11.638 12.06 30.804 0.248 42.585l-95.875 95.629c-77.416 77.417-192.412 92.603-270.72 38.004L144.04 928.245c-11.676 11.673-30.606 11.673-42.282 0-11.49-11.489-11.673-30.002-0.547-41.713l0.547-0.562 109.677-109.657c-55.981-78.335-41.131-194.413 36.833-272.377l92.831-92.585c11.571-11.54 30.263-11.653 41.969-0.254l42.587 41.474a29.935 29.935 0 0 1 3.678-4.741l0.548-0.562 19.54-19.538-44.11-42.957c-11.828-11.522-12.057-30.422-0.6-42.23l0.351-0.355 95.875-95.63c76.927-76.926 190.96-92.408 269.23-39.03L879.961 97.755c11.676-11.673 30.606-11.673 42.282 0zM362.451 474.49l-71.916 71.727-1.884 1.911c-61.822 63.545-67.916 156.289-16.185 208.02C324.72 808.4 418.82 801.655 482.43 738.044l74.422-74.234-194.401-189.32z m129.807-5.04l-20.096 20.094a30.035 30.035 0 0 1-4.643 3.8l63.25 61.595a29.82 29.82 0 0 1 5.113-7.308l0.547-0.561 17.532-17.531-61.703-60.089z m260.889-198.691c-52.254-52.254-146.353-45.509-209.964 18.102l-74.422 74.234 194.4 189.322 71.939-71.75 1.862-1.888c61.822-63.545 67.916-156.29 16.185-208.02z" fill="#333333" ></path></symbol><symbol id="icon-xiantiao" viewBox="0 0 1024 1024"><path d="M827.076923 157.538462a39.384615 39.384615 0 1 1-14.375385 76.051692L233.590154 812.701538a39.384615 39.384615 0 1 1-22.291692-22.291692L790.409846 211.298462A39.384615 39.384615 0 0 1 827.076923 157.538462z" fill="#333333" ></path></symbol></svg>', r = (r = document.getElementsByTagName("script"))[r.length - 1].getAttribute("data-injectcss");
  if (r && !n.__iconfont__svg__cssinject__) {
    n.__iconfont__svg__cssinject__ = !0;
    try {
      document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>");
    } catch (h) {
      console && console.log(h);
    }
  }
  function l() {
    s || (s = !0, t());
  }
  i = function() {
    var h, u, f, v;
    (v = document.createElement("div")).innerHTML = c, c = null, (f = v.getElementsByTagName("svg")[0]) && (f.setAttribute("aria-hidden", "true"), f.style.position = "absolute", f.style.width = 0, f.style.height = 0, f.style.overflow = "hidden", h = f, (u = document.body).firstChild ? (v = h, (f = u.firstChild).parentNode.insertBefore(v, f)) : u.appendChild(h));
  }, document.addEventListener ? ~["complete", "loaded", "interactive"].indexOf(document.readyState) ? setTimeout(i, 0) : (e = function() {
    document.removeEventListener("DOMContentLoaded", e, !1), i();
  }, document.addEventListener("DOMContentLoaded", e, !1)) : document.attachEvent && (t = i, o = n.document, s = !1, (a = function() {
    try {
      o.documentElement.doScroll("left");
    } catch {
      return void setTimeout(a, 50);
    }
    l();
  })(), o.onreadystatechange = function() {
    o.readyState == "complete" && (o.onreadystatechange = null, l());
  });
})(window);
const pt = (n) => ({
  onNodeClick: n.onNodeClick,
  onNodeExpand: n.onNodeExpand,
  onNodeCollapse: n.onNodeCollapse,
  onLineClick: n.onLineClick,
  onImageDownload: n.onImageDownload,
  onNodeDragEnd: n.onNodeDragEnd,
  onCanvasDragEnd: n.onCanvasDragEnd,
  beforeChangeLayout: n.beforeChangeLayout,
  onContextmenu: n.onContextmenu,
  onCanvasClick: n.onCanvasClick,
  onCanvasSelectionEnd: n.onCanvasSelectionEnd,
  onImageSaveAsFile: n.onImageSaveAsFile
}), ko = () => {
  const n = G(ne), i = G(we), e = n.options, [t, o] = yt(!1), s = () => {
    o(!t);
  }, a = () => {
    n.printOptions();
  }, c = () => {
    n.getGraphJsonData();
  }, r = () => {
    n.enableDebugLog(!e.debug), p("debugLog:", e.debug), i();
  };
  return /* @__PURE__ */ F("div", { children: [
    /* @__PURE__ */ m("div", { className: "c-setting-panel-button", onClick: () => {
      s();
    }, children: "Debug" }),
    t && /* @__PURE__ */ F("div", { className: "c-setting-panel", children: [
      /* @__PURE__ */ m("div", { className: "c-debug-tools-row", children: /* @__PURE__ */ m("button", { onClick: () => {
        a();
      }, children: "print options in console" }) }),
      /* @__PURE__ */ m("div", { className: "c-debug-tools-row", children: /* @__PURE__ */ m("button", { onClick: () => {
        c();
      }, children: "print json data in console" }) }),
      /* @__PURE__ */ F("div", { className: "c-debug-tools-row", children: [
        "debug log status: ",
        e.debug ? "true" : "false",
        /* @__PURE__ */ F("button", { onClick: () => {
          r();
        }, children: [
          e.debug ? "disable" : "enable",
          " debug log"
        ] })
      ] })
    ] })
  ] });
}, Eo = () => {
  const n = G(ne), i = G(we), e = async () => {
    await n.refresh(), i();
  }, t = () => {
    n.toggleAutoLayout();
  }, o = () => {
    n.fullscreen(), i();
  }, s = () => {
    n.downloadAsImage("png");
  }, a = async () => {
    const l = n;
    await l.setZoom(100), await l.moveToCenter(), await l.zoomToFit(), i();
  }, c = (l) => {
    n.zoom(l), i();
  }, r = n && n.options;
  return /* @__PURE__ */ F(
    "div",
    {
      className: [
        "rel-toolbar",
        "rel-toolbar-h-" + r.toolBarPositionH,
        "rel-toolbar-v-" + r.toolBarPositionV,
        "rel-toolbar-" + r.toolBarDirection
      ].join(" "),
      children: [
        r.allowShowFullscreenMenu && /* @__PURE__ */ m("div", { title: "\u5168\u5C4F/\u9000\u51FA\u5168\u5C4F", className: "c-mb-button", onClick: () => {
          o();
        }, children: /* @__PURE__ */ m("svg", { className: "rg-icon", "aria-hidden": "true", children: /* @__PURE__ */ m("use", { xlinkHref: "#icon-resize-" }) }) }),
        r.allowShowZoomMenu && /* @__PURE__ */ F(ke.Fragment, { children: [
          /* @__PURE__ */ m("div", { title: "\u653E\u5927", className: "c-mb-button", onClick: () => {
            c(20);
          }, children: /* @__PURE__ */ m("svg", { className: "rg-icon", "aria-hidden": "true", children: /* @__PURE__ */ m("use", { xlinkHref: "#icon-fangda" }) }) }),
          /* @__PURE__ */ F("div", { className: "c-current-zoom", onDoubleClick: () => {
            a();
          }, children: [
            r.canvasZoom,
            "%"
          ] }),
          /* @__PURE__ */ m("div", { title: "\u7F29\u5C0F", className: "c-mb-button", onClick: () => {
            c(-20);
          }, children: /* @__PURE__ */ m("svg", { className: "rg-icon", "aria-hidden": "true", children: /* @__PURE__ */ m("use", { xlinkHref: "#icon-suoxiao" }) }) })
        ] }),
        r.allowAutoLayoutIfSupport && r.isNeedShowAutoLayoutButton && /* @__PURE__ */ m(
          "div",
          {
            title: "options.autoLayouting?'\u70B9\u51FB\u505C\u6B62\u81EA\u52A8\u5E03\u5C40':'\u70B9\u51FB\u5F00\u59CB\u81EA\u52A8\u8C03\u6574\u5E03\u5C40'",
            className: [
              "c-mb-button",
              r.autoLayouting && "c-mb-button-on"
            ].join(" "),
            onClick: () => {
              t();
            },
            children: r.autoLayouting ? /* @__PURE__ */ m("svg", { className: "c-loading-icon rg-icon", "aria-hidden": "true", children: /* @__PURE__ */ m("use", { xlinkHref: "#icon-lianjiezhong" }) }) : /* @__PURE__ */ m("svg", { className: "rg-icon", "aria-hidden": "true", children: /* @__PURE__ */ m("use", { xlinkHref: "#icon-zidong" }) })
          }
        ),
        r.allowShowRefreshButton && /* @__PURE__ */ m("div", { title: "\u5237\u65B0", className: "c-mb-button", onClick: () => {
          e();
        }, children: /* @__PURE__ */ m("svg", { className: "rg-icon", "aria-hidden": "true", children: /* @__PURE__ */ m("use", { xlinkHref: "#icon-ico_reset" }) }) }),
        r.allowShowDownloadButton && /* @__PURE__ */ m("div", { title: "\u4E0B\u8F7D\u56FE\u7247", className: "c-mb-button", onClick: () => {
          s();
        }, children: /* @__PURE__ */ m("svg", { className: "rg-icon", "aria-hidden": "true", children: /* @__PURE__ */ m("use", { xlinkHref: "#icon-tupian" }) }) }),
        /* @__PURE__ */ m("div", { style: { clear: "both" } })
      ]
    }
  );
}, Mo = () => /* @__PURE__ */ m("div", { className: "h-full bg-white", children: "not support" }), Oo = ({ expandButtonClass: n, expandOrCollapseNode: i, expandHolderPosition: e, color: t }) => /* @__PURE__ */ m(
  "div",
  {
    className: `c-expand-positon-${e} c-btn-open-close`,
    children: /* @__PURE__ */ m(
      "span",
      {
        className: n,
        style: { backgroundColor: t },
        onClickCapture: (o) => {
          i(o);
        },
        onTouchEnd: (o) => {
          i(o);
        }
      }
    )
  }
), Lt = ({ nodeProps: n, NodeSlot: i, ExpandHolderSlot: e }) => {
  var S;
  const t = G(ne), o = G(we), s = Gt((k) => {
    k !== null && a(k);
  }, []), a = (k) => {
    if (k.offsetWidth === 0 && k.offsetHeight === 0)
      return;
    const D = k.offsetWidth, I = k.offsetHeight;
    (n.el.offsetWidth !== D || n.el.offsetHeight !== I) && (t.updateNodeOffsetSize(n, D, I), o());
  }, c = async (k) => {
    await t.expandOrCollapseNode(n, k);
  }, r = (k) => {
    t.onNodeDragStart(n, k);
  }, l = (k) => {
    t.onNodeClick(n, k);
  }, h = t.options, u = n.width || h.defaultNodeWidth, f = n.height || h.defaultNodeHeight, v = `${n.borderColor || h.defaultNodeBorderColor} solid ${n.borderWidth === void 0 ? h.defaultNodeBorderWidth : n.borderWidth}px`, y = !(h.hideNodeContentByZoom === !0 && h.canvasZoom < 40), C = n.opacity === void 0 ? 1 : n.opacity > 1 ? n.opacity / 100 : n.opacity, b = x.isAllowShowNode(n), z = n.expandHolderPosition && n.expandHolderPosition !== "hide" || h.defaultExpandHolderPosition && h.defaultExpandHolderPosition !== "hide" && n.lot.childs && n.lot.childs.length > 0, B = n.expanded === !1 ? "c-expanded" : "c-collapsed";
  return /* @__PURE__ */ F(
    "div",
    {
      ref: s,
      style: {
        display: b ? void 0 : "none",
        left: n.x + "px",
        top: n.y + "px",
        opacity: C
      },
      className: `rel-node-peel ${n.selected ? "rel-node-selected" : ""} ${n.id === h.checkedNodeId ? "rel-node-peel-checked" : ""} ${(S = n.className) != null ? S : n.className}`,
      "data-id": n.id,
      children: [
        z && (e ? /* @__PURE__ */ m(
          e,
          {
            nodeProps: n,
            expandButtonClass: B,
            expandOrCollapseNode: (k) => {
              c(k);
            },
            expandHolderPosition: n.expandHolderPosition || h.defaultExpandHolderPosition,
            color: h.defaultExpandHolderColor || n.color || h.defaultNodeColor
          }
        ) : /* @__PURE__ */ m(
          Oo,
          {
            nodeProps: n,
            expandButtonClass: B,
            expandOrCollapseNode: (k) => {
              c(k);
            },
            expandHolderPosition: n.expandHolderPosition || h.defaultExpandHolderPosition,
            color: h.defaultExpandHolderColor || n.color || h.defaultNodeColor
          }
        )),
        n.html ? /* @__PURE__ */ m(
          "div",
          {
            onClickCapture: (k) => {
              l(k);
            },
            onMouseDownCapture: (k) => {
              r(k);
            },
            onTouchStartCapture: (k) => {
              r(k);
            },
            dangerouslySetInnerHTML: { __html: n.html }
          }
        ) : /* @__PURE__ */ m(
          "div",
          {
            className: `rel-node-shape-${n.nodeShape === void 0 ? h.defaultNodeShape : n.nodeShape} rel-node-type-${n.type} ${n.id === h.checkedNodeId ? "rel-node-checked" : ""} ${n.flashing ? "rel-node-flashing" : ""} ${n.styleClass} ${n.innerHTML ? "rel-diy-node" : ""}`,
            style: {
              backgroundColor: n.color === void 0 ? h.defaultNodeColor : n.color,
              color: n.fontColor === void 0 ? h.defaultNodeFontColor : n.fontColor,
              border: v,
              width: u && `${u}px`,
              height: f && `${f}px`
            },
            onClickCapture: (k) => {
              l(k);
            },
            onMouseDownCapture: (k) => {
              r(k);
            },
            onTouchStartCapture: (k) => {
              r(k);
            },
            children: y && /* @__PURE__ */ m(Ae, { children: i ? /* @__PURE__ */ m(i, { node: n, relationGraph: t }) : /* @__PURE__ */ m(Ae, { children: n.innerHTML ? /* @__PURE__ */ m("div", { dangerouslySetInnerHTML: { __html: n.innerHTML } }) : /* @__PURE__ */ m(
              "div",
              {
                style: { color: n.fontColor || h.defaultNodeFontColor },
                className: "c-node-text",
                children: /* @__PURE__ */ m("span", { children: n.text })
              }
            ) }) })
          }
        )
      ]
    }
  );
}, Xe = ({ link: n, relation: i, relationIndex: e }) => {
  const t = G(ne), o = G(we), s = t.options, a = i.id === s.checkedLineId, c = i.showStartArrow ? t.getArrow(i, n, !0) : void 0, r = i.showEndArrow ? t.getArrow(i, n, !1) : void 0, l = () => {
    const { path: f, textPosition: v } = t.createLinePath(n, i, e);
    let y;
    try {
      y = t.getTextTransform(i, v.x, v.y, v.rotate);
    } catch (C) {
      p(C);
    }
    return {
      path: f,
      textTransform: y
    };
  }, h = (f) => {
    t.onLineClick(i, n, f), o();
  }, u = l();
  return /* @__PURE__ */ F("g", { children: [
    /* @__PURE__ */ m(
      "path",
      {
        d: u.path,
        className: [
          "c-rg-line",
          i.styleClass,
          i.dashType ? "rg-line-dashtype-" + i.dashType : void 0,
          i.animation ? "rg-line-anm-" + i.animation : void 0,
          a ? "c-rg-line-checked" : void 0
        ].join(" "),
        stroke: i.color ? i.color : s.defaultLineColor,
        style: {
          opacity: i.opacity,
          strokeWidth: (i.lineWidth ? i.lineWidth : s.defaultLineWidth) + "px"
        },
        markerStart: c,
        markerEnd: r,
        fill: "none",
        onTouchStart: (f) => h(f),
        onClick: (f) => h(f)
      }
    ),
    s.defaultShowLineLabel && s.canvasZoom > 40 && /* @__PURE__ */ m("g", { transform: u.textTransform, children: /* @__PURE__ */ m(
      "text",
      {
        x: i.textOffset_x || s.defaultLineTextOffset_x || 0,
        y: i.textOffset_y || s.defaultLineTextOffset_y || 10,
        style: {
          opacity: i.opacity,
          fill: i.fontColor ? i.fontColor : s.defaultLineFontColor ? s.defaultLineFontColor : i.color ? i.color : s.defaultLineColor
        },
        textAnchor: "middle",
        className: `c-rg-line-text ${a && "c-rg-line-text-checked"}`,
        onTouchStart: (f) => h(f),
        onClick: (f) => h(f),
        children: i.text
      },
      "t-" + i.seeks_id
    ) })
  ] });
}, No = ({ link: n, relation: i, relationIndex: e }) => {
  const t = G(ne), o = G(we), s = t.options, a = `translate(${i.textOffset_x || s.defaultLineTextOffset_x || 0},${i.textOffset_y || s.defaultLineTextOffset_y || -8})`, c = `#${s.instanceId}-${n.seeks_id}-${e}`, r = i.id === s.checkedLineId, l = i.lineShape === 4 || s.defaultLineShape === 4 ? "start" : "middle", h = i.lineShape === 4 || s.defaultLineShape === 4 ? s.layoutDirection === "v" ? Math.abs(n.toNode.x - n.fromNode.x) + 43 : Math.abs(n.toNode.y - n.fromNode.y) + 43 : "50%", u = (f) => {
    t.onLineClick(i, n, f), o();
  };
  return /* @__PURE__ */ F("g", { children: [
    /* @__PURE__ */ m(
      "use",
      {
        xlinkHref: c,
        className: [
          "c-rg-line",
          i.styleClass,
          i.dashType ? `rg-line-dashtype-${i.dashType}` : void 0,
          i.animation ? `rg-line-anm-${i.animation}` : void 0,
          r ? "c-rg-line-checked" : void 0
        ].filter(Boolean).join(" "),
        onTouchStart: (f) => u(f),
        onClick: (f) => u(f)
      }
    ),
    /* @__PURE__ */ m("g", { transform: a, children: /* @__PURE__ */ m(
      "text",
      {
        className: `c-rg-line-text ${r && "c-rg-line-text-checked"}`,
        style: {
          opacity: i.opacity,
          fill: i.fontColor || s.defaultLineFontColor || i.color || s.defaultLineColor
        },
        onTouchStart: (f) => u(f),
        onClick: (f) => u(f),
        children: /* @__PURE__ */ m("textPath", { xlinkHref: c, startOffset: h, textAnchor: l, method: "align", spacing: "auto", children: i.text })
      }
    ) })
  ] });
}, zo = ({ linkProps: n, LineSlot: i }) => {
  const e = G(ne), t = (s) => x.isAllowShowNode(s);
  Te(() => {
  }, []);
  const o = e.options;
  return /* @__PURE__ */ m(
    "g",
    {
      style: { display: t(n.fromNode) && t(n.toNode) ? "block" : "none" },
      className: [
        "rel-link-peel",
        o.checkedLinkId === n.seeks_id ? "c-rg-link-checked" : ""
      ].join(" "),
      transform: "translate(0,0)",
      "data-id": n.seeks_id,
      children: n.relations.map(
        (s, a) => /* @__PURE__ */ m(ke.Fragment, { children: i ? /* @__PURE__ */ m(i, { relationGraph: e, link: n, relation: s, relationIndex: a }) : s.useTextPath || o.lineUseTextPath ? /* @__PURE__ */ m(No, { link: n, relation: s, relationIndex: a }) : /* @__PURE__ */ m(Xe, { link: n, relation: s, relationIndex: a }) }, s.id)
      )
    }
  );
}, Ao = ({ link: n, relation: i, relationIndex: e }) => {
  const t = G(ne), o = t.options, s = i.id === o.checkedLineId, a = () => {
    const { path: l } = t.createLinePath(
      n,
      i,
      e
    );
    return l;
  }, c = i.showStartArrow ? t.getArrow(i, n, !0) : void 0, r = i.showEndArrow ? t.getArrow(i, n, !1) : void 0;
  return /* @__PURE__ */ m(
    "path",
    {
      id: `${o.instanceId}-${n.seeks_id}-${e}`,
      d: a(),
      stroke: i.color ? i.color : o.defaultLineColor,
      style: {
        opacity: i.opacity,
        strokeWidth: `${i.lineWidth ? i.lineWidth : o.defaultLineWidth}px`
      },
      markerStart: c,
      markerEnd: r,
      className: `c-rg-line-path ${i.styleClass} ${s ? "c-rg-line-checked" : ""}`,
      fill: "none"
    }
  );
}, To = () => {
  const n = G(ne), i = n.createCheckedLinePath(), e = n.createCheckedLineStrokeWidth();
  return /* @__PURE__ */ m("g", { children: i && /* @__PURE__ */ m(
    "path",
    {
      d: i,
      fill: "none",
      stroke: "red",
      strokeWidth: e,
      className: "c-rg-line-checked-bg"
    }
  ) });
}, Bo = (n) => {
  const i = G(ne), e = ze();
  Te(() => {
    t();
  }, []);
  const t = () => {
    e.current.style.setProperty(
      "--stroke",
      `url('#${o.instanceId}-lineStyle')`
    ), e.current.style.setProperty(
      "--markerEnd",
      `url('#${o.instanceId}-start-arrow-default')`
    ), e.current.style.setProperty(
      "--markerStart",
      `url('#${o.instanceId}-arrow-default')`
    ), e.current.style.setProperty(
      "--markerEndChecked",
      `url('#${o.instanceId}-arrow-checked')`
    ), e.current.style.setProperty(
      "--markerStartChecked",
      `url('#${o.instanceId}-start-arrow-checked')`
    );
  }, o = i.options, s = i.allLineColors, a = i.graphData.nodes, c = i.graphData.links, r = i.graphData.elementLines;
  return /* @__PURE__ */ F("div", { children: [
    /* @__PURE__ */ m("div", { ref: e, className: "rel-linediv", children: /* @__PURE__ */ F(
      "svg",
      {
        className: "rel-lines-svg",
        style: {
          width: `${o.canvasSize.width}px`,
          height: `${o.canvasSize.height}px`
        },
        xmlns: "http://www.w3.org/2000/svg",
        children: [
          /* @__PURE__ */ F("defs", { children: [
            /* @__PURE__ */ F(
              "linearGradient",
              {
                id: `${o.instanceId}-lineStyle`,
                x1: "1",
                y1: "0",
                x2: "0",
                y2: "0",
                children: [
                  /* @__PURE__ */ m("stop", { offset: "0%", stopColor: "#e52c5c" }),
                  /* @__PURE__ */ m("stop", { offset: "100%", stopColor: "#FD8B37" })
                ]
              }
            ),
            /* @__PURE__ */ m(
              "marker",
              {
                id: `${o.instanceId}-arrow-default`,
                markerWidth: o.defaultLineMarker.markerWidth,
                markerHeight: o.defaultLineMarker.markerHeight,
                refX: o.defaultLineMarker.refX,
                refY: o.defaultLineMarker.refY,
                markerUnits: "strokeWidth",
                orient: "auto",
                viewBox: "0 0 12 12",
                children: /* @__PURE__ */ m(
                  "path",
                  {
                    style: { fill: o.defaultLineColor },
                    d: o.defaultLineMarker.data
                  }
                )
              }
            ),
            /* @__PURE__ */ m(
              "marker",
              {
                id: `${o.instanceId}-start-arrow-default`,
                markerWidth: o.defaultLineMarker.markerWidth,
                markerHeight: o.defaultLineMarker.markerHeight,
                refX: o.defaultLineMarker.refX,
                refY: o.defaultLineMarker.refY,
                markerUnits: "strokeWidth",
                orient: "auto",
                viewBox: "0 0 12 12",
                children: /* @__PURE__ */ m(
                  "path",
                  {
                    style: { fill: o.defaultLineColor },
                    d: o.defaultLineMarker.data,
                    transform: "translate(12,12)rotate(180)"
                  }
                )
              }
            ),
            /* @__PURE__ */ m(
              "marker",
              {
                id: `${o.instanceId}-arrow-checked`,
                markerUnits: "strokeWidth",
                markerWidth: "12",
                markerHeight: "12",
                viewBox: "0 0 12 12",
                refX: "6",
                refY: "6",
                orient: "auto",
                children: /* @__PURE__ */ m(
                  "path",
                  {
                    style: { fill: o.checkedLineColor },
                    d: "M2,2 L10,6 L2,10 L6,6 L2,2"
                  }
                )
              }
            ),
            /* @__PURE__ */ m(
              "marker",
              {
                id: `${o.instanceId}-start-arrow-checked`,
                markerUnits: "strokeWidth",
                markerWidth: "12",
                markerHeight: "12",
                viewBox: "0 0 12 12",
                refX: "6",
                refY: "6",
                orient: "auto",
                children: /* @__PURE__ */ m(
                  "path",
                  {
                    style: { fill: o.checkedLineColor },
                    d: "M2,2 L10,6 L2,10 L6,6 L2,2",
                    transform: "translate(12,12)rotate(180)"
                  }
                )
              }
            ),
            s.map((l) => /* @__PURE__ */ m(
              "marker",
              {
                id: `${o.instanceId}-arrow-${l.id}`,
                markerWidth: o.defaultLineMarker.markerWidth,
                markerHeight: o.defaultLineMarker.markerHeight,
                refX: o.defaultLineMarker.refX,
                refY: o.defaultLineMarker.refY,
                markerUnits: "strokeWidth",
                orient: "auto",
                viewBox: "0 0 12 12",
                children: /* @__PURE__ */ m(
                  "path",
                  {
                    fill: o.defaultLineMarker.color || l.color,
                    d: o.defaultLineMarker.data
                  }
                )
              },
              l.id
            )),
            s.map(
              (l) => /* @__PURE__ */ m(
                "marker",
                {
                  id: `${o.instanceId}-start-arrow-${l.id}`,
                  markerWidth: o.defaultLineMarker.markerWidth,
                  markerHeight: o.defaultLineMarker.markerHeight,
                  refX: o.defaultLineMarker.refX,
                  refY: o.defaultLineMarker.refY,
                  markerUnits: "strokeWidth",
                  orient: "auto",
                  viewBox: "0 0 12 12",
                  children: /* @__PURE__ */ m(
                    "path",
                    {
                      fill: o.defaultLineMarker.color || l.color,
                      d: o.defaultLineMarker.data,
                      transform: "translate(12,12)rotate(180)"
                    }
                  )
                },
                `start-${l.id}`
              )
            ),
            c.map(
              (l) => /* @__PURE__ */ m(ke.Fragment, { children: l.relations.filter((h) => o.lineUseTextPath || h.useTextPath).map(
                (h, u) => /* @__PURE__ */ m(
                  Ao,
                  {
                    link: l,
                    relation: h,
                    relationIndex: u
                  },
                  h.id
                )
              ) }, l.seeks_id)
            )
          ] }),
          /* @__PURE__ */ m(To, {}),
          c.map(
            (l) => /* @__PURE__ */ m(
              zo,
              {
                linkProps: l,
                LineSlot: n.lineSlot
              },
              l.seeks_id
            )
          ),
          o.creatingLinePlot && o.newLinkTemplate.fromNode && /* @__PURE__ */ m(Xe, { link: o.newLinkTemplate, relation: o.newLineTemplate, relationIndex: 0 })
        ]
      }
    ) }),
    /* @__PURE__ */ m("div", { className: "rel-nodediv rel-nodediv-for-webkit", children: a.map(
      (l) => /* @__PURE__ */ m(
        Lt,
        {
          nodeProps: l,
          NodeSlot: n.nodeSlot,
          ExpandHolderSlot: n.expandHolderSlot
        },
        l.id
      )
    ) }),
    /* @__PURE__ */ m("div", { className: "rel-linediv rel-linediv-el-lines", children: /* @__PURE__ */ m(
      "svg",
      {
        className: "rrel-lines-svg rel-lines-svg-el-lines",
        xmlns: "http://www.w3.org/2000/svg",
        children: r.map(
          (l) => l.relations[0].isHide === !1 && /* @__PURE__ */ m(Xe, { link: l, relation: l.relations[0], relationIndex: 0 }, "ell-" + l.relations[0].id)
        )
      }
    ) })
  ] });
}, Po = (n) => {
  const i = G(ne), e = G(we), t = ze(), s = (() => ({
    width: `${i.options.canvasSize.width}px`,
    height: `${i.options.canvasSize.height}px`,
    marginLeft: `${i.options.canvasOffset.x}px`,
    marginTop: `${i.options.canvasOffset.y}px`,
    backgroundColor: "transparent",
    transform: `scale(${i.options.canvasZoom / 100},${i.options.canvasZoom / 100})`
  }))();
  Te(() => {
    var l, h;
    return console.log("[debug][RelationGraph-canvas] ready!"), p("[RGCanvas mounted]"), i.setCanvasDom(t.current), (h = (l = t.current) == null ? void 0 : l.parentElement) == null || h.addEventListener("wheel", a, { passive: !1, capture: !0 }), () => {
      var u, f;
      (f = (u = t.current) == null ? void 0 : u.parentElement) == null || f.removeEventListener("wheel", a);
    };
  }, []);
  const a = (l) => {
    i.onMouseWheel(l), e();
  }, c = (l) => {
    i.onCanvasDragStart(l);
  }, r = (l) => {
    l.preventDefault(), i.onContextmenu(l);
  };
  return /* @__PURE__ */ m(
    "div",
    {
      style: {
        width: "100%",
        height: "100%",
        backgroundImage: `url(${i.options.backgroundImage})`,
        backgroundColor: i.options.backgroundColor
      },
      className: [
        "rel-map",
        i.options.layoutClassName,
        i.options.backgroundImageNoRepeat ? "rel-map-background-norepeat" : ""
      ].join(" "),
      onContextMenuCapture: (l) => {
        r(l);
      },
      onMouseDownCapture: (l) => {
        c(l);
      },
      onTouchStartCapture: (l) => {
        c(l);
      },
      children: /* @__PURE__ */ F(
        "div",
        {
          ref: t,
          style: s,
          className: "rel-map-canvas",
          children: [
            /* @__PURE__ */ m("div", { className: "rel-canvas-slot rel-canvas-slot-behind", children: n.canvasPlugSlot && /* @__PURE__ */ m(n.canvasPlugSlot, { relationGraph: i }) }),
            /* @__PURE__ */ m(Bo, { nodeSlot: n.nodeSlot, lineSlot: n.lineSlot, expandHolderSlot: n.expandHolderSlot }),
            /* @__PURE__ */ m("div", { className: "rel-canvas-slot rel-canvas-slot-above", children: n.canvasPlugAboveSlot })
          ]
        }
      )
    }
  );
}, Do = ({ nodeSlot: n }) => {
  const i = G(ne), e = i && i.options;
  return e && (e.creatingNodePlot || e.creatingSelection) ? /* @__PURE__ */ m("div", { className: "rel-operate", children: /* @__PURE__ */ F("div", { style: { position: "relative" }, children: [
    e.creatingNodePlot && e.showTemplateNode && /* @__PURE__ */ m(
      Lt,
      {
        nodeProps: e.newNodeTemplate,
        NodeSlot: n
      }
    ),
    e.creatingSelection && /* @__PURE__ */ m(
      "div",
      {
        className: "rel-selection",
        style: {
          left: e.selectionView.x + "px",
          top: e.selectionView.y + "px",
          width: e.selectionView.width + "px",
          height: e.selectionView.height + "px"
        }
      }
    )
  ] }) }) : /* @__PURE__ */ m("div", {});
}, Io = () => {
  const n = G(ne), i = n && n.options, e = (t) => {
    n.clickGraphMask(t);
  };
  return /* @__PURE__ */ m(Ae, { children: i && /* @__PURE__ */ m(
    "div",
    {
      className: `rel-graph-loading ${i.graphLoading ? "" : "rel-graph-loading-hide"}`,
      onClick: (t) => {
        e(t);
      },
      children: /* @__PURE__ */ F("div", { className: "rel-graph-loading-message", children: [
        /* @__PURE__ */ m("svg", { className: "c-graph-loading-icon", "aria-hidden": "true", children: /* @__PURE__ */ m("use", { xlinkHref: "#icon-lianjiezhong" }) }),
        "Loading..."
      ] })
    }
  ) });
}, Ro = (n, i) => {
  const [e, t] = yt({ instance: null }), o = ze(), s = ze();
  Te(() => {
    console.log("[debug][RelationGraph] ready!"), no("react");
    const l = n.relationGraphCore ? new n.relationGraphCore(n.options, pt(n)) : new So(n.options, pt(n));
    return s.current = l, l.setUpdateViewHook(a), p("setDom:", o.current), l.setDom(o.current), l.ready(), a(), Se && Se.on && Se.on("change", c), () => {
      Se.off("change", c);
    };
  }, []), Yt(i, () => ({
    getInstance() {
      return s.current;
    },
    async setOptions(l, h) {
      await s.current.setOptions(l), a(), h && h(s.current);
    },
    async setJsonData(l, h, u) {
      arguments.length === 2 && typeof h == "function" && (u = h, h = !0), await s.current.setJsonData(
        l,
        !0
      ), await s.current.refresh(!1), a(), u && u(s.current);
    },
    async appendJsonData(l, h, u) {
      arguments.length === 2 && typeof h == "function" && (u = h, h = !0), await s.current.appendJsonData(l, !0), a(), u && u(s.current);
    },
    setLayouter(l) {
      s.current.setLayouter(l), a();
    },
    onGraphResize() {
      s.current.refreshNVAnalysisInfo(), a();
    },
    refresh() {
      s.current.refresh();
    },
    focusRootNode() {
      s.current.focusRootNode(), a();
    },
    focusNodeById(l) {
      s.current.focusNodeById(l), a();
    },
    getNodeById(l) {
      return s.current.getNodeById(l);
    },
    removeNodeById(l) {
      return s.current.removeNodeById(l);
    },
    getNodes() {
      return s.current.getNodes();
    },
    getLinks() {
      return s.current.getLinks();
    },
    getGraphJsonData() {
      return s.current.getGraphJsonData();
    },
    getGraphJsonOptions() {
      return s.current.getGraphJsonOptions();
    },
    updateView() {
      a();
    }
  }), [s.current]);
  const a = (l) => {
    t({ instance: l || s.current });
  };
  s.current && s.current.setUpdateViewHook(a);
  const c = () => {
    s.current.fullscreen(Se.isFullscreen);
  }, r = e && e.instance && e.instance.options;
  return /* @__PURE__ */ m(Ae, { children: /* @__PURE__ */ m(Kt, { value: s.current, children: /* @__PURE__ */ m(Qt, { value: a, children: /* @__PURE__ */ F(
    "div",
    {
      ref: o,
      className: "relation-graph",
      style: { width: "100%", height: "100%" },
      children: [
        r && r.showDebugPanel && /* @__PURE__ */ m(ko, {}),
        r && r.allowShowMiniToolBar === !0 && (n.toolBarSlot ? /* @__PURE__ */ m(n.toolBarSlot, { relationGraph: e.instance }) : /* @__PURE__ */ m(Eo, {})),
        r && r.allowShowMiniView === !0 && (n.miniViewSlot ? /* @__PURE__ */ m(n.miniViewSlot, { relationGraph: e.instance }) : /* @__PURE__ */ m(Mo, {})),
        r && (n.graphPlugSlot ? /* @__PURE__ */ m(n.graphPlugSlot, { relationGraph: e.instance }) : /* @__PURE__ */ m("div", { className: "rel-graph-plug" })),
        r && /* @__PURE__ */ m(
          Po,
          {
            nodeSlot: n.nodeSlot,
            lineSlot: n.lineSlot,
            canvasPlugSlot: n.canvasPlugSlot,
            canvasPlugAboveSlot: n.children,
            expandHolderSlot: n.expandHolderSlot
          }
        ),
        /* @__PURE__ */ m(Do, { nodeSlot: n.nodeSlot }),
        /* @__PURE__ */ m(Io, {})
      ]
    }
  ) }) }) });
}, jo = ke.forwardRef(Ro);
export {
  jo as default
};
